{"version":3,"names":["camelCase","addQueryArgs","decodeEntities","apiFetch","STORE_NAME","additionalEntityConfigLoaders","DEFAULT_ENTITY_KEY","forwardResolver","getNormalizedCommaSeparable","getUserPermissionCacheKey","getUserPermissionsFromAllowHeader","ALLOWED_RESOURCE_ACTIONS","RECEIVE_INTERMEDIATE_RESULTS","getSyncProvider","fetchBlockPatterns","getAuthors","query","dispatch","path","users","receiveUserQuery","getCurrentUser","currentUser","receiveCurrentUser","getEntityRecord","kind","name","key","select","registry","resolveSelect","configs","getEntitiesConfig","entityConfig","find","config","lock","__unstableAcquireStoreLock","exclusive","window","__experimentalEnableSync","syncConfig","globalThis","IS_GUTENBERG_PLUGIN","objectId","getSyncObjectId","bootstrap","syncObjectType","record","receiveEntityRecords","type","recordId","edits","meta","undo","undefined","_fields","Set","join","baseURL","baseURLParams","include","hasRecords","hasEntityRecords","response","parse","json","permissions","headers","get","canUserResolutionsArgs","receiveUserPermissionArgs","action","id","push","batch","receiveUserPermissions","finishResolutions","__unstableReleaseStoreLock","getRawEntityRecord","getEditedEntityRecord","getEntityRecords","getResolutionsArgs","records","filter","map","supportsPagination","per_page","Object","values","totalItems","parseInt","totalPages","page","pageRecords","length","split","forEach","field","hasOwnProperty","context","targetHints","_links","self","allow","targetHint","e","shouldInvalidate","invalidateCache","getCurrentTheme","activeThemes","status","receiveCurrentTheme","getThemeSupports","getEmbedPreview","url","embedProxyResponse","receiveEmbedPreview","error","canUser","requestedAction","resource","includes","Error","hasStartedResolution","relatedAction","isAlreadyResolving","resourcePath","method","receiveUserPermission","finishResolution","canUserEditEntityRecord","getAutosaves","postType","postId","rest_base","restBase","rest_namespace","restNamespace","supports","getPostType","autosave","autosaves","receiveAutosaves","getAutosave","__experimentalGetCurrentGlobalStylesId","globalStylesURL","href","matches","match","Number","__experimentalReceiveCurrentGlobalStylesId","__experimentalGetCurrentThemeBaseGlobalStyles","currentTheme","themeGlobalStyles","stylesheet","__experimentalReceiveThemeBaseGlobalStyles","__experimentalGetCurrentThemeGlobalStylesVariations","variations","__experimentalReceiveThemeGlobalStyleVariations","getCurrentThemeGlobalStylesRevisions","globalStylesId","revisionsURL","resetRevisions","revisions","revision","fromEntries","entries","value","receiveThemeGlobalStyleRevisions","getBlockPatterns","patterns","getBlockPatternCategories","categories","getUserPatternCategories","patternCategories","mappedPatternCategories","userCategory","label","slug","getNavigationFallbackId","fallback","_embed","_embedded","receiveNavigationFallbackId","existingFallbackEntityRecord","invalidateNavigationQueries","getDefaultTemplateId","template","receiveDefaultTemplateId","getRevisions","recordKey","revisionKey","getRevisionsUrl","isPaginated","receiveRevisions","resolutionsArgs","getRevision","getRegisteredPostMeta","options","receiveRegisteredPostMeta","schema","properties","loader","l","loadEntities","addEntities"],"sources":["@wordpress/core-data/src/resolvers.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport { camelCase } from 'change-case';\n\n/**\n * WordPress dependencies\n */\nimport { addQueryArgs } from '@wordpress/url';\nimport { decodeEntities } from '@wordpress/html-entities';\nimport apiFetch from '@wordpress/api-fetch';\n\n/**\n * Internal dependencies\n */\nimport { STORE_NAME } from './name';\nimport { additionalEntityConfigLoaders, DEFAULT_ENTITY_KEY } from './entities';\nimport {\n\tforwardResolver,\n\tgetNormalizedCommaSeparable,\n\tgetUserPermissionCacheKey,\n\tgetUserPermissionsFromAllowHeader,\n\tALLOWED_RESOURCE_ACTIONS,\n\tRECEIVE_INTERMEDIATE_RESULTS,\n} from './utils';\nimport { getSyncProvider } from './sync';\nimport { fetchBlockPatterns } from './fetch';\n\n/**\n * Requests authors from the REST API.\n *\n * @param {Object|undefined} query Optional object of query parameters to\n *                                 include with request.\n */\nexport const getAuthors =\n\t( query ) =>\n\tasync ( { dispatch } ) => {\n\t\tconst path = addQueryArgs(\n\t\t\t'/wp/v2/users/?who=authors&per_page=100',\n\t\t\tquery\n\t\t);\n\t\tconst users = await apiFetch( { path } );\n\t\tdispatch.receiveUserQuery( path, users );\n\t};\n\n/**\n * Requests the current user from the REST API.\n */\nexport const getCurrentUser =\n\t() =>\n\tasync ( { dispatch } ) => {\n\t\tconst currentUser = await apiFetch( { path: '/wp/v2/users/me' } );\n\t\tdispatch.receiveCurrentUser( currentUser );\n\t};\n\n/**\n * Requests an entity's record from the REST API.\n *\n * @param {string}           kind  Entity kind.\n * @param {string}           name  Entity name.\n * @param {number|string}    key   Record's key\n * @param {Object|undefined} query Optional object of query parameters to\n *                                 include with request. If requesting specific\n *                                 fields, fields must always include the ID.\n */\nexport const getEntityRecord =\n\t( kind, name, key = '', query ) =>\n\tasync ( { select, dispatch, registry, resolveSelect } ) => {\n\t\tconst configs = await resolveSelect.getEntitiesConfig( kind );\n\t\tconst entityConfig = configs.find(\n\t\t\t( config ) => config.name === name && config.kind === kind\n\t\t);\n\t\tif ( ! entityConfig ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst lock = await dispatch.__unstableAcquireStoreLock(\n\t\t\tSTORE_NAME,\n\t\t\t[ 'entities', 'records', kind, name, key ],\n\t\t\t{ exclusive: false }\n\t\t);\n\n\t\ttry {\n\t\t\t// Entity supports configs,\n\t\t\t// use the sync algorithm instead of the old fetch behavior.\n\t\t\tif (\n\t\t\t\twindow.__experimentalEnableSync &&\n\t\t\t\tentityConfig.syncConfig &&\n\t\t\t\t! query\n\t\t\t) {\n\t\t\t\tif ( globalThis.IS_GUTENBERG_PLUGIN ) {\n\t\t\t\t\tconst objectId = entityConfig.getSyncObjectId( key );\n\n\t\t\t\t\t// Loads the persisted document.\n\t\t\t\t\tawait getSyncProvider().bootstrap(\n\t\t\t\t\t\tentityConfig.syncObjectType,\n\t\t\t\t\t\tobjectId,\n\t\t\t\t\t\t( record ) => {\n\t\t\t\t\t\t\tdispatch.receiveEntityRecords(\n\t\t\t\t\t\t\t\tkind,\n\t\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\t\trecord,\n\t\t\t\t\t\t\t\tquery\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\t// Bootstraps the edited document as well (and load from peers).\n\t\t\t\t\tawait getSyncProvider().bootstrap(\n\t\t\t\t\t\tentityConfig.syncObjectType + '--edit',\n\t\t\t\t\t\tobjectId,\n\t\t\t\t\t\t( record ) => {\n\t\t\t\t\t\t\tdispatch( {\n\t\t\t\t\t\t\t\ttype: 'EDIT_ENTITY_RECORD',\n\t\t\t\t\t\t\t\tkind,\n\t\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\t\trecordId: key,\n\t\t\t\t\t\t\t\tedits: record,\n\t\t\t\t\t\t\t\tmeta: {\n\t\t\t\t\t\t\t\t\tundo: undefined,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif ( query !== undefined && query._fields ) {\n\t\t\t\t\t// If requesting specific fields, items and query association to said\n\t\t\t\t\t// records are stored by ID reference. Thus, fields must always include\n\t\t\t\t\t// the ID.\n\t\t\t\t\tquery = {\n\t\t\t\t\t\t...query,\n\t\t\t\t\t\t_fields: [\n\t\t\t\t\t\t\t...new Set( [\n\t\t\t\t\t\t\t\t...( getNormalizedCommaSeparable(\n\t\t\t\t\t\t\t\t\tquery._fields\n\t\t\t\t\t\t\t\t) || [] ),\n\t\t\t\t\t\t\t\tentityConfig.key || DEFAULT_ENTITY_KEY,\n\t\t\t\t\t\t\t] ),\n\t\t\t\t\t\t].join(),\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\t// Disable reason: While true that an early return could leave `path`\n\t\t\t\t// unused, it's important that path is derived using the query prior to\n\t\t\t\t// additional query modifications in the condition below, since those\n\t\t\t\t// modifications are relevant to how the data is tracked in state, and not\n\t\t\t\t// for how the request is made to the REST API.\n\n\t\t\t\t// eslint-disable-next-line @wordpress/no-unused-vars-before-return\n\t\t\t\tconst path = addQueryArgs(\n\t\t\t\t\tentityConfig.baseURL + ( key ? '/' + key : '' ),\n\t\t\t\t\t{\n\t\t\t\t\t\t...entityConfig.baseURLParams,\n\t\t\t\t\t\t...query,\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tif ( query !== undefined && query._fields ) {\n\t\t\t\t\tquery = { ...query, include: [ key ] };\n\n\t\t\t\t\t// The resolution cache won't consider query as reusable based on the\n\t\t\t\t\t// fields, so it's tested here, prior to initiating the REST request,\n\t\t\t\t\t// and without causing `getEntityRecords` resolution to occur.\n\t\t\t\t\tconst hasRecords = select.hasEntityRecords(\n\t\t\t\t\t\tkind,\n\t\t\t\t\t\tname,\n\t\t\t\t\t\tquery\n\t\t\t\t\t);\n\t\t\t\t\tif ( hasRecords ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst response = await apiFetch( { path, parse: false } );\n\t\t\t\tconst record = await response.json();\n\t\t\t\tconst permissions = getUserPermissionsFromAllowHeader(\n\t\t\t\t\tresponse.headers?.get( 'allow' )\n\t\t\t\t);\n\n\t\t\t\tconst canUserResolutionsArgs = [];\n\t\t\t\tconst receiveUserPermissionArgs = {};\n\t\t\t\tfor ( const action of ALLOWED_RESOURCE_ACTIONS ) {\n\t\t\t\t\treceiveUserPermissionArgs[\n\t\t\t\t\t\tgetUserPermissionCacheKey( action, {\n\t\t\t\t\t\t\tkind,\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\tid: key,\n\t\t\t\t\t\t} )\n\t\t\t\t\t] = permissions[ action ];\n\n\t\t\t\t\tcanUserResolutionsArgs.push( [\n\t\t\t\t\t\taction,\n\t\t\t\t\t\t{ kind, name, id: key },\n\t\t\t\t\t] );\n\t\t\t\t}\n\n\t\t\t\tregistry.batch( () => {\n\t\t\t\t\tdispatch.receiveEntityRecords( kind, name, record, query );\n\t\t\t\t\tdispatch.receiveUserPermissions(\n\t\t\t\t\t\treceiveUserPermissionArgs\n\t\t\t\t\t);\n\t\t\t\t\tdispatch.finishResolutions(\n\t\t\t\t\t\t'canUser',\n\t\t\t\t\t\tcanUserResolutionsArgs\n\t\t\t\t\t);\n\t\t\t\t} );\n\t\t\t}\n\t\t} finally {\n\t\t\tdispatch.__unstableReleaseStoreLock( lock );\n\t\t}\n\t};\n\n/**\n * Requests an entity's record from the REST API.\n */\nexport const getRawEntityRecord = forwardResolver( 'getEntityRecord' );\n\n/**\n * Requests an entity's record from the REST API.\n */\nexport const getEditedEntityRecord = forwardResolver( 'getEntityRecord' );\n\n/**\n * Requests the entity's records from the REST API.\n *\n * @param {string}  kind  Entity kind.\n * @param {string}  name  Entity name.\n * @param {?Object} query Query Object. If requesting specific fields, fields\n *                        must always include the ID.\n */\nexport const getEntityRecords =\n\t( kind, name, query = {} ) =>\n\tasync ( { dispatch, registry, resolveSelect } ) => {\n\t\tconst configs = await resolveSelect.getEntitiesConfig( kind );\n\t\tconst entityConfig = configs.find(\n\t\t\t( config ) => config.name === name && config.kind === kind\n\t\t);\n\t\tif ( ! entityConfig ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst lock = await dispatch.__unstableAcquireStoreLock(\n\t\t\tSTORE_NAME,\n\t\t\t[ 'entities', 'records', kind, name ],\n\t\t\t{ exclusive: false }\n\t\t);\n\n\t\tconst key = entityConfig.key || DEFAULT_ENTITY_KEY;\n\n\t\tfunction getResolutionsArgs( records ) {\n\t\t\treturn records\n\t\t\t\t.filter( ( record ) => record?.[ key ] )\n\t\t\t\t.map( ( record ) => [ kind, name, record[ key ] ] );\n\t\t}\n\n\t\ttry {\n\t\t\tif ( query._fields ) {\n\t\t\t\t// If requesting specific fields, items and query association to said\n\t\t\t\t// records are stored by ID reference. Thus, fields must always include\n\t\t\t\t// the ID.\n\t\t\t\tquery = {\n\t\t\t\t\t...query,\n\t\t\t\t\t_fields: [\n\t\t\t\t\t\t...new Set( [\n\t\t\t\t\t\t\t...( getNormalizedCommaSeparable( query._fields ) ||\n\t\t\t\t\t\t\t\t[] ),\n\t\t\t\t\t\t\tentityConfig.key || DEFAULT_ENTITY_KEY,\n\t\t\t\t\t\t] ),\n\t\t\t\t\t].join(),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tconst path = addQueryArgs( entityConfig.baseURL, {\n\t\t\t\t...entityConfig.baseURLParams,\n\t\t\t\t...query,\n\t\t\t} );\n\n\t\t\tlet records = [],\n\t\t\t\tmeta;\n\t\t\tif ( entityConfig.supportsPagination && query.per_page !== -1 ) {\n\t\t\t\tconst response = await apiFetch( { path, parse: false } );\n\t\t\t\trecords = Object.values( await response.json() );\n\t\t\t\tmeta = {\n\t\t\t\t\ttotalItems: parseInt(\n\t\t\t\t\t\tresponse.headers.get( 'X-WP-Total' )\n\t\t\t\t\t),\n\t\t\t\t\ttotalPages: parseInt(\n\t\t\t\t\t\tresponse.headers.get( 'X-WP-TotalPages' )\n\t\t\t\t\t),\n\t\t\t\t};\n\t\t\t} else if (\n\t\t\t\tquery.per_page === -1 &&\n\t\t\t\tquery[ RECEIVE_INTERMEDIATE_RESULTS ] === true\n\t\t\t) {\n\t\t\t\tlet page = 1;\n\t\t\t\tlet totalPages;\n\n\t\t\t\tdo {\n\t\t\t\t\tconst response = await apiFetch( {\n\t\t\t\t\t\tpath: addQueryArgs( path, { page, per_page: 100 } ),\n\t\t\t\t\t\tparse: false,\n\t\t\t\t\t} );\n\t\t\t\t\tconst pageRecords = Object.values( await response.json() );\n\n\t\t\t\t\ttotalPages = parseInt(\n\t\t\t\t\t\tresponse.headers.get( 'X-WP-TotalPages' )\n\t\t\t\t\t);\n\n\t\t\t\t\trecords.push( ...pageRecords );\n\t\t\t\t\tregistry.batch( () => {\n\t\t\t\t\t\tdispatch.receiveEntityRecords(\n\t\t\t\t\t\t\tkind,\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\trecords,\n\t\t\t\t\t\t\tquery\n\t\t\t\t\t\t);\n\t\t\t\t\t\tdispatch.finishResolutions(\n\t\t\t\t\t\t\t'getEntityRecord',\n\t\t\t\t\t\t\tgetResolutionsArgs( pageRecords )\n\t\t\t\t\t\t);\n\t\t\t\t\t} );\n\t\t\t\t\tpage++;\n\t\t\t\t} while ( page <= totalPages );\n\n\t\t\t\tmeta = {\n\t\t\t\t\ttotalItems: records.length,\n\t\t\t\t\ttotalPages: 1,\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\trecords = Object.values( await apiFetch( { path } ) );\n\t\t\t\tmeta = {\n\t\t\t\t\ttotalItems: records.length,\n\t\t\t\t\ttotalPages: 1,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// If we request fields but the result doesn't contain the fields,\n\t\t\t// explicitly set these fields as \"undefined\"\n\t\t\t// that way we consider the query \"fulfilled\".\n\t\t\tif ( query._fields ) {\n\t\t\t\trecords = records.map( ( record ) => {\n\t\t\t\t\tquery._fields.split( ',' ).forEach( ( field ) => {\n\t\t\t\t\t\tif ( ! record.hasOwnProperty( field ) ) {\n\t\t\t\t\t\t\trecord[ field ] = undefined;\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\n\t\t\t\t\treturn record;\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\tregistry.batch( () => {\n\t\t\t\tdispatch.receiveEntityRecords(\n\t\t\t\t\tkind,\n\t\t\t\t\tname,\n\t\t\t\t\trecords,\n\t\t\t\t\tquery,\n\t\t\t\t\tfalse,\n\t\t\t\t\tundefined,\n\t\t\t\t\tmeta\n\t\t\t\t);\n\n\t\t\t\t// When requesting all fields, the list of results can be used to resolve\n\t\t\t\t// the `getEntityRecord` and `canUser` selectors in addition to `getEntityRecords`.\n\t\t\t\t// See https://github.com/WordPress/gutenberg/pull/26575\n\t\t\t\t// See https://github.com/WordPress/gutenberg/pull/64504\n\t\t\t\tif ( ! query?._fields && ! query.context ) {\n\t\t\t\t\tconst targetHints = records\n\t\t\t\t\t\t.filter( ( record ) => record?.[ key ] )\n\t\t\t\t\t\t.map( ( record ) => ( {\n\t\t\t\t\t\t\tid: record[ key ],\n\t\t\t\t\t\t\tpermissions: getUserPermissionsFromAllowHeader(\n\t\t\t\t\t\t\t\trecord?._links?.self?.[ 0 ].targetHints.allow\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t} ) );\n\n\t\t\t\t\tconst canUserResolutionsArgs = [];\n\t\t\t\t\tconst receiveUserPermissionArgs = {};\n\t\t\t\t\tfor ( const targetHint of targetHints ) {\n\t\t\t\t\t\tfor ( const action of ALLOWED_RESOURCE_ACTIONS ) {\n\t\t\t\t\t\t\tcanUserResolutionsArgs.push( [\n\t\t\t\t\t\t\t\taction,\n\t\t\t\t\t\t\t\t{ kind, name, id: targetHint.id },\n\t\t\t\t\t\t\t] );\n\n\t\t\t\t\t\t\treceiveUserPermissionArgs[\n\t\t\t\t\t\t\t\tgetUserPermissionCacheKey( action, {\n\t\t\t\t\t\t\t\t\tkind,\n\t\t\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\t\t\tid: targetHint.id,\n\t\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t\t] = targetHint.permissions[ action ];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tdispatch.receiveUserPermissions(\n\t\t\t\t\t\treceiveUserPermissionArgs\n\t\t\t\t\t);\n\t\t\t\t\tdispatch.finishResolutions(\n\t\t\t\t\t\t'getEntityRecord',\n\t\t\t\t\t\tgetResolutionsArgs( records )\n\t\t\t\t\t);\n\t\t\t\t\tdispatch.finishResolutions(\n\t\t\t\t\t\t'canUser',\n\t\t\t\t\t\tcanUserResolutionsArgs\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tdispatch.__unstableReleaseStoreLock( lock );\n\t\t\t} );\n\t\t} catch ( e ) {\n\t\t\tdispatch.__unstableReleaseStoreLock( lock );\n\t\t}\n\t};\n\ngetEntityRecords.shouldInvalidate = ( action, kind, name ) => {\n\treturn (\n\t\t( action.type === 'RECEIVE_ITEMS' || action.type === 'REMOVE_ITEMS' ) &&\n\t\taction.invalidateCache &&\n\t\tkind === action.kind &&\n\t\tname === action.name\n\t);\n};\n\n/**\n * Requests the current theme.\n */\nexport const getCurrentTheme =\n\t() =>\n\tasync ( { dispatch, resolveSelect } ) => {\n\t\tconst activeThemes = await resolveSelect.getEntityRecords(\n\t\t\t'root',\n\t\t\t'theme',\n\t\t\t{ status: 'active' }\n\t\t);\n\n\t\tdispatch.receiveCurrentTheme( activeThemes[ 0 ] );\n\t};\n\n/**\n * Requests theme supports data from the index.\n */\nexport const getThemeSupports = forwardResolver( 'getCurrentTheme' );\n\n/**\n * Requests a preview from the Embed API.\n *\n * @param {string} url URL to get the preview for.\n */\nexport const getEmbedPreview =\n\t( url ) =>\n\tasync ( { dispatch } ) => {\n\t\ttry {\n\t\t\tconst embedProxyResponse = await apiFetch( {\n\t\t\t\tpath: addQueryArgs( '/oembed/1.0/proxy', { url } ),\n\t\t\t} );\n\t\t\tdispatch.receiveEmbedPreview( url, embedProxyResponse );\n\t\t} catch ( error ) {\n\t\t\t// Embed API 404s if the URL cannot be embedded, so we have to catch the error from the apiRequest here.\n\t\t\tdispatch.receiveEmbedPreview( url, false );\n\t\t}\n\t};\n\n/**\n * Checks whether the current user can perform the given action on the given\n * REST resource.\n *\n * @param {string}        requestedAction Action to check. One of: 'create', 'read', 'update',\n *                                        'delete'.\n * @param {string|Object} resource        Entity resource to check. Accepts entity object `{ kind: 'root', name: 'media', id: 1 }`\n *                                        or REST base as a string - `media`.\n * @param {?string}       id              ID of the rest resource to check.\n */\nexport const canUser =\n\t( requestedAction, resource, id ) =>\n\tasync ( { dispatch, registry, resolveSelect } ) => {\n\t\tif ( ! ALLOWED_RESOURCE_ACTIONS.includes( requestedAction ) ) {\n\t\t\tthrow new Error( `'${ requestedAction }' is not a valid action.` );\n\t\t}\n\n\t\tconst { hasStartedResolution } = registry.select( STORE_NAME );\n\n\t\t// Prevent resolving the same resource twice.\n\t\tfor ( const relatedAction of ALLOWED_RESOURCE_ACTIONS ) {\n\t\t\tif ( relatedAction === requestedAction ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst isAlreadyResolving = hasStartedResolution( 'canUser', [\n\t\t\t\trelatedAction,\n\t\t\t\tresource,\n\t\t\t\tid,\n\t\t\t] );\n\t\t\tif ( isAlreadyResolving ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tlet resourcePath = null;\n\t\tif ( typeof resource === 'object' ) {\n\t\t\tif ( ! resource.kind || ! resource.name ) {\n\t\t\t\tthrow new Error( 'The entity resource object is not valid.' );\n\t\t\t}\n\n\t\t\tconst configs = await resolveSelect.getEntitiesConfig(\n\t\t\t\tresource.kind\n\t\t\t);\n\t\t\tconst entityConfig = configs.find(\n\t\t\t\t( config ) =>\n\t\t\t\t\tconfig.name === resource.name &&\n\t\t\t\t\tconfig.kind === resource.kind\n\t\t\t);\n\t\t\tif ( ! entityConfig ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tresourcePath =\n\t\t\t\tentityConfig.baseURL + ( resource.id ? '/' + resource.id : '' );\n\t\t} else {\n\t\t\tresourcePath = `/wp/v2/${ resource }` + ( id ? '/' + id : '' );\n\t\t}\n\n\t\tlet response;\n\t\ttry {\n\t\t\tresponse = await apiFetch( {\n\t\t\t\tpath: resourcePath,\n\t\t\t\tmethod: 'OPTIONS',\n\t\t\t\tparse: false,\n\t\t\t} );\n\t\t} catch ( error ) {\n\t\t\t// Do nothing if our OPTIONS request comes back with an API error (4xx or\n\t\t\t// 5xx). The previously determined isAllowed value will remain in the store.\n\t\t\treturn;\n\t\t}\n\n\t\t// Optional chaining operator is used here because the API requests don't\n\t\t// return the expected result in the React native version. Instead, API requests\n\t\t// only return the result, without including response properties like the headers.\n\t\tconst permissions = getUserPermissionsFromAllowHeader(\n\t\t\tresponse.headers?.get( 'allow' )\n\t\t);\n\t\tregistry.batch( () => {\n\t\t\tfor ( const action of ALLOWED_RESOURCE_ACTIONS ) {\n\t\t\t\tconst key = getUserPermissionCacheKey( action, resource, id );\n\n\t\t\t\tdispatch.receiveUserPermission( key, permissions[ action ] );\n\n\t\t\t\t// Mark related action resolutions as finished.\n\t\t\t\tif ( action !== requestedAction ) {\n\t\t\t\t\tdispatch.finishResolution( 'canUser', [\n\t\t\t\t\t\taction,\n\t\t\t\t\t\tresource,\n\t\t\t\t\t\tid,\n\t\t\t\t\t] );\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t};\n\n/**\n * Checks whether the current user can perform the given action on the given\n * REST resource.\n *\n * @param {string}        kind     Entity kind.\n * @param {string}        name     Entity name.\n * @param {number|string} recordId Record's id.\n */\nexport const canUserEditEntityRecord =\n\t( kind, name, recordId ) =>\n\tasync ( { dispatch } ) => {\n\t\tawait dispatch( canUser( 'update', { kind, name, id: recordId } ) );\n\t};\n\n/**\n * Request autosave data from the REST API.\n *\n * @param {string} postType The type of the parent post.\n * @param {number} postId   The id of the parent post.\n */\nexport const getAutosaves =\n\t( postType, postId ) =>\n\tasync ( { dispatch, resolveSelect } ) => {\n\t\tconst {\n\t\t\trest_base: restBase,\n\t\t\trest_namespace: restNamespace = 'wp/v2',\n\t\t\tsupports,\n\t\t} = await resolveSelect.getPostType( postType );\n\t\tif ( ! supports?.autosave ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst autosaves = await apiFetch( {\n\t\t\tpath: `/${ restNamespace }/${ restBase }/${ postId }/autosaves?context=edit`,\n\t\t} );\n\n\t\tif ( autosaves && autosaves.length ) {\n\t\t\tdispatch.receiveAutosaves( postId, autosaves );\n\t\t}\n\t};\n\n/**\n * Request autosave data from the REST API.\n *\n * This resolver exists to ensure the underlying autosaves are fetched via\n * `getAutosaves` when a call to the `getAutosave` selector is made.\n *\n * @param {string} postType The type of the parent post.\n * @param {number} postId   The id of the parent post.\n */\nexport const getAutosave =\n\t( postType, postId ) =>\n\tasync ( { resolveSelect } ) => {\n\t\tawait resolveSelect.getAutosaves( postType, postId );\n\t};\n\nexport const __experimentalGetCurrentGlobalStylesId =\n\t() =>\n\tasync ( { dispatch, resolveSelect } ) => {\n\t\tconst activeThemes = await resolveSelect.getEntityRecords(\n\t\t\t'root',\n\t\t\t'theme',\n\t\t\t{ status: 'active' }\n\t\t);\n\t\tconst globalStylesURL =\n\t\t\tactiveThemes?.[ 0 ]?._links?.[ 'wp:user-global-styles' ]?.[ 0 ]\n\t\t\t\t?.href;\n\t\tif ( ! globalStylesURL ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Regex matches the ID at the end of a URL or immediately before\n\t\t// the query string.\n\t\tconst matches = globalStylesURL.match( /\\/(\\d+)(?:\\?|$)/ );\n\t\tconst id = matches ? Number( matches[ 1 ] ) : null;\n\n\t\tif ( id ) {\n\t\t\tdispatch.__experimentalReceiveCurrentGlobalStylesId( id );\n\t\t}\n\t};\n\nexport const __experimentalGetCurrentThemeBaseGlobalStyles =\n\t() =>\n\tasync ( { resolveSelect, dispatch } ) => {\n\t\tconst currentTheme = await resolveSelect.getCurrentTheme();\n\t\t// Please adjust the preloaded requests if this changes!\n\t\tconst themeGlobalStyles = await apiFetch( {\n\t\t\tpath: `/wp/v2/global-styles/themes/${ currentTheme.stylesheet }?context=view`,\n\t\t} );\n\t\tdispatch.__experimentalReceiveThemeBaseGlobalStyles(\n\t\t\tcurrentTheme.stylesheet,\n\t\t\tthemeGlobalStyles\n\t\t);\n\t};\n\nexport const __experimentalGetCurrentThemeGlobalStylesVariations =\n\t() =>\n\tasync ( { resolveSelect, dispatch } ) => {\n\t\tconst currentTheme = await resolveSelect.getCurrentTheme();\n\t\t// Please adjust the preloaded requests if this changes!\n\t\tconst variations = await apiFetch( {\n\t\t\tpath: `/wp/v2/global-styles/themes/${ currentTheme.stylesheet }/variations?context=view`,\n\t\t} );\n\t\tdispatch.__experimentalReceiveThemeGlobalStyleVariations(\n\t\t\tcurrentTheme.stylesheet,\n\t\t\tvariations\n\t\t);\n\t};\n\n/**\n * Fetches and returns the revisions of the current global styles theme.\n */\nexport const getCurrentThemeGlobalStylesRevisions =\n\t() =>\n\tasync ( { resolveSelect, dispatch } ) => {\n\t\tconst globalStylesId =\n\t\t\tawait resolveSelect.__experimentalGetCurrentGlobalStylesId();\n\t\tconst record = globalStylesId\n\t\t\t? await resolveSelect.getEntityRecord(\n\t\t\t\t\t'root',\n\t\t\t\t\t'globalStyles',\n\t\t\t\t\tglobalStylesId\n\t\t\t  )\n\t\t\t: undefined;\n\t\tconst revisionsURL = record?._links?.[ 'version-history' ]?.[ 0 ]?.href;\n\n\t\tif ( revisionsURL ) {\n\t\t\tconst resetRevisions = await apiFetch( {\n\t\t\t\turl: revisionsURL,\n\t\t\t} );\n\t\t\tconst revisions = resetRevisions?.map( ( revision ) =>\n\t\t\t\tObject.fromEntries(\n\t\t\t\t\tObject.entries( revision ).map( ( [ key, value ] ) => [\n\t\t\t\t\t\tcamelCase( key ),\n\t\t\t\t\t\tvalue,\n\t\t\t\t\t] )\n\t\t\t\t)\n\t\t\t);\n\t\t\tdispatch.receiveThemeGlobalStyleRevisions(\n\t\t\t\tglobalStylesId,\n\t\t\t\trevisions\n\t\t\t);\n\t\t}\n\t};\n\ngetCurrentThemeGlobalStylesRevisions.shouldInvalidate = ( action ) => {\n\treturn (\n\t\taction.type === 'SAVE_ENTITY_RECORD_FINISH' &&\n\t\taction.kind === 'root' &&\n\t\t! action.error &&\n\t\taction.name === 'globalStyles'\n\t);\n};\n\nexport const getBlockPatterns =\n\t() =>\n\tasync ( { dispatch } ) => {\n\t\tconst patterns = await fetchBlockPatterns();\n\t\tdispatch( { type: 'RECEIVE_BLOCK_PATTERNS', patterns } );\n\t};\n\nexport const getBlockPatternCategories =\n\t() =>\n\tasync ( { dispatch } ) => {\n\t\tconst categories = await apiFetch( {\n\t\t\tpath: '/wp/v2/block-patterns/categories',\n\t\t} );\n\t\tdispatch( { type: 'RECEIVE_BLOCK_PATTERN_CATEGORIES', categories } );\n\t};\n\nexport const getUserPatternCategories =\n\t() =>\n\tasync ( { dispatch, resolveSelect } ) => {\n\t\tconst patternCategories = await resolveSelect.getEntityRecords(\n\t\t\t'taxonomy',\n\t\t\t'wp_pattern_category',\n\t\t\t{\n\t\t\t\tper_page: -1,\n\t\t\t\t_fields: 'id,name,description,slug',\n\t\t\t\tcontext: 'view',\n\t\t\t}\n\t\t);\n\n\t\tconst mappedPatternCategories =\n\t\t\tpatternCategories?.map( ( userCategory ) => ( {\n\t\t\t\t...userCategory,\n\t\t\t\tlabel: decodeEntities( userCategory.name ),\n\t\t\t\tname: userCategory.slug,\n\t\t\t} ) ) || [];\n\n\t\tdispatch( {\n\t\t\ttype: 'RECEIVE_USER_PATTERN_CATEGORIES',\n\t\t\tpatternCategories: mappedPatternCategories,\n\t\t} );\n\t};\n\nexport const getNavigationFallbackId =\n\t() =>\n\tasync ( { dispatch, select, registry } ) => {\n\t\tconst fallback = await apiFetch( {\n\t\t\tpath: addQueryArgs( '/wp-block-editor/v1/navigation-fallback', {\n\t\t\t\t_embed: true,\n\t\t\t} ),\n\t\t} );\n\n\t\tconst record = fallback?._embedded?.self;\n\n\t\tregistry.batch( () => {\n\t\t\tdispatch.receiveNavigationFallbackId( fallback?.id );\n\n\t\t\tif ( ! record ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// If the fallback is already in the store, don't invalidate navigation queries.\n\t\t\t// Otherwise, invalidate the cache for the scenario where there were no Navigation\n\t\t\t// posts in the state and the fallback created one.\n\t\t\tconst existingFallbackEntityRecord = select.getEntityRecord(\n\t\t\t\t'postType',\n\t\t\t\t'wp_navigation',\n\t\t\t\tfallback.id\n\t\t\t);\n\t\t\tconst invalidateNavigationQueries = ! existingFallbackEntityRecord;\n\t\t\tdispatch.receiveEntityRecords(\n\t\t\t\t'postType',\n\t\t\t\t'wp_navigation',\n\t\t\t\trecord,\n\t\t\t\tundefined,\n\t\t\t\tinvalidateNavigationQueries\n\t\t\t);\n\n\t\t\t// Resolve to avoid further network requests.\n\t\t\tdispatch.finishResolution( 'getEntityRecord', [\n\t\t\t\t'postType',\n\t\t\t\t'wp_navigation',\n\t\t\t\tfallback.id,\n\t\t\t] );\n\t\t} );\n\t};\n\nexport const getDefaultTemplateId =\n\t( query ) =>\n\tasync ( { dispatch, registry, resolveSelect } ) => {\n\t\tconst template = await apiFetch( {\n\t\t\tpath: addQueryArgs( '/wp/v2/templates/lookup', query ),\n\t\t} );\n\t\t// Wait for the the entities config to be loaded, otherwise receiving\n\t\t// the template as an entity will not work.\n\t\tawait resolveSelect.getEntitiesConfig( 'postType' );\n\t\t// Endpoint may return an empty object if no template is found.\n\t\tif ( template?.id ) {\n\t\t\tregistry.batch( () => {\n\t\t\t\tdispatch.receiveDefaultTemplateId( query, template.id );\n\t\t\t\tdispatch.receiveEntityRecords( 'postType', 'wp_template', [\n\t\t\t\t\ttemplate,\n\t\t\t\t] );\n\t\t\t\t// Avoid further network requests.\n\t\t\t\tdispatch.finishResolution( 'getEntityRecord', [\n\t\t\t\t\t'postType',\n\t\t\t\t\t'wp_template',\n\t\t\t\t\ttemplate.id,\n\t\t\t\t] );\n\t\t\t} );\n\t\t}\n\t};\n\n/**\n * Requests an entity's revisions from the REST API.\n *\n * @param {string}           kind      Entity kind.\n * @param {string}           name      Entity name.\n * @param {number|string}    recordKey The key of the entity record whose revisions you want to fetch.\n * @param {Object|undefined} query     Optional object of query parameters to\n *                                     include with request. If requesting specific\n *                                     fields, fields must always include the ID.\n */\nexport const getRevisions =\n\t( kind, name, recordKey, query = {} ) =>\n\tasync ( { dispatch, registry, resolveSelect } ) => {\n\t\tconst configs = await resolveSelect.getEntitiesConfig( kind );\n\t\tconst entityConfig = configs.find(\n\t\t\t( config ) => config.name === name && config.kind === kind\n\t\t);\n\n\t\tif ( ! entityConfig ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( query._fields ) {\n\t\t\t// If requesting specific fields, items and query association to said\n\t\t\t// records are stored by ID reference. Thus, fields must always include\n\t\t\t// the ID.\n\t\t\tquery = {\n\t\t\t\t...query,\n\t\t\t\t_fields: [\n\t\t\t\t\t...new Set( [\n\t\t\t\t\t\t...( getNormalizedCommaSeparable( query._fields ) ||\n\t\t\t\t\t\t\t[] ),\n\t\t\t\t\t\tentityConfig.revisionKey || DEFAULT_ENTITY_KEY,\n\t\t\t\t\t] ),\n\t\t\t\t].join(),\n\t\t\t};\n\t\t}\n\n\t\tconst path = addQueryArgs(\n\t\t\tentityConfig.getRevisionsUrl( recordKey ),\n\t\t\tquery\n\t\t);\n\n\t\tlet records, response;\n\t\tconst meta = {};\n\t\tconst isPaginated =\n\t\t\tentityConfig.supportsPagination && query.per_page !== -1;\n\t\ttry {\n\t\t\tresponse = await apiFetch( { path, parse: ! isPaginated } );\n\t\t} catch ( error ) {\n\t\t\t// Do nothing if our request comes back with an API error.\n\t\t\treturn;\n\t\t}\n\n\t\tif ( response ) {\n\t\t\tif ( isPaginated ) {\n\t\t\t\trecords = Object.values( await response.json() );\n\t\t\t\tmeta.totalItems = parseInt(\n\t\t\t\t\tresponse.headers.get( 'X-WP-Total' )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\trecords = Object.values( response );\n\t\t\t}\n\n\t\t\t// If we request fields but the result doesn't contain the fields,\n\t\t\t// explicitly set these fields as \"undefined\"\n\t\t\t// that way we consider the query \"fulfilled\".\n\t\t\tif ( query._fields ) {\n\t\t\t\trecords = records.map( ( record ) => {\n\t\t\t\t\tquery._fields.split( ',' ).forEach( ( field ) => {\n\t\t\t\t\t\tif ( ! record.hasOwnProperty( field ) ) {\n\t\t\t\t\t\t\trecord[ field ] = undefined;\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\n\t\t\t\t\treturn record;\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\tregistry.batch( () => {\n\t\t\t\tdispatch.receiveRevisions(\n\t\t\t\t\tkind,\n\t\t\t\t\tname,\n\t\t\t\t\trecordKey,\n\t\t\t\t\trecords,\n\t\t\t\t\tquery,\n\t\t\t\t\tfalse,\n\t\t\t\t\tmeta\n\t\t\t\t);\n\n\t\t\t\t// When requesting all fields, the list of results can be used to\n\t\t\t\t// resolve the `getRevision` selector in addition to `getRevisions`.\n\t\t\t\tif ( ! query?._fields && ! query.context ) {\n\t\t\t\t\tconst key = entityConfig.key || DEFAULT_ENTITY_KEY;\n\t\t\t\t\tconst resolutionsArgs = records\n\t\t\t\t\t\t.filter( ( record ) => record[ key ] )\n\t\t\t\t\t\t.map( ( record ) => [\n\t\t\t\t\t\t\tkind,\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\trecordKey,\n\t\t\t\t\t\t\trecord[ key ],\n\t\t\t\t\t\t] );\n\n\t\t\t\t\tdispatch.finishResolutions(\n\t\t\t\t\t\t'getRevision',\n\t\t\t\t\t\tresolutionsArgs\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t};\n\n// Invalidate cache when a new revision is created.\ngetRevisions.shouldInvalidate = ( action, kind, name, recordKey ) =>\n\taction.type === 'SAVE_ENTITY_RECORD_FINISH' &&\n\tname === action.name &&\n\tkind === action.kind &&\n\t! action.error &&\n\trecordKey === action.recordId;\n\n/**\n * Requests a specific Entity revision from the REST API.\n *\n * @param {string}           kind        Entity kind.\n * @param {string}           name        Entity name.\n * @param {number|string}    recordKey   The key of the entity record whose revisions you want to fetch.\n * @param {number|string}    revisionKey The revision's key.\n * @param {Object|undefined} query       Optional object of query parameters to\n *                                       include with request. If requesting specific\n *                                       fields, fields must always include the ID.\n */\nexport const getRevision =\n\t( kind, name, recordKey, revisionKey, query ) =>\n\tasync ( { dispatch, resolveSelect } ) => {\n\t\tconst configs = await resolveSelect.getEntitiesConfig( kind );\n\t\tconst entityConfig = configs.find(\n\t\t\t( config ) => config.name === name && config.kind === kind\n\t\t);\n\n\t\tif ( ! entityConfig ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( query !== undefined && query._fields ) {\n\t\t\t// If requesting specific fields, items and query association to said\n\t\t\t// records are stored by ID reference. Thus, fields must always include\n\t\t\t// the ID.\n\t\t\tquery = {\n\t\t\t\t...query,\n\t\t\t\t_fields: [\n\t\t\t\t\t...new Set( [\n\t\t\t\t\t\t...( getNormalizedCommaSeparable( query._fields ) ||\n\t\t\t\t\t\t\t[] ),\n\t\t\t\t\t\tentityConfig.revisionKey || DEFAULT_ENTITY_KEY,\n\t\t\t\t\t] ),\n\t\t\t\t].join(),\n\t\t\t};\n\t\t}\n\t\tconst path = addQueryArgs(\n\t\t\tentityConfig.getRevisionsUrl( recordKey, revisionKey ),\n\t\t\tquery\n\t\t);\n\n\t\tlet record;\n\t\ttry {\n\t\t\trecord = await apiFetch( { path } );\n\t\t} catch ( error ) {\n\t\t\t// Do nothing if our request comes back with an API error.\n\t\t\treturn;\n\t\t}\n\n\t\tif ( record ) {\n\t\t\tdispatch.receiveRevisions( kind, name, recordKey, record, query );\n\t\t}\n\t};\n\n/**\n * Requests a specific post type options from the REST API.\n *\n * @param {string} postType Post type slug.\n */\nexport const getRegisteredPostMeta =\n\t( postType ) =>\n\tasync ( { dispatch, resolveSelect } ) => {\n\t\tlet options;\n\t\ttry {\n\t\t\tconst {\n\t\t\t\trest_namespace: restNamespace = 'wp/v2',\n\t\t\t\trest_base: restBase,\n\t\t\t} = ( await resolveSelect.getPostType( postType ) ) || {};\n\t\t\toptions = await apiFetch( {\n\t\t\t\tpath: `${ restNamespace }/${ restBase }/?context=edit`,\n\t\t\t\tmethod: 'OPTIONS',\n\t\t\t} );\n\t\t} catch ( error ) {\n\t\t\t// Do nothing if the request comes back with an API error.\n\t\t\treturn;\n\t\t}\n\n\t\tif ( options ) {\n\t\t\tdispatch.receiveRegisteredPostMeta(\n\t\t\t\tpostType,\n\t\t\t\toptions?.schema?.properties?.meta?.properties\n\t\t\t);\n\t\t}\n\t};\n\n/**\n * Requests entity configs for the given kind from the REST API.\n *\n * @param {string} kind Entity kind.\n */\nexport const getEntitiesConfig =\n\t( kind ) =>\n\tasync ( { dispatch } ) => {\n\t\tconst loader = additionalEntityConfigLoaders.find(\n\t\t\t( l ) => l.kind === kind\n\t\t);\n\n\t\tif ( ! loader ) {\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tconst configs = await loader.loadEntities();\n\t\t\tif ( ! configs.length ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdispatch.addEntities( configs );\n\t\t} catch {\n\t\t\t// Do nothing if the request comes back with an API error.\n\t\t}\n\t};\n"],"mappings":"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","ignoreList":[]}