{"version":3,"names":["IndexeddbPersistence","connectIndexDb","objectId","objectType","doc","roomName","provider","Promise","resolve","on","destroy"],"sources":["@wordpress/sync/src/connect-indexdb.js"],"sourcesContent":["/**\n * External dependencies\n */\n// @ts-ignore\nimport { IndexeddbPersistence } from 'y-indexeddb';\n\n/** @typedef {import('./types').ObjectType} ObjectType */\n/** @typedef {import('./types').ObjectID} ObjectID */\n/** @typedef {import('./types').CRDTDoc} CRDTDoc */\n/** @typedef {import('./types').ConnectDoc} ConnectDoc */\n/** @typedef {import('./types').SyncProvider} SyncProvider */\n\n/**\n * Connect function to the IndexedDB persistence provider.\n *\n * @param {ObjectID}   objectId   The object ID.\n * @param {ObjectType} objectType The object type.\n * @param {CRDTDoc}    doc        The CRDT document.\n *\n * @return {Promise<() => void>} Promise that resolves when the connection is established.\n */\nexport function connectIndexDb( objectId, objectType, doc ) {\n\tconst roomName = `${ objectType }-${ objectId }`;\n\tconst provider = new IndexeddbPersistence( roomName, doc );\n\n\treturn new Promise( ( resolve ) => {\n\t\tprovider.on( 'synced', () => {\n\t\t\tresolve( () => provider.destroy() );\n\t\t} );\n\t} );\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAASA,oBAAoB,QAAQ,aAAa;;AAElD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,cAAcA,CAAEC,QAAQ,EAAEC,UAAU,EAAEC,GAAG,EAAG;EAC3D,MAAMC,QAAQ,GAAG,GAAIF,UAAU,IAAMD,QAAQ,EAAG;EAChD,MAAMI,QAAQ,GAAG,IAAIN,oBAAoB,CAAEK,QAAQ,EAAED,GAAI,CAAC;EAE1D,OAAO,IAAIG,OAAO,CAAIC,OAAO,IAAM;IAClCF,QAAQ,CAACG,EAAE,CAAE,QAAQ,EAAE,MAAM;MAC5BD,OAAO,CAAE,MAAMF,QAAQ,CAACI,OAAO,CAAC,CAAE,CAAC;IACpC,CAAE,CAAC;EACJ,CAAE,CAAC;AACJ","ignoreList":[]}