{"version":3,"names":["_clsx","_interopRequireDefault","require","_blockEditor","_components","_icons","_i18n","_element","_coreData","_widgetTypeSelector","_inspectorCard","_form","_preview","_noPreview","_convertToBlocksButton","_jsxRuntime","Edit","props","id","idBase","attributes","isWide","blockProps","useBlockProps","className","clsx","jsx","children","Empty","NotEmpty","setAttributes","Placeholder","icon","BlockIcon","brushIcon","label","__","Flex","FlexBlock","default","selectedId","onSelect","isMulti","instance","clientId","isSelected","hasPreview","setHasPreview","useState","widgetTypeId","record","widgetType","hasResolved","hasResolvedWidgetType","useEntityRecord","setInstance","useCallback","nextInstance","Spinner","mode","jsxs","Fragment","BlockControls","group","rawInstance","raw","InspectorControls","name","description","title","isVisible","onChangeInstance","onChangeHasPreview"],"sources":["@wordpress/widgets/src/blocks/legacy-widget/edit/index.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport clsx from 'clsx';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tuseBlockProps,\n\tBlockControls,\n\tInspectorControls,\n\tBlockIcon,\n} from '@wordpress/block-editor';\nimport { Flex, FlexBlock, Spinner, Placeholder } from '@wordpress/components';\nimport { brush as brushIcon } from '@wordpress/icons';\nimport { __ } from '@wordpress/i18n';\nimport { useState, useCallback } from '@wordpress/element';\nimport { useEntityRecord } from '@wordpress/core-data';\n\n/**\n * Internal dependencies\n */\nimport WidgetTypeSelector from './widget-type-selector';\nimport InspectorCard from './inspector-card';\nimport Form from './form';\nimport Preview from './preview';\nimport NoPreview from './no-preview';\nimport ConvertToBlocksButton from './convert-to-blocks-button';\n\nexport default function Edit( props ) {\n\tconst { id, idBase } = props.attributes;\n\tconst { isWide = false } = props;\n\n\tconst blockProps = useBlockProps( {\n\t\tclassName: clsx( {\n\t\t\t'is-wide-widget': isWide,\n\t\t} ),\n\t} );\n\n\treturn (\n\t\t<div { ...blockProps }>\n\t\t\t{ ! id && ! idBase ? (\n\t\t\t\t<Empty { ...props } />\n\t\t\t) : (\n\t\t\t\t<NotEmpty { ...props } />\n\t\t\t) }\n\t\t</div>\n\t);\n}\n\nfunction Empty( { attributes: { id, idBase }, setAttributes } ) {\n\treturn (\n\t\t<Placeholder\n\t\t\ticon={ <BlockIcon icon={ brushIcon } /> }\n\t\t\tlabel={ __( 'Legacy Widget' ) }\n\t\t>\n\t\t\t<Flex>\n\t\t\t\t<FlexBlock>\n\t\t\t\t\t<WidgetTypeSelector\n\t\t\t\t\t\tselectedId={ id ?? idBase }\n\t\t\t\t\t\tonSelect={ ( { selectedId, isMulti } ) => {\n\t\t\t\t\t\t\tif ( ! selectedId ) {\n\t\t\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\t\t\tid: null,\n\t\t\t\t\t\t\t\t\tidBase: null,\n\t\t\t\t\t\t\t\t\tinstance: null,\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t} else if ( isMulti ) {\n\t\t\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\t\t\tid: null,\n\t\t\t\t\t\t\t\t\tidBase: selectedId,\n\t\t\t\t\t\t\t\t\tinstance: {},\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\t\t\tid: selectedId,\n\t\t\t\t\t\t\t\t\tidBase: null,\n\t\t\t\t\t\t\t\t\tinstance: null,\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t</FlexBlock>\n\t\t\t</Flex>\n\t\t</Placeholder>\n\t);\n}\n\nfunction NotEmpty( {\n\tattributes: { id, idBase, instance },\n\tsetAttributes,\n\tclientId,\n\tisSelected,\n\tisWide = false,\n} ) {\n\tconst [ hasPreview, setHasPreview ] = useState( null );\n\n\tconst widgetTypeId = id ?? idBase;\n\tconst { record: widgetType, hasResolved: hasResolvedWidgetType } =\n\t\tuseEntityRecord( 'root', 'widgetType', widgetTypeId );\n\n\tconst setInstance = useCallback( ( nextInstance ) => {\n\t\tsetAttributes( { instance: nextInstance } );\n\t}, [] );\n\n\tif ( ! widgetType && hasResolvedWidgetType ) {\n\t\treturn (\n\t\t\t<Placeholder\n\t\t\t\ticon={ <BlockIcon icon={ brushIcon } /> }\n\t\t\t\tlabel={ __( 'Legacy Widget' ) }\n\t\t\t>\n\t\t\t\t{ __( 'Widget is missing.' ) }\n\t\t\t</Placeholder>\n\t\t);\n\t}\n\n\tif ( ! hasResolvedWidgetType ) {\n\t\treturn (\n\t\t\t<Placeholder>\n\t\t\t\t<Spinner />\n\t\t\t</Placeholder>\n\t\t);\n\t}\n\n\tconst mode = idBase && ! isSelected ? 'preview' : 'edit';\n\n\treturn (\n\t\t<>\n\t\t\t{ idBase === 'text' && (\n\t\t\t\t<BlockControls group=\"other\">\n\t\t\t\t\t<ConvertToBlocksButton\n\t\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\t\trawInstance={ instance.raw }\n\t\t\t\t\t/>\n\t\t\t\t</BlockControls>\n\t\t\t) }\n\n\t\t\t<InspectorControls>\n\t\t\t\t<InspectorCard\n\t\t\t\t\tname={ widgetType.name }\n\t\t\t\t\tdescription={ widgetType.description }\n\t\t\t\t/>\n\t\t\t</InspectorControls>\n\n\t\t\t<Form\n\t\t\t\ttitle={ widgetType.name }\n\t\t\t\tisVisible={ mode === 'edit' }\n\t\t\t\tid={ id }\n\t\t\t\tidBase={ idBase }\n\t\t\t\tinstance={ instance }\n\t\t\t\tisWide={ isWide }\n\t\t\t\tonChangeInstance={ setInstance }\n\t\t\t\tonChangeHasPreview={ setHasPreview }\n\t\t\t/>\n\n\t\t\t{ idBase && (\n\t\t\t\t<>\n\t\t\t\t\t{ hasPreview === null && mode === 'preview' && (\n\t\t\t\t\t\t<Placeholder>\n\t\t\t\t\t\t\t<Spinner />\n\t\t\t\t\t\t</Placeholder>\n\t\t\t\t\t) }\n\t\t\t\t\t{ hasPreview === true && (\n\t\t\t\t\t\t<Preview\n\t\t\t\t\t\t\tidBase={ idBase }\n\t\t\t\t\t\t\tinstance={ instance }\n\t\t\t\t\t\t\tisVisible={ mode === 'preview' }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t{ hasPreview === false && mode === 'preview' && (\n\t\t\t\t\t\t<NoPreview name={ widgetType.name } />\n\t\t\t\t\t) }\n\t\t\t\t</>\n\t\t\t) }\n\t\t</>\n\t);\n}\n"],"mappings":"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","ignoreList":[]}