{"version":3,"names":["useObservableValue","useContext","useLayoutEffect","useRef","Children","cloneElement","isEmptyElement","SlotFillContext","Fragment","_Fragment","jsx","_jsx","isFunction","maybeFunc","addKeysToChildren","children","map","child","childIndex","childKey","key","Slot","props","_useObservableValue","registry","instanceRef","name","fillProps","instance","current","registerSlot","unregisterSlot","fills","currentSlot","slots","renderedFills","fill","fillChildren","filter","element"],"sources":["@wordpress/components/src/slot-fill/slot.tsx"],"sourcesContent":["/**\n * External dependencies\n */\nimport type { ReactElement, ReactNode, Key } from 'react';\n\n/**\n * WordPress dependencies\n */\nimport { useObservableValue } from '@wordpress/compose';\nimport {\n\tuseContext,\n\tuseLayoutEffect,\n\tuseRef,\n\tChildren,\n\tcloneElement,\n\tisEmptyElement,\n} from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport SlotFillContext from './context';\nimport type { SlotComponentProps } from './types';\n\n/**\n * Whether the argument is a function.\n *\n * @param maybeFunc The argument to check.\n * @return True if the argument is a function, false otherwise.\n */\nfunction isFunction( maybeFunc: any ): maybeFunc is Function {\n\treturn typeof maybeFunc === 'function';\n}\n\nfunction addKeysToChildren( children: ReactNode ) {\n\treturn Children.map( children, ( child, childIndex ) => {\n\t\tif ( ! child || typeof child === 'string' ) {\n\t\t\treturn child;\n\t\t}\n\t\tlet childKey: Key = childIndex;\n\t\tif ( typeof child === 'object' && 'key' in child && child?.key ) {\n\t\t\tchildKey = child.key;\n\t\t}\n\n\t\treturn cloneElement( child as ReactElement, {\n\t\t\tkey: childKey,\n\t\t} );\n\t} );\n}\n\nfunction Slot( props: Omit< SlotComponentProps, 'bubblesVirtually' > ) {\n\tconst registry = useContext( SlotFillContext );\n\tconst instanceRef = useRef( {} );\n\n\tconst { name, children, fillProps = {} } = props;\n\n\tuseLayoutEffect( () => {\n\t\tconst instance = instanceRef.current;\n\t\tregistry.registerSlot( name, instance );\n\t\treturn () => registry.unregisterSlot( name, instance );\n\t}, [ registry, name ] );\n\n\tlet fills = useObservableValue( registry.fills, name ) ?? [];\n\tconst currentSlot = useObservableValue( registry.slots, name );\n\n\t// Fills should only be rendered in the currently registered instance of the slot.\n\tif ( currentSlot !== instanceRef.current ) {\n\t\tfills = [];\n\t}\n\n\tconst renderedFills = fills\n\t\t.map( ( fill ) => {\n\t\t\tconst fillChildren = isFunction( fill.children )\n\t\t\t\t? fill.children( fillProps )\n\t\t\t\t: fill.children;\n\t\t\treturn addKeysToChildren( fillChildren );\n\t\t} )\n\t\t.filter(\n\t\t\t// In some cases fills are rendered only when some conditions apply.\n\t\t\t// This ensures that we only use non-empty fills when rendering, i.e.,\n\t\t\t// it allows us to render wrappers only when the fills are actually present.\n\t\t\t( element ) => ! isEmptyElement( element )\n\t\t);\n\n\treturn (\n\t\t<>\n\t\t\t{ isFunction( children )\n\t\t\t\t? children( renderedFills )\n\t\t\t\t: renderedFills }\n\t\t</>\n\t);\n}\n\nexport default Slot;\n"],"mappings":"AAAA;AACA;AACA;;AAGA;AACA;AACA;AACA,SAASA,kBAAkB,QAAQ,oBAAoB;AACvD,SACCC,UAAU,EACVC,eAAe,EACfC,MAAM,EACNC,QAAQ,EACRC,YAAY,EACZC,cAAc,QACR,oBAAoB;;AAE3B;AACA;AACA;AACA,OAAOC,eAAe,MAAM,WAAW;AAAC,SAAAC,QAAA,IAAAC,SAAA,EAAAC,GAAA,IAAAC,IAAA;AAGxC;AACA;AACA;AACA;AACA;AACA;AACA,SAASC,UAAUA,CAAEC,SAAc,EAA0B;EAC5D,OAAO,OAAOA,SAAS,KAAK,UAAU;AACvC;AAEA,SAASC,iBAAiBA,CAAEC,QAAmB,EAAG;EACjD,OAAOX,QAAQ,CAACY,GAAG,CAAED,QAAQ,EAAE,CAAEE,KAAK,EAAEC,UAAU,KAAM;IACvD,IAAK,CAAED,KAAK,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAG;MAC3C,OAAOA,KAAK;IACb;IACA,IAAIE,QAAa,GAAGD,UAAU;IAC9B,IAAK,OAAOD,KAAK,KAAK,QAAQ,IAAI,KAAK,IAAIA,KAAK,IAAIA,KAAK,EAAEG,GAAG,EAAG;MAChED,QAAQ,GAAGF,KAAK,CAACG,GAAG;IACrB;IAEA,OAAOf,YAAY,CAAEY,KAAK,EAAkB;MAC3CG,GAAG,EAAED;IACN,CAAE,CAAC;EACJ,CAAE,CAAC;AACJ;AAEA,SAASE,IAAIA,CAAEC,KAAqD,EAAG;EAAA,IAAAC,mBAAA;EACtE,MAAMC,QAAQ,GAAGvB,UAAU,CAAEM,eAAgB,CAAC;EAC9C,MAAMkB,WAAW,GAAGtB,MAAM,CAAE,CAAC,CAAE,CAAC;EAEhC,MAAM;IAAEuB,IAAI;IAAEX,QAAQ;IAAEY,SAAS,GAAG,CAAC;EAAE,CAAC,GAAGL,KAAK;EAEhDpB,eAAe,CAAE,MAAM;IACtB,MAAM0B,QAAQ,GAAGH,WAAW,CAACI,OAAO;IACpCL,QAAQ,CAACM,YAAY,CAAEJ,IAAI,EAAEE,QAAS,CAAC;IACvC,OAAO,MAAMJ,QAAQ,CAACO,cAAc,CAAEL,IAAI,EAAEE,QAAS,CAAC;EACvD,CAAC,EAAE,CAAEJ,QAAQ,EAAEE,IAAI,CAAG,CAAC;EAEvB,IAAIM,KAAK,IAAAT,mBAAA,GAAGvB,kBAAkB,CAAEwB,QAAQ,CAACQ,KAAK,EAAEN,IAAK,CAAC,cAAAH,mBAAA,cAAAA,mBAAA,GAAI,EAAE;EAC5D,MAAMU,WAAW,GAAGjC,kBAAkB,CAAEwB,QAAQ,CAACU,KAAK,EAAER,IAAK,CAAC;;EAE9D;EACA,IAAKO,WAAW,KAAKR,WAAW,CAACI,OAAO,EAAG;IAC1CG,KAAK,GAAG,EAAE;EACX;EAEA,MAAMG,aAAa,GAAGH,KAAK,CACzBhB,GAAG,CAAIoB,IAAI,IAAM;IACjB,MAAMC,YAAY,GAAGzB,UAAU,CAAEwB,IAAI,CAACrB,QAAS,CAAC,GAC7CqB,IAAI,CAACrB,QAAQ,CAAEY,SAAU,CAAC,GAC1BS,IAAI,CAACrB,QAAQ;IAChB,OAAOD,iBAAiB,CAAEuB,YAAa,CAAC;EACzC,CAAE,CAAC,CACFC,MAAM;EACN;EACA;EACA;EACEC,OAAO,IAAM,CAAEjC,cAAc,CAAEiC,OAAQ,CAC1C,CAAC;EAEF,oBACC5B,IAAA,CAAAF,SAAA;IAAAM,QAAA,EACGH,UAAU,CAAEG,QAAS,CAAC,GACrBA,QAAQ,CAAEoB,aAAc,CAAC,GACzBA;EAAa,CACf,CAAC;AAEL;AAEA,eAAed,IAAI","ignoreList":[]}