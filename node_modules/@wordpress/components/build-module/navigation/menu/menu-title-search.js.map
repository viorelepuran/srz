{"version":3,"names":["useEffect","useRef","__","_n","sprintf","withSpokenMessages","useNavigationMenuContext","useNavigationContext","SEARCH_FOCUS_DELAY","SearchControl","MenuTitleSearchControlWrapper","jsx","_jsx","MenuTitleSearch","debouncedSpeak","onCloseSearch","onSearch","search","title","navigationTree","items","menu","inputRef","delayedFocus","setTimeout","current","focus","clearTimeout","count","Object","values","filter","item","_isVisible","length","resultsFoundMessage","onClose","onKeyDown","event","code","defaultPrevented","preventDefault","inputId","placeholder","toLowerCase","trim","children","__nextHasNoMarginBottom","className","id","onChange","value","ref"],"sources":["@wordpress/components/src/navigation/menu/menu-title-search.tsx"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useEffect, useRef } from '@wordpress/element';\nimport { __, _n, sprintf } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport withSpokenMessages from '../../higher-order/with-spoken-messages';\nimport { useNavigationMenuContext } from './context';\nimport { useNavigationContext } from '../context';\nimport { SEARCH_FOCUS_DELAY } from '../constants';\n\nimport type { NavigationMenuTitleSearchProps } from '../types';\nimport SearchControl from '../../search-control';\nimport { MenuTitleSearchControlWrapper } from '../styles/navigation-styles';\n\nfunction MenuTitleSearch( {\n\tdebouncedSpeak,\n\tonCloseSearch,\n\tonSearch,\n\tsearch,\n\ttitle,\n}: NavigationMenuTitleSearchProps ) {\n\tconst {\n\t\tnavigationTree: { items },\n\t} = useNavigationContext();\n\tconst { menu } = useNavigationMenuContext();\n\tconst inputRef = useRef< HTMLInputElement >( null );\n\n\t// Wait for the slide-in animation to complete before autofocusing the input.\n\t// This prevents scrolling to the input during the animation.\n\tuseEffect( () => {\n\t\tconst delayedFocus = setTimeout( () => {\n\t\t\tinputRef.current?.focus();\n\t\t}, SEARCH_FOCUS_DELAY );\n\n\t\treturn () => {\n\t\t\tclearTimeout( delayedFocus );\n\t\t};\n\t}, [] );\n\n\tuseEffect( () => {\n\t\tif ( ! search ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst count = Object.values( items ).filter(\n\t\t\t( item ) => item._isVisible\n\t\t).length;\n\t\tconst resultsFoundMessage = sprintf(\n\t\t\t/* translators: %d: number of results. */\n\t\t\t_n( '%d result found.', '%d results found.', count ),\n\t\t\tcount\n\t\t);\n\t\tdebouncedSpeak( resultsFoundMessage );\n\t\t// Not adding deps for now, as it would require either a larger refactor.\n\t\t// See https://github.com/WordPress/gutenberg/pull/44090\n\t}, [ items, search ] );\n\n\tconst onClose = () => {\n\t\tonSearch?.( '' );\n\t\tonCloseSearch();\n\t};\n\n\tconst onKeyDown: React.KeyboardEventHandler< HTMLInputElement > = (\n\t\tevent\n\t) => {\n\t\tif ( event.code === 'Escape' && ! event.defaultPrevented ) {\n\t\t\tevent.preventDefault();\n\t\t\tonClose();\n\t\t}\n\t};\n\n\tconst inputId = `components-navigation__menu-title-search-${ menu }`;\n\tconst placeholder = sprintf(\n\t\t/* translators: placeholder for menu search box. %s: menu title */\n\t\t__( 'Search %s' ),\n\t\ttitle?.toLowerCase()\n\t).trim();\n\n\treturn (\n\t\t<MenuTitleSearchControlWrapper>\n\t\t\t<SearchControl\n\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\tclassName=\"components-navigation__menu-search-input\"\n\t\t\t\tid={ inputId }\n\t\t\t\tonChange={ ( value ) => onSearch?.( value ) }\n\t\t\t\tonKeyDown={ onKeyDown }\n\t\t\t\tplaceholder={ placeholder }\n\t\t\t\tonClose={ onClose }\n\t\t\t\tref={ inputRef }\n\t\t\t\tvalue={ search }\n\t\t\t/>\n\t\t</MenuTitleSearchControlWrapper>\n\t);\n}\n\nexport default withSpokenMessages( MenuTitleSearch );\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAS,EAAEC,MAAM,QAAQ,oBAAoB;AACtD,SAASC,EAAE,EAAEC,EAAE,EAAEC,OAAO,QAAQ,iBAAiB;;AAEjD;AACA;AACA;AACA,OAAOC,kBAAkB,MAAM,yCAAyC;AACxE,SAASC,wBAAwB,QAAQ,WAAW;AACpD,SAASC,oBAAoB,QAAQ,YAAY;AACjD,SAASC,kBAAkB,QAAQ,cAAc;AAGjD,OAAOC,aAAa,MAAM,sBAAsB;AAChD,SAASC,6BAA6B,QAAQ,6BAA6B;AAAC,SAAAC,GAAA,IAAAC,IAAA;AAE5E,SAASC,eAAeA,CAAE;EACzBC,cAAc;EACdC,aAAa;EACbC,QAAQ;EACRC,MAAM;EACNC;AAC+B,CAAC,EAAG;EACnC,MAAM;IACLC,cAAc,EAAE;MAAEC;IAAM;EACzB,CAAC,GAAGb,oBAAoB,CAAC,CAAC;EAC1B,MAAM;IAAEc;EAAK,CAAC,GAAGf,wBAAwB,CAAC,CAAC;EAC3C,MAAMgB,QAAQ,GAAGrB,MAAM,CAAsB,IAAK,CAAC;;EAEnD;EACA;EACAD,SAAS,CAAE,MAAM;IAChB,MAAMuB,YAAY,GAAGC,UAAU,CAAE,MAAM;MACtCF,QAAQ,CAACG,OAAO,EAAEC,KAAK,CAAC,CAAC;IAC1B,CAAC,EAAElB,kBAAmB,CAAC;IAEvB,OAAO,MAAM;MACZmB,YAAY,CAAEJ,YAAa,CAAC;IAC7B,CAAC;EACF,CAAC,EAAE,EAAG,CAAC;EAEPvB,SAAS,CAAE,MAAM;IAChB,IAAK,CAAEiB,MAAM,EAAG;MACf;IACD;IAEA,MAAMW,KAAK,GAAGC,MAAM,CAACC,MAAM,CAAEV,KAAM,CAAC,CAACW,MAAM,CACxCC,IAAI,IAAMA,IAAI,CAACC,UAClB,CAAC,CAACC,MAAM;IACR,MAAMC,mBAAmB,GAAG/B,OAAO,CAClC;IACAD,EAAE,CAAE,kBAAkB,EAAE,mBAAmB,EAAEyB,KAAM,CAAC,EACpDA,KACD,CAAC;IACDd,cAAc,CAAEqB,mBAAoB,CAAC;IACrC;IACA;EACD,CAAC,EAAE,CAAEf,KAAK,EAAEH,MAAM,CAAG,CAAC;EAEtB,MAAMmB,OAAO,GAAGA,CAAA,KAAM;IACrBpB,QAAQ,GAAI,EAAG,CAAC;IAChBD,aAAa,CAAC,CAAC;EAChB,CAAC;EAED,MAAMsB,SAAyD,GAC9DC,KAAK,IACD;IACJ,IAAKA,KAAK,CAACC,IAAI,KAAK,QAAQ,IAAI,CAAED,KAAK,CAACE,gBAAgB,EAAG;MAC1DF,KAAK,CAACG,cAAc,CAAC,CAAC;MACtBL,OAAO,CAAC,CAAC;IACV;EACD,CAAC;EAED,MAAMM,OAAO,GAAG,4CAA6CrB,IAAI,EAAG;EACpE,MAAMsB,WAAW,GAAGvC,OAAO,CAC1B;EACAF,EAAE,CAAE,WAAY,CAAC,EACjBgB,KAAK,EAAE0B,WAAW,CAAC,CACpB,CAAC,CAACC,IAAI,CAAC,CAAC;EAER,oBACCjC,IAAA,CAACF,6BAA6B;IAAAoC,QAAA,eAC7BlC,IAAA,CAACH,aAAa;MACbsC,uBAAuB;MACvBC,SAAS,EAAC,0CAA0C;MACpDC,EAAE,EAAGP,OAAS;MACdQ,QAAQ,EAAKC,KAAK,IAAMnC,QAAQ,GAAImC,KAAM,CAAG;MAC7Cd,SAAS,EAAGA,SAAW;MACvBM,WAAW,EAAGA,WAAa;MAC3BP,OAAO,EAAGA,OAAS;MACnBgB,GAAG,EAAG9B,QAAU;MAChB6B,KAAK,EAAGlC;IAAQ,CAChB;EAAC,CAC4B,CAAC;AAElC;AAEA,eAAeZ,kBAAkB,CAAEQ,eAAgB,CAAC","ignoreList":[]}