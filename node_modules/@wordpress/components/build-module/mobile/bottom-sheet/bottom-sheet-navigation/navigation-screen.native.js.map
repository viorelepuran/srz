{"version":3,"names":["useIsFocused","useNavigation","useFocusEffect","ScrollView","TouchableHighlight","useWindowDimensions","View","useRef","useCallback","useContext","useMemo","BottomSheetNavigationContext","BottomSheetContext","styles","jsx","_jsx","jsxs","_jsxs","BottomSheetNavigationScreen","children","fullScreen","isScrollable","isNested","name","navigation","maxHeight","isFocused","onHandleHardwareButtonPress","shouldEnableBottomSheetMaxHeight","setIsFullScreen","listProps","safeAreaBottomInset","height","windowHeight","setHeight","canGoBack","goBack","current","onLayout","nativeEvent","layout","testID","accessible","style","scrollableContent","paddingBottom"],"sources":["@wordpress/components/src/mobile/bottom-sheet/bottom-sheet-navigation/navigation-screen.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport {\n\tuseIsFocused,\n\tuseNavigation,\n\tuseFocusEffect,\n} from '@react-navigation/native';\nimport {\n\tScrollView,\n\tTouchableHighlight,\n\tuseWindowDimensions,\n\tView,\n} from 'react-native';\n\n/**\n * WordPress dependencies\n */\n\nimport { useRef, useCallback, useContext, useMemo } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport { BottomSheetNavigationContext } from './bottom-sheet-navigation-context';\nimport { BottomSheetContext } from '../bottom-sheet-context';\nimport styles from './styles.scss';\n\nconst BottomSheetNavigationScreen = ( {\n\tchildren,\n\tfullScreen,\n\tisScrollable,\n\tisNested,\n\tname,\n} ) => {\n\tconst navigation = useNavigation();\n\tconst maxHeight = useRef( 0 );\n\tconst isFocused = useIsFocused();\n\tconst {\n\t\tonHandleHardwareButtonPress,\n\t\tshouldEnableBottomSheetMaxHeight,\n\t\tsetIsFullScreen,\n\t\tlistProps,\n\t\tsafeAreaBottomInset,\n\t} = useContext( BottomSheetContext );\n\tconst { height: windowHeight } = useWindowDimensions();\n\n\tconst { setHeight } = useContext( BottomSheetNavigationContext );\n\n\tuseFocusEffect(\n\t\tuseCallback( () => {\n\t\t\tonHandleHardwareButtonPress( () => {\n\t\t\t\tif ( navigation.canGoBack() ) {\n\t\t\t\t\tshouldEnableBottomSheetMaxHeight( true );\n\t\t\t\t\tnavigation.goBack();\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tonHandleHardwareButtonPress( null );\n\t\t\t\treturn false;\n\t\t\t} );\n\t\t\t/**\n\t\t\t * TODO: onHandleHardwareButtonPress stores a single value, which means\n\t\t\t * future invocations from sibling screens can replace the callback for\n\t\t\t * the currently active screen. Currently, the empty dependency array\n\t\t\t * passed to useCallback here is what prevents erroneous callback\n\t\t\t * replacements, but leveraging memoization to achieve this is brittle and\n\t\t\t * explicitly discouraged in the React documentation.\n\t\t\t * https://react.dev/reference/react/useMemo\n\t\t\t *\n\t\t\t * Ideally, we refactor onHandleHardwareButtonPress to manage multiple\n\t\t\t * callbacks triggered based upon which screen is currently active.\n\t\t\t *\n\t\t\t * Related: https://github.com/WordPress/gutenberg/pull/36328#discussion_r768897546\n\t\t\t *\n\t\t\t * Also see https://github.com/WordPress/gutenberg/pull/41166.\n\t\t\t */\n\t\t}, [] )\n\t);\n\n\tuseFocusEffect(\n\t\tuseCallback( () => {\n\t\t\tif ( fullScreen ) {\n\t\t\t\tsetHeight( windowHeight );\n\t\t\t\tsetIsFullScreen( true );\n\t\t\t} else if ( maxHeight.current !== 0 ) {\n\t\t\t\tsetIsFullScreen( false );\n\t\t\t\tsetHeight( maxHeight.current );\n\t\t\t}\n\t\t\treturn () => {};\n\t\t}, [ fullScreen, setHeight, setIsFullScreen, windowHeight ] )\n\t);\n\n\tconst onLayout = ( { nativeEvent } ) => {\n\t\tif ( fullScreen ) {\n\t\t\treturn;\n\t\t}\n\t\tconst { height } = nativeEvent.layout;\n\t\tif ( maxHeight.current !== height && isFocused ) {\n\t\t\tmaxHeight.current = height;\n\t\t\tsetHeight( height );\n\t\t}\n\t};\n\n\treturn useMemo( () => {\n\t\treturn isScrollable || isNested ? (\n\t\t\t<View\n\t\t\t\tonLayout={ onLayout }\n\t\t\t\ttestID={ `navigation-screen-${ name }` }\n\t\t\t>\n\t\t\t\t{ children }\n\t\t\t</View>\n\t\t) : (\n\t\t\t<ScrollView { ...listProps }>\n\t\t\t\t<TouchableHighlight accessible={ false }>\n\t\t\t\t\t<View\n\t\t\t\t\t\tonLayout={ onLayout }\n\t\t\t\t\t\ttestID={ `navigation-screen-${ name }` }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ children }\n\t\t\t\t\t\t{ ! isNested && (\n\t\t\t\t\t\t\t<View\n\t\t\t\t\t\t\t\tstyle={ {\n\t\t\t\t\t\t\t\t\theight:\n\t\t\t\t\t\t\t\t\t\tsafeAreaBottomInset ||\n\t\t\t\t\t\t\t\t\t\tstyles.scrollableContent.paddingBottom,\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) }\n\t\t\t\t\t</View>\n\t\t\t\t</TouchableHighlight>\n\t\t\t</ScrollView>\n\t\t);\n\t\t// See https://github.com/WordPress/gutenberg/pull/41166\n\t}, [\n\t\tchildren,\n\t\tisFocused,\n\t\tsafeAreaBottomInset,\n\t\tlistProps,\n\t\tname,\n\t\tisScrollable,\n\t\tisNested,\n\t\tonLayout,\n\t] );\n};\n\nexport default BottomSheetNavigationScreen;\n"],"mappings":"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","ignoreList":[]}