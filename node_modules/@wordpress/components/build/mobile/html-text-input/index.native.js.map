{"version":3,"names":["_reactNative","require","_element","_i18n","_blocks","_data","_hooks","_compose","_keyboardAvoidingView","_interopRequireDefault","_style","_jsxRuntime","HTMLTextInput","Component","constructor","arguments","edit","bind","stopEditing","getHTMLForParent","addFilter","state","getDerivedStateFromProps","props","isDirty","value","componentWillUnmount","removeFilter","html","onChange","setState","onPersist","render","editTitle","getStylesFromColorScheme","parentHeight","style","title","titleStyle","styles","htmlViewTitle","htmlViewTitleDark","text","color","htmlStyle","htmlView","htmlViewDark","placeholderStyle","placeholder","placeholderDark","jsx","default","keyboardAvoidingView","children","jsxs","ScrollView","scrollView","TextInput","autoCorrect","accessibilityLabel","textAlignVertical","numberOfLines","__","placeholderTextColor","onChangeText","ref","contentTextInputRef","multiline","onBlur","scrollEnabled","rejectResponderTermination","exports","_default","compose","withSelect","select","getEditedPostAttribute","getEditedPostContent","withDispatch","dispatch","editPost","resetEditorBlocks","content","blocks","parse","withInstanceId","withPreferredColorScheme"],"sources":["@wordpress/components/src/mobile/html-text-input/index.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport { ScrollView, TextInput } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport { parse } from '@wordpress/blocks';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { addFilter, removeFilter } from '@wordpress/hooks';\nimport {\n\twithInstanceId,\n\tcompose,\n\twithPreferredColorScheme,\n} from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport KeyboardAvoidingView from '../keyboard-avoiding-view';\nimport styles from './style.scss';\n\nexport class HTMLTextInput extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.edit = this.edit.bind( this );\n\t\tthis.stopEditing = this.stopEditing.bind( this );\n\t\tthis.getHTMLForParent = this.getHTMLForParent.bind( this );\n\t\taddFilter(\n\t\t\t'native.persist-html',\n\t\t\t'html-text-input',\n\t\t\tthis.getHTMLForParent\n\t\t);\n\n\t\tthis.state = {};\n\t}\n\n\tstatic getDerivedStateFromProps( props, state ) {\n\t\tif ( state.isDirty ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\tvalue: props.value,\n\t\t\tisDirty: false,\n\t\t};\n\t}\n\n\tcomponentWillUnmount() {\n\t\tremoveFilter( 'native.persist-html', 'html-text-input' );\n\t\t// TODO: Blocking main thread.\n\t\tthis.stopEditing();\n\t}\n\n\tedit( html ) {\n\t\tthis.props.onChange( html );\n\t\tthis.setState( { value: html, isDirty: true } );\n\t}\n\n\tgetHTMLForParent() {\n\t\treturn this.state.value;\n\t}\n\n\tstopEditing() {\n\t\tif ( this.state.isDirty ) {\n\t\t\tthis.props.onPersist( this.state.value );\n\t\t\tthis.setState( { isDirty: false } );\n\t\t}\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\teditTitle,\n\t\t\tgetStylesFromColorScheme,\n\t\t\tparentHeight,\n\t\t\tstyle,\n\t\t\ttitle,\n\t\t} = this.props;\n\t\tconst titleStyle = [\n\t\t\tgetStylesFromColorScheme(\n\t\t\t\tstyles.htmlViewTitle,\n\t\t\t\tstyles.htmlViewTitleDark\n\t\t\t),\n\t\t\tstyle?.text && { color: style.text },\n\t\t];\n\t\tconst htmlStyle = [\n\t\t\tgetStylesFromColorScheme( styles.htmlView, styles.htmlViewDark ),\n\t\t\tstyle?.text && { color: style.text },\n\t\t];\n\t\tconst placeholderStyle = {\n\t\t\t...getStylesFromColorScheme(\n\t\t\t\tstyles.placeholder,\n\t\t\t\tstyles.placeholderDark\n\t\t\t),\n\t\t\t...( style?.text && { color: style.text } ),\n\t\t};\n\t\treturn (\n\t\t\t<KeyboardAvoidingView\n\t\t\t\tstyle={ styles.keyboardAvoidingView }\n\t\t\t\tparentHeight={ parentHeight }\n\t\t\t>\n\t\t\t\t<ScrollView style={ styles.scrollView }>\n\t\t\t\t\t<TextInput\n\t\t\t\t\t\tautoCorrect={ false }\n\t\t\t\t\t\taccessibilityLabel=\"html-view-title\"\n\t\t\t\t\t\ttextAlignVertical=\"center\"\n\t\t\t\t\t\tnumberOfLines={ 1 }\n\t\t\t\t\t\tstyle={ titleStyle }\n\t\t\t\t\t\tvalue={ title }\n\t\t\t\t\t\tplaceholder={ __( 'Add title' ) }\n\t\t\t\t\t\tplaceholderTextColor={ placeholderStyle.color }\n\t\t\t\t\t\tonChangeText={ editTitle }\n\t\t\t\t\t/>\n\t\t\t\t\t<TextInput\n\t\t\t\t\t\tref={ this.contentTextInputRef }\n\t\t\t\t\t\tautoCorrect={ false }\n\t\t\t\t\t\taccessibilityLabel=\"html-view-content\"\n\t\t\t\t\t\ttextAlignVertical=\"top\"\n\t\t\t\t\t\tmultiline\n\t\t\t\t\t\tstyle={ htmlStyle }\n\t\t\t\t\t\tvalue={ this.state.value }\n\t\t\t\t\t\tonChangeText={ this.edit }\n\t\t\t\t\t\tonBlur={ this.stopEditing }\n\t\t\t\t\t\tplaceholder={ __( 'Start writingâ€¦' ) }\n\t\t\t\t\t\tplaceholderTextColor={ placeholderStyle.color }\n\t\t\t\t\t\tscrollEnabled={ false }\n\t\t\t\t\t\t// [Only iOS] This prop prevents the text input from\n\t\t\t\t\t\t// automatically getting focused after scrolling\n\t\t\t\t\t\t// content.\n\t\t\t\t\t\trejectResponderTermination={ false }\n\t\t\t\t\t/>\n\t\t\t\t</ScrollView>\n\t\t\t</KeyboardAvoidingView>\n\t\t);\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst { getEditedPostAttribute, getEditedPostContent } =\n\t\t\tselect( 'core/editor' );\n\n\t\treturn {\n\t\t\ttitle: getEditedPostAttribute( 'title' ),\n\t\t\tvalue: getEditedPostContent(),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { editPost, resetEditorBlocks } = dispatch( 'core/editor' );\n\t\treturn {\n\t\t\teditTitle( title ) {\n\t\t\t\teditPost( { title } );\n\t\t\t},\n\t\t\tonChange( content ) {\n\t\t\t\teditPost( { content } );\n\t\t\t},\n\t\t\tonPersist( content ) {\n\t\t\t\tconst blocks = parse( content );\n\t\t\t\tresetEditorBlocks( blocks );\n\t\t\t},\n\t\t};\n\t} ),\n\twithInstanceId,\n\twithPreferredColorScheme,\n] )( HTMLTextInput );\n"],"mappings":"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","ignoreList":[]}