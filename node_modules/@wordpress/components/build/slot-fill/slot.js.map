{"version":3,"names":["_compose","require","_element","_context","_interopRequireDefault","_jsxRuntime","isFunction","maybeFunc","addKeysToChildren","children","Children","map","child","childIndex","childKey","key","cloneElement","Slot","props","_useObservableValue","registry","useContext","SlotFillContext","instanceRef","useRef","name","fillProps","useLayoutEffect","instance","current","registerSlot","unregisterSlot","fills","useObservableValue","currentSlot","slots","renderedFills","fill","fillChildren","filter","element","isEmptyElement","jsx","Fragment","_default","exports","default"],"sources":["@wordpress/components/src/slot-fill/slot.tsx"],"sourcesContent":["/**\n * External dependencies\n */\nimport type { ReactElement, ReactNode, Key } from 'react';\n\n/**\n * WordPress dependencies\n */\nimport { useObservableValue } from '@wordpress/compose';\nimport {\n\tuseContext,\n\tuseLayoutEffect,\n\tuseRef,\n\tChildren,\n\tcloneElement,\n\tisEmptyElement,\n} from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport SlotFillContext from './context';\nimport type { SlotComponentProps } from './types';\n\n/**\n * Whether the argument is a function.\n *\n * @param maybeFunc The argument to check.\n * @return True if the argument is a function, false otherwise.\n */\nfunction isFunction( maybeFunc: any ): maybeFunc is Function {\n\treturn typeof maybeFunc === 'function';\n}\n\nfunction addKeysToChildren( children: ReactNode ) {\n\treturn Children.map( children, ( child, childIndex ) => {\n\t\tif ( ! child || typeof child === 'string' ) {\n\t\t\treturn child;\n\t\t}\n\t\tlet childKey: Key = childIndex;\n\t\tif ( typeof child === 'object' && 'key' in child && child?.key ) {\n\t\t\tchildKey = child.key;\n\t\t}\n\n\t\treturn cloneElement( child as ReactElement, {\n\t\t\tkey: childKey,\n\t\t} );\n\t} );\n}\n\nfunction Slot( props: Omit< SlotComponentProps, 'bubblesVirtually' > ) {\n\tconst registry = useContext( SlotFillContext );\n\tconst instanceRef = useRef( {} );\n\n\tconst { name, children, fillProps = {} } = props;\n\n\tuseLayoutEffect( () => {\n\t\tconst instance = instanceRef.current;\n\t\tregistry.registerSlot( name, instance );\n\t\treturn () => registry.unregisterSlot( name, instance );\n\t}, [ registry, name ] );\n\n\tlet fills = useObservableValue( registry.fills, name ) ?? [];\n\tconst currentSlot = useObservableValue( registry.slots, name );\n\n\t// Fills should only be rendered in the currently registered instance of the slot.\n\tif ( currentSlot !== instanceRef.current ) {\n\t\tfills = [];\n\t}\n\n\tconst renderedFills = fills\n\t\t.map( ( fill ) => {\n\t\t\tconst fillChildren = isFunction( fill.children )\n\t\t\t\t? fill.children( fillProps )\n\t\t\t\t: fill.children;\n\t\t\treturn addKeysToChildren( fillChildren );\n\t\t} )\n\t\t.filter(\n\t\t\t// In some cases fills are rendered only when some conditions apply.\n\t\t\t// This ensures that we only use non-empty fills when rendering, i.e.,\n\t\t\t// it allows us to render wrappers only when the fills are actually present.\n\t\t\t( element ) => ! isEmptyElement( element )\n\t\t);\n\n\treturn (\n\t\t<>\n\t\t\t{ isFunction( children )\n\t\t\t\t? children( renderedFills )\n\t\t\t\t: renderedFills }\n\t\t</>\n\t);\n}\n\nexport default Slot;\n"],"mappings":";;;;;;;AAQA,IAAAA,QAAA,GAAAC,OAAA;AACA,IAAAC,QAAA,GAAAD,OAAA;AAYA,IAAAE,QAAA,GAAAC,sBAAA,CAAAH,OAAA;AAAwC,IAAAI,WAAA,GAAAJ,OAAA;AArBxC;AACA;AACA;;AAGA;AACA;AACA;;AAWA;AACA;AACA;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA,SAASK,UAAUA,CAAEC,SAAc,EAA0B;EAC5D,OAAO,OAAOA,SAAS,KAAK,UAAU;AACvC;AAEA,SAASC,iBAAiBA,CAAEC,QAAmB,EAAG;EACjD,OAAOC,iBAAQ,CAACC,GAAG,CAAEF,QAAQ,EAAE,CAAEG,KAAK,EAAEC,UAAU,KAAM;IACvD,IAAK,CAAED,KAAK,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAG;MAC3C,OAAOA,KAAK;IACb;IACA,IAAIE,QAAa,GAAGD,UAAU;IAC9B,IAAK,OAAOD,KAAK,KAAK,QAAQ,IAAI,KAAK,IAAIA,KAAK,IAAIA,KAAK,EAAEG,GAAG,EAAG;MAChED,QAAQ,GAAGF,KAAK,CAACG,GAAG;IACrB;IAEA,OAAO,IAAAC,qBAAY,EAAEJ,KAAK,EAAkB;MAC3CG,GAAG,EAAED;IACN,CAAE,CAAC;EACJ,CAAE,CAAC;AACJ;AAEA,SAASG,IAAIA,CAAEC,KAAqD,EAAG;EAAA,IAAAC,mBAAA;EACtE,MAAMC,QAAQ,GAAG,IAAAC,mBAAU,EAAEC,gBAAgB,CAAC;EAC9C,MAAMC,WAAW,GAAG,IAAAC,eAAM,EAAE,CAAC,CAAE,CAAC;EAEhC,MAAM;IAAEC,IAAI;IAAEhB,QAAQ;IAAEiB,SAAS,GAAG,CAAC;EAAE,CAAC,GAAGR,KAAK;EAEhD,IAAAS,wBAAe,EAAE,MAAM;IACtB,MAAMC,QAAQ,GAAGL,WAAW,CAACM,OAAO;IACpCT,QAAQ,CAACU,YAAY,CAAEL,IAAI,EAAEG,QAAS,CAAC;IACvC,OAAO,MAAMR,QAAQ,CAACW,cAAc,CAAEN,IAAI,EAAEG,QAAS,CAAC;EACvD,CAAC,EAAE,CAAER,QAAQ,EAAEK,IAAI,CAAG,CAAC;EAEvB,IAAIO,KAAK,IAAAb,mBAAA,GAAG,IAAAc,2BAAkB,EAAEb,QAAQ,CAACY,KAAK,EAAEP,IAAK,CAAC,cAAAN,mBAAA,cAAAA,mBAAA,GAAI,EAAE;EAC5D,MAAMe,WAAW,GAAG,IAAAD,2BAAkB,EAAEb,QAAQ,CAACe,KAAK,EAAEV,IAAK,CAAC;;EAE9D;EACA,IAAKS,WAAW,KAAKX,WAAW,CAACM,OAAO,EAAG;IAC1CG,KAAK,GAAG,EAAE;EACX;EAEA,MAAMI,aAAa,GAAGJ,KAAK,CACzBrB,GAAG,CAAI0B,IAAI,IAAM;IACjB,MAAMC,YAAY,GAAGhC,UAAU,CAAE+B,IAAI,CAAC5B,QAAS,CAAC,GAC7C4B,IAAI,CAAC5B,QAAQ,CAAEiB,SAAU,CAAC,GAC1BW,IAAI,CAAC5B,QAAQ;IAChB,OAAOD,iBAAiB,CAAE8B,YAAa,CAAC;EACzC,CAAE,CAAC,CACFC,MAAM;EACN;EACA;EACA;EACEC,OAAO,IAAM,CAAE,IAAAC,uBAAc,EAAED,OAAQ,CAC1C,CAAC;EAEF,oBACC,IAAAnC,WAAA,CAAAqC,GAAA,EAAArC,WAAA,CAAAsC,QAAA;IAAAlC,QAAA,EACGH,UAAU,CAAEG,QAAS,CAAC,GACrBA,QAAQ,CAAE2B,aAAc,CAAC,GACzBA;EAAa,CACf,CAAC;AAEL;AAAC,IAAAQ,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEc7B,IAAI","ignoreList":[]}