{"version":3,"names":["_memize","_interopRequireDefault","require","_reactNative","_reactNativeGestureHandler","_element","_editor","_blocks","_data","_compose","_reactNativeBridge","_components","_coreData","_layout","_jsxRuntime","Editor","Component","constructor","props","arguments","initialHtmlModeEnabled","mode","switchEditorMode","getEditorSettings","memize","maxSize","setTitleRef","bind","settings","isRTL","I18nManager","componentDidMount","editEntityRecord","postType","postId","subscriptionParentSetFocusOnTitle","subscribeSetFocusOnTitle","postTitleRef","focus","focusTitleWhenAvailable","subscriptionParentFeaturedImageIdNativeUpdated","subscribeFeaturedImageIdNativeUpdated","payload","featured_media","featuredImageId","undoIgnore","componentWillUnmount","remove","titleRef","render","initialEdits","post","initialHtml","editorSettings","normalizedPost","id","title","raw","initialTitle","content","serialize","parse","type","status","meta","jsx","GestureHandlerRootView","style","flex","children","SlotFillProvider","EditorProvider","useSubRegistry","ErrorBoundary","default","_default","exports","compose","withSelect","select","getEditorMode","editorStore","withDispatch","dispatch","coreStore"],"sources":["@wordpress/edit-post/src/editor.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport memize from 'memize';\nimport { I18nManager } from 'react-native';\nimport { GestureHandlerRootView } from 'react-native-gesture-handler';\n\n/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport {\n\tEditorProvider,\n\tErrorBoundary,\n\tstore as editorStore,\n} from '@wordpress/editor';\nimport { parse, serialize } from '@wordpress/blocks';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { compose } from '@wordpress/compose';\nimport {\n\tsubscribeSetFocusOnTitle,\n\tsubscribeFeaturedImageIdNativeUpdated,\n} from '@wordpress/react-native-bridge';\nimport { SlotFillProvider } from '@wordpress/components';\nimport { store as coreStore } from '@wordpress/core-data';\n\n/**\n * Internal dependencies\n */\nimport Layout from './components/layout';\n\nclass Editor extends Component {\n\tconstructor( props ) {\n\t\tsuper( ...arguments );\n\n\t\tif ( props.initialHtmlModeEnabled && props.mode === 'visual' ) {\n\t\t\t// Enable html mode if the initial mode the parent wants it but we're not already in it.\n\t\t\tthis.props.switchEditorMode( 'text' );\n\t\t}\n\n\t\tthis.getEditorSettings = memize( this.getEditorSettings, {\n\t\t\tmaxSize: 1,\n\t\t} );\n\n\t\tthis.setTitleRef = this.setTitleRef.bind( this );\n\t}\n\n\tgetEditorSettings( settings ) {\n\t\tsettings = {\n\t\t\t...settings,\n\t\t\tisRTL: I18nManager.isRTL,\n\t\t};\n\n\t\treturn settings;\n\t}\n\n\tcomponentDidMount() {\n\t\tconst { editEntityRecord, postType, postId } = this.props;\n\n\t\tthis.subscriptionParentSetFocusOnTitle = subscribeSetFocusOnTitle(\n\t\t\t() => {\n\t\t\t\tif ( this.postTitleRef ) {\n\t\t\t\t\tthis.postTitleRef.focus();\n\t\t\t\t} else {\n\t\t\t\t\t// If the post title ref is not available, we postpone setting focus to when it's available.\n\t\t\t\t\tthis.focusTitleWhenAvailable = true;\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis.subscriptionParentFeaturedImageIdNativeUpdated =\n\t\t\tsubscribeFeaturedImageIdNativeUpdated( ( payload ) => {\n\t\t\t\teditEntityRecord(\n\t\t\t\t\t'postType',\n\t\t\t\t\tpostType,\n\t\t\t\t\tpostId,\n\t\t\t\t\t{ featured_media: payload.featuredImageId },\n\t\t\t\t\t{\n\t\t\t\t\t\tundoIgnore: true,\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t} );\n\t}\n\n\tcomponentWillUnmount() {\n\t\tif ( this.subscriptionParentSetFocusOnTitle ) {\n\t\t\tthis.subscriptionParentSetFocusOnTitle.remove();\n\t\t}\n\n\t\tif ( this.subscribeFeaturedImageIdNativeUpdated ) {\n\t\t\tthis.subscribeFeaturedImageIdNativeUpdated.remove();\n\t\t}\n\t}\n\n\tsetTitleRef( titleRef ) {\n\t\tif ( this.focusTitleWhenAvailable && ! this.postTitleRef ) {\n\t\t\tthis.focusTitleWhenAvailable = false;\n\t\t\ttitleRef.focus();\n\t\t}\n\n\t\tthis.postTitleRef = titleRef;\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tsettings,\n\t\t\tinitialEdits,\n\t\t\tpost,\n\t\t\tpostId,\n\t\t\tpostType,\n\t\t\tfeaturedImageId,\n\t\t\tinitialHtml,\n\t\t\t...props\n\t\t} = this.props;\n\n\t\tconst editorSettings = this.getEditorSettings( settings );\n\n\t\tconst normalizedPost = post || {\n\t\t\tid: postId,\n\t\t\ttitle: {\n\t\t\t\traw: props.initialTitle || '',\n\t\t\t},\n\t\t\tfeatured_media: featuredImageId,\n\t\t\tcontent: {\n\t\t\t\t// Make sure the post content is in sync with gutenberg store\n\t\t\t\t// to avoid marking the post as modified when simply loaded\n\t\t\t\t// For now, let's assume: serialize( parse( html ) ) !== html.\n\t\t\t\traw: serialize( parse( initialHtml || '' ) ),\n\t\t\t},\n\t\t\ttype: postType,\n\t\t\tstatus: 'draft',\n\t\t\tmeta: [],\n\t\t};\n\n\t\treturn (\n\t\t\t<GestureHandlerRootView style={ { flex: 1 } }>\n\t\t\t\t<SlotFillProvider>\n\t\t\t\t\t<EditorProvider\n\t\t\t\t\t\tsettings={ editorSettings }\n\t\t\t\t\t\tpost={ normalizedPost }\n\t\t\t\t\t\tinitialEdits={ initialEdits }\n\t\t\t\t\t\tuseSubRegistry={ false }\n\t\t\t\t\t\t{ ...props }\n\t\t\t\t\t>\n\t\t\t\t\t\t<ErrorBoundary>\n\t\t\t\t\t\t\t<Layout setTitleRef={ this.setTitleRef } />\n\t\t\t\t\t\t</ErrorBoundary>\n\t\t\t\t\t</EditorProvider>\n\t\t\t\t</SlotFillProvider>\n\t\t\t</GestureHandlerRootView>\n\t\t);\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst { getEditorMode } = select( editorStore );\n\n\t\treturn {\n\t\t\tmode: getEditorMode(),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { switchEditorMode } = dispatch( editorStore );\n\t\tconst { editEntityRecord } = dispatch( coreStore );\n\t\treturn {\n\t\t\tswitchEditorMode,\n\t\t\teditEntityRecord,\n\t\t};\n\t} ),\n] )( Editor );\n"],"mappings":"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","ignoreList":[]}