{"version":3,"names":["_reactNative","require","_reactNativeSafeArea","_interopRequireDefault","_element","_data","_blockEditor","_compose","_components","_editor","_reactNativeBridge","_style","_style2","_header","_visualEditor","_jsxRuntime","Layout","Component","constructor","arguments","onSafeAreaInsetsUpdate","bind","onRootViewLayout","state","rootViewHeight","safeAreaInsets","top","bottom","right","left","SafeArea","getSafeAreaInsetsForRootView","then","componentDidMount","_isMounted","safeAreaSubscription","addEventListener","componentWillUnmount","remove","result","setState","event","setHeightState","height","nativeEvent","layout","sendNativeEditorDidLayout","renderHTML","globalStyles","props","jsx","HTMLTextInput","parentHeight","style","renderVisual","isReady","default","setTitleRef","render","getStylesFromColorScheme","mode","isHtmlView","marginBottom","Platform","OS","headerToolbarStyles","containerStyles","styles","container","containerDark","toolbarKeyboardAvoidingViewStyle","toolbarKeyboardAvoidingView","backgroundColor","editorStyles","background","backgroundDark","Tooltip","Slot","children","jsxs","SafeAreaView","onLayout","AutosaveMonitor","disableIntervalChecks","OfflineStatus","View","FloatingToolbar","NoticeList","flex","flexBasis","KeyboardAvoidingView","withAnimatedHeight","Fragment","__unstableAutocompletionItemsSlot","BottomSheetSettings","_default","exports","compose","withSelect","select","__unstableIsEditorReady","isEditorReady","getEditorMode","editorStore","getSettings","blockEditorStore","__experimentalGlobalStylesBaseStyles","color","withPreferredColorScheme"],"sources":["@wordpress/edit-post/src/components/layout/index.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport { Platform, SafeAreaView, View } from 'react-native';\nimport SafeArea from 'react-native-safe-area';\n\n/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { withSelect } from '@wordpress/data';\nimport {\n\tBottomSheetSettings,\n\tFloatingToolbar,\n\tstore as blockEditorStore,\n} from '@wordpress/block-editor';\nimport { compose, withPreferredColorScheme } from '@wordpress/compose';\nimport {\n\tHTMLTextInput,\n\tKeyboardAvoidingView,\n\tNoticeList,\n\tTooltip,\n\t__unstableAutocompletionItemsSlot as AutocompletionItemsSlot,\n} from '@wordpress/components';\nimport {\n\tAutosaveMonitor,\n\tOfflineStatus,\n\tstore as editorStore,\n} from '@wordpress/editor';\nimport { sendNativeEditorDidLayout } from '@wordpress/react-native-bridge';\n\n/**\n * Internal dependencies\n */\nimport styles from './style.scss';\nimport headerToolbarStyles from '../header/header-toolbar/style.scss';\nimport Header from '../header';\nimport VisualEditor from '../visual-editor';\n\nclass Layout extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.onSafeAreaInsetsUpdate = this.onSafeAreaInsetsUpdate.bind( this );\n\t\tthis.onRootViewLayout = this.onRootViewLayout.bind( this );\n\n\t\tthis.state = {\n\t\t\trootViewHeight: 0,\n\t\t\tsafeAreaInsets: { top: 0, bottom: 0, right: 0, left: 0 },\n\t\t};\n\n\t\tSafeArea.getSafeAreaInsetsForRootView().then(\n\t\t\tthis.onSafeAreaInsetsUpdate\n\t\t);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis._isMounted = true;\n\t\tthis.safeAreaSubscription = SafeArea.addEventListener(\n\t\t\t'safeAreaInsetsForRootViewDidChange',\n\t\t\tthis.onSafeAreaInsetsUpdate\n\t\t);\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.safeAreaSubscription?.remove();\n\t\tthis._isMounted = false;\n\t}\n\n\tonSafeAreaInsetsUpdate( result ) {\n\t\tconst { safeAreaInsets } = result;\n\t\tif ( this._isMounted ) {\n\t\t\tthis.setState( { safeAreaInsets } );\n\t\t}\n\t}\n\n\tonRootViewLayout( event ) {\n\t\tif ( this._isMounted ) {\n\t\t\tthis.setHeightState( event );\n\t\t}\n\t}\n\n\tsetHeightState( event ) {\n\t\tconst { height } = event.nativeEvent.layout;\n\t\tif ( height !== this.state.rootViewHeight ) {\n\t\t\tthis.setState(\n\t\t\t\t{ rootViewHeight: height },\n\t\t\t\tsendNativeEditorDidLayout\n\t\t\t);\n\t\t}\n\t}\n\n\trenderHTML() {\n\t\tconst { globalStyles } = this.props;\n\t\treturn (\n\t\t\t<HTMLTextInput\n\t\t\t\tparentHeight={ this.state.rootViewHeight }\n\t\t\t\tstyle={ globalStyles }\n\t\t\t/>\n\t\t);\n\t}\n\n\trenderVisual() {\n\t\tconst { isReady } = this.props;\n\n\t\tif ( ! isReady ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn <VisualEditor setTitleRef={ this.props.setTitleRef } />;\n\t}\n\n\trender() {\n\t\tconst { getStylesFromColorScheme, mode, globalStyles } = this.props;\n\n\t\tconst isHtmlView = mode === 'text';\n\n\t\t// Add a margin view at the bottom for the header.\n\t\tconst marginBottom =\n\t\t\tPlatform.OS === 'android' && ! isHtmlView\n\t\t\t\t? headerToolbarStyles[ 'header-toolbar__container' ].height\n\t\t\t\t: 0;\n\n\t\tconst containerStyles = getStylesFromColorScheme(\n\t\t\tstyles.container,\n\t\t\tstyles.containerDark\n\t\t);\n\n\t\tconst toolbarKeyboardAvoidingViewStyle = {\n\t\t\t...styles.toolbarKeyboardAvoidingView,\n\t\t\tleft: this.state.safeAreaInsets.left,\n\t\t\tright: this.state.safeAreaInsets.right,\n\t\t\tbottom: this.state.safeAreaInsets.bottom,\n\t\t\tbackgroundColor: containerStyles.backgroundColor,\n\t\t};\n\n\t\tconst editorStyles = [\n\t\t\tgetStylesFromColorScheme(\n\t\t\t\tstyles.background,\n\t\t\t\tstyles.backgroundDark\n\t\t\t),\n\t\t\tglobalStyles?.background && {\n\t\t\t\tbackgroundColor: globalStyles.background,\n\t\t\t},\n\t\t];\n\n\t\treturn (\n\t\t\t<Tooltip.Slot>\n\t\t\t\t<SafeAreaView\n\t\t\t\t\tstyle={ containerStyles }\n\t\t\t\t\tonLayout={ this.onRootViewLayout }\n\t\t\t\t>\n\t\t\t\t\t<AutosaveMonitor disableIntervalChecks />\n\t\t\t\t\t<OfflineStatus />\n\t\t\t\t\t<View style={ editorStyles }>\n\t\t\t\t\t\t{ isHtmlView ? this.renderHTML() : this.renderVisual() }\n\t\t\t\t\t\t{ ! isHtmlView && Platform.OS === 'android' && (\n\t\t\t\t\t\t\t<FloatingToolbar />\n\t\t\t\t\t\t) }\n\t\t\t\t\t\t<NoticeList />\n\t\t\t\t\t</View>\n\t\t\t\t\t<View\n\t\t\t\t\t\tstyle={ {\n\t\t\t\t\t\t\tflex: 0,\n\t\t\t\t\t\t\tflexBasis: marginBottom,\n\t\t\t\t\t\t\theight: marginBottom,\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t\t{ ! isHtmlView && (\n\t\t\t\t\t\t<KeyboardAvoidingView\n\t\t\t\t\t\t\tparentHeight={ this.state.rootViewHeight }\n\t\t\t\t\t\t\tstyle={ toolbarKeyboardAvoidingViewStyle }\n\t\t\t\t\t\t\twithAnimatedHeight\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ Platform.OS === 'ios' && (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<AutocompletionItemsSlot />\n\t\t\t\t\t\t\t\t\t<FloatingToolbar />\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t<Header />\n\t\t\t\t\t\t\t<BottomSheetSettings />\n\t\t\t\t\t\t</KeyboardAvoidingView>\n\t\t\t\t\t) }\n\t\t\t\t\t{ Platform.OS === 'android' && <AutocompletionItemsSlot /> }\n\t\t\t\t</SafeAreaView>\n\t\t\t</Tooltip.Slot>\n\t\t);\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst { __unstableIsEditorReady: isEditorReady, getEditorMode } =\n\t\t\tselect( editorStore );\n\t\tconst { getSettings } = select( blockEditorStore );\n\t\tconst globalStyles =\n\t\t\tgetSettings()?.__experimentalGlobalStylesBaseStyles?.color;\n\n\t\treturn {\n\t\t\tisReady: isEditorReady(),\n\t\t\tmode: getEditorMode(),\n\t\t\tglobalStyles,\n\t\t};\n\t} ),\n\twithPreferredColorScheme,\n] )( Layout );\n"],"mappings":"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","ignoreList":[]}