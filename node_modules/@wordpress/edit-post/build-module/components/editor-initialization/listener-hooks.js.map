{"version":3,"names":["useSelect","useEffect","useRef","store","editorStore","VIEW_AS_LINK_SELECTOR","VIEW_AS_PREVIEW_LINK_SELECTOR","useUpdatePostLinkListener","newPermalink","select","getCurrentPost","link","nodeToUpdateRef","current","document","querySelector","setAttribute"],"sources":["@wordpress/edit-post/src/components/editor-initialization/listener-hooks.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useSelect } from '@wordpress/data';\nimport { useEffect, useRef } from '@wordpress/element';\nimport { store as editorStore } from '@wordpress/editor';\n\n/**\n * Internal dependencies\n */\nimport {\n\tVIEW_AS_LINK_SELECTOR,\n\tVIEW_AS_PREVIEW_LINK_SELECTOR,\n} from '../../store/constants';\n\n/**\n * This listener hook monitors any change in permalink and updates the view\n * post link in the admin bar.\n */\nexport const useUpdatePostLinkListener = () => {\n\tconst { newPermalink } = useSelect(\n\t\t( select ) => ( {\n\t\t\tnewPermalink: select( editorStore ).getCurrentPost().link,\n\t\t} ),\n\t\t[]\n\t);\n\tconst nodeToUpdateRef = useRef();\n\n\tuseEffect( () => {\n\t\tnodeToUpdateRef.current =\n\t\t\tdocument.querySelector( VIEW_AS_PREVIEW_LINK_SELECTOR ) ||\n\t\t\tdocument.querySelector( VIEW_AS_LINK_SELECTOR );\n\t}, [] );\n\n\tuseEffect( () => {\n\t\tif ( ! newPermalink || ! nodeToUpdateRef.current ) {\n\t\t\treturn;\n\t\t}\n\t\tnodeToUpdateRef.current.setAttribute( 'href', newPermalink );\n\t}, [ newPermalink ] );\n};\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAS,QAAQ,iBAAiB;AAC3C,SAASC,SAAS,EAAEC,MAAM,QAAQ,oBAAoB;AACtD,SAASC,KAAK,IAAIC,WAAW,QAAQ,mBAAmB;;AAExD;AACA;AACA;AACA,SACCC,qBAAqB,EACrBC,6BAA6B,QACvB,uBAAuB;;AAE9B;AACA;AACA;AACA;AACA,OAAO,MAAMC,yBAAyB,GAAGA,CAAA,KAAM;EAC9C,MAAM;IAAEC;EAAa,CAAC,GAAGR,SAAS,CAC/BS,MAAM,KAAQ;IACfD,YAAY,EAAEC,MAAM,CAAEL,WAAY,CAAC,CAACM,cAAc,CAAC,CAAC,CAACC;EACtD,CAAC,CAAE,EACH,EACD,CAAC;EACD,MAAMC,eAAe,GAAGV,MAAM,CAAC,CAAC;EAEhCD,SAAS,CAAE,MAAM;IAChBW,eAAe,CAACC,OAAO,GACtBC,QAAQ,CAACC,aAAa,CAAET,6BAA8B,CAAC,IACvDQ,QAAQ,CAACC,aAAa,CAAEV,qBAAsB,CAAC;EACjD,CAAC,EAAE,EAAG,CAAC;EAEPJ,SAAS,CAAE,MAAM;IAChB,IAAK,CAAEO,YAAY,IAAI,CAAEI,eAAe,CAACC,OAAO,EAAG;MAClD;IACD;IACAD,eAAe,CAACC,OAAO,CAACG,YAAY,CAAE,MAAM,EAAER,YAAa,CAAC;EAC7D,CAAC,EAAE,CAAEA,YAAY,CAAG,CAAC;AACtB,CAAC","ignoreList":[]}