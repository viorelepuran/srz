{"version":3,"names":["Platform","SafeAreaView","View","SafeArea","Component","withSelect","BottomSheetSettings","FloatingToolbar","store","blockEditorStore","compose","withPreferredColorScheme","HTMLTextInput","KeyboardAvoidingView","NoticeList","Tooltip","__unstableAutocompletionItemsSlot","AutocompletionItemsSlot","AutosaveMonitor","OfflineStatus","editorStore","sendNativeEditorDidLayout","styles","headerToolbarStyles","Header","VisualEditor","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Layout","constructor","arguments","onSafeAreaInsetsUpdate","bind","onRootViewLayout","state","rootViewHeight","safeAreaInsets","top","bottom","right","left","getSafeAreaInsetsForRootView","then","componentDidMount","_isMounted","safeAreaSubscription","addEventListener","componentWillUnmount","remove","result","setState","event","setHeightState","height","nativeEvent","layout","renderHTML","globalStyles","props","parentHeight","style","renderVisual","isReady","setTitleRef","render","getStylesFromColorScheme","mode","isHtmlView","marginBottom","OS","containerStyles","container","containerDark","toolbarKeyboardAvoidingViewStyle","toolbarKeyboardAvoidingView","backgroundColor","editorStyles","background","backgroundDark","Slot","children","onLayout","disableIntervalChecks","flex","flexBasis","withAnimatedHeight","select","__unstableIsEditorReady","isEditorReady","getEditorMode","getSettings","__experimentalGlobalStylesBaseStyles","color"],"sources":["@wordpress/edit-post/src/components/layout/index.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport { Platform, SafeAreaView, View } from 'react-native';\nimport SafeArea from 'react-native-safe-area';\n\n/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { withSelect } from '@wordpress/data';\nimport {\n\tBottomSheetSettings,\n\tFloatingToolbar,\n\tstore as blockEditorStore,\n} from '@wordpress/block-editor';\nimport { compose, withPreferredColorScheme } from '@wordpress/compose';\nimport {\n\tHTMLTextInput,\n\tKeyboardAvoidingView,\n\tNoticeList,\n\tTooltip,\n\t__unstableAutocompletionItemsSlot as AutocompletionItemsSlot,\n} from '@wordpress/components';\nimport {\n\tAutosaveMonitor,\n\tOfflineStatus,\n\tstore as editorStore,\n} from '@wordpress/editor';\nimport { sendNativeEditorDidLayout } from '@wordpress/react-native-bridge';\n\n/**\n * Internal dependencies\n */\nimport styles from './style.scss';\nimport headerToolbarStyles from '../header/header-toolbar/style.scss';\nimport Header from '../header';\nimport VisualEditor from '../visual-editor';\n\nclass Layout extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.onSafeAreaInsetsUpdate = this.onSafeAreaInsetsUpdate.bind( this );\n\t\tthis.onRootViewLayout = this.onRootViewLayout.bind( this );\n\n\t\tthis.state = {\n\t\t\trootViewHeight: 0,\n\t\t\tsafeAreaInsets: { top: 0, bottom: 0, right: 0, left: 0 },\n\t\t};\n\n\t\tSafeArea.getSafeAreaInsetsForRootView().then(\n\t\t\tthis.onSafeAreaInsetsUpdate\n\t\t);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis._isMounted = true;\n\t\tthis.safeAreaSubscription = SafeArea.addEventListener(\n\t\t\t'safeAreaInsetsForRootViewDidChange',\n\t\t\tthis.onSafeAreaInsetsUpdate\n\t\t);\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.safeAreaSubscription?.remove();\n\t\tthis._isMounted = false;\n\t}\n\n\tonSafeAreaInsetsUpdate( result ) {\n\t\tconst { safeAreaInsets } = result;\n\t\tif ( this._isMounted ) {\n\t\t\tthis.setState( { safeAreaInsets } );\n\t\t}\n\t}\n\n\tonRootViewLayout( event ) {\n\t\tif ( this._isMounted ) {\n\t\t\tthis.setHeightState( event );\n\t\t}\n\t}\n\n\tsetHeightState( event ) {\n\t\tconst { height } = event.nativeEvent.layout;\n\t\tif ( height !== this.state.rootViewHeight ) {\n\t\t\tthis.setState(\n\t\t\t\t{ rootViewHeight: height },\n\t\t\t\tsendNativeEditorDidLayout\n\t\t\t);\n\t\t}\n\t}\n\n\trenderHTML() {\n\t\tconst { globalStyles } = this.props;\n\t\treturn (\n\t\t\t<HTMLTextInput\n\t\t\t\tparentHeight={ this.state.rootViewHeight }\n\t\t\t\tstyle={ globalStyles }\n\t\t\t/>\n\t\t);\n\t}\n\n\trenderVisual() {\n\t\tconst { isReady } = this.props;\n\n\t\tif ( ! isReady ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn <VisualEditor setTitleRef={ this.props.setTitleRef } />;\n\t}\n\n\trender() {\n\t\tconst { getStylesFromColorScheme, mode, globalStyles } = this.props;\n\n\t\tconst isHtmlView = mode === 'text';\n\n\t\t// Add a margin view at the bottom for the header.\n\t\tconst marginBottom =\n\t\t\tPlatform.OS === 'android' && ! isHtmlView\n\t\t\t\t? headerToolbarStyles[ 'header-toolbar__container' ].height\n\t\t\t\t: 0;\n\n\t\tconst containerStyles = getStylesFromColorScheme(\n\t\t\tstyles.container,\n\t\t\tstyles.containerDark\n\t\t);\n\n\t\tconst toolbarKeyboardAvoidingViewStyle = {\n\t\t\t...styles.toolbarKeyboardAvoidingView,\n\t\t\tleft: this.state.safeAreaInsets.left,\n\t\t\tright: this.state.safeAreaInsets.right,\n\t\t\tbottom: this.state.safeAreaInsets.bottom,\n\t\t\tbackgroundColor: containerStyles.backgroundColor,\n\t\t};\n\n\t\tconst editorStyles = [\n\t\t\tgetStylesFromColorScheme(\n\t\t\t\tstyles.background,\n\t\t\t\tstyles.backgroundDark\n\t\t\t),\n\t\t\tglobalStyles?.background && {\n\t\t\t\tbackgroundColor: globalStyles.background,\n\t\t\t},\n\t\t];\n\n\t\treturn (\n\t\t\t<Tooltip.Slot>\n\t\t\t\t<SafeAreaView\n\t\t\t\t\tstyle={ containerStyles }\n\t\t\t\t\tonLayout={ this.onRootViewLayout }\n\t\t\t\t>\n\t\t\t\t\t<AutosaveMonitor disableIntervalChecks />\n\t\t\t\t\t<OfflineStatus />\n\t\t\t\t\t<View style={ editorStyles }>\n\t\t\t\t\t\t{ isHtmlView ? this.renderHTML() : this.renderVisual() }\n\t\t\t\t\t\t{ ! isHtmlView && Platform.OS === 'android' && (\n\t\t\t\t\t\t\t<FloatingToolbar />\n\t\t\t\t\t\t) }\n\t\t\t\t\t\t<NoticeList />\n\t\t\t\t\t</View>\n\t\t\t\t\t<View\n\t\t\t\t\t\tstyle={ {\n\t\t\t\t\t\t\tflex: 0,\n\t\t\t\t\t\t\tflexBasis: marginBottom,\n\t\t\t\t\t\t\theight: marginBottom,\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t\t{ ! isHtmlView && (\n\t\t\t\t\t\t<KeyboardAvoidingView\n\t\t\t\t\t\t\tparentHeight={ this.state.rootViewHeight }\n\t\t\t\t\t\t\tstyle={ toolbarKeyboardAvoidingViewStyle }\n\t\t\t\t\t\t\twithAnimatedHeight\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ Platform.OS === 'ios' && (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<AutocompletionItemsSlot />\n\t\t\t\t\t\t\t\t\t<FloatingToolbar />\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t<Header />\n\t\t\t\t\t\t\t<BottomSheetSettings />\n\t\t\t\t\t\t</KeyboardAvoidingView>\n\t\t\t\t\t) }\n\t\t\t\t\t{ Platform.OS === 'android' && <AutocompletionItemsSlot /> }\n\t\t\t\t</SafeAreaView>\n\t\t\t</Tooltip.Slot>\n\t\t);\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst { __unstableIsEditorReady: isEditorReady, getEditorMode } =\n\t\t\tselect( editorStore );\n\t\tconst { getSettings } = select( blockEditorStore );\n\t\tconst globalStyles =\n\t\t\tgetSettings()?.__experimentalGlobalStylesBaseStyles?.color;\n\n\t\treturn {\n\t\t\tisReady: isEditorReady(),\n\t\t\tmode: getEditorMode(),\n\t\t\tglobalStyles,\n\t\t};\n\t} ),\n\twithPreferredColorScheme,\n] )( Layout );\n"],"mappings":"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","ignoreList":[]}