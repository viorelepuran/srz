{"version":3,"names":["useRegistry","useRefEffect","store","blockEditorStore","isUnmodifiedDefaultBlock","CSS","usePaddingAppender","enabled","registry","effect","node","onMouseDown","event","target","parentElement","lastChild","lastElementChild","lastChildRect","getBoundingClientRect","clientY","bottom","preventDefault","blockOrder","select","getBlockOrder","lastBlockClientId","length","lastBlock","getBlock","selectBlock","insertDefaultBlock","dispatch","ownerDocument","addEventListener","removeEventListener"],"sources":["@wordpress/edit-post/src/components/layout/use-padding-appender.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useRegistry } from '@wordpress/data';\nimport { useRefEffect } from '@wordpress/compose';\nimport { store as blockEditorStore } from '@wordpress/block-editor';\nimport { isUnmodifiedDefaultBlock } from '@wordpress/blocks';\n\n// Ruleset to add space for the typewriter effect. When typing in the last\n// block, there needs to be room to scroll up.\nconst CSS =\n\t':root :where(.editor-styles-wrapper)::after {content: \"\"; display: block; height: 40vh;}';\n\nexport function usePaddingAppender( enabled ) {\n\tconst registry = useRegistry();\n\tconst effect = useRefEffect(\n\t\t( node ) => {\n\t\t\tfunction onMouseDown( event ) {\n\t\t\t\tif (\n\t\t\t\t\tevent.target !== node &&\n\t\t\t\t\t// Tests for the parent element because in the iframed editor if the click is\n\t\t\t\t\t// below the padding the target will be the parent element (html) and should\n\t\t\t\t\t// still be treated as intent to append.\n\t\t\t\t\tevent.target !== node.parentElement\n\t\t\t\t) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Only handle clicks under the last child.\n\t\t\t\tconst lastChild = node.lastElementChild;\n\t\t\t\tif ( ! lastChild ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst lastChildRect = lastChild.getBoundingClientRect();\n\t\t\t\tif ( event.clientY < lastChildRect.bottom ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tevent.preventDefault();\n\n\t\t\t\tconst blockOrder = registry\n\t\t\t\t\t.select( blockEditorStore )\n\t\t\t\t\t.getBlockOrder( '' );\n\t\t\t\tconst lastBlockClientId = blockOrder[ blockOrder.length - 1 ];\n\n\t\t\t\tconst lastBlock = registry\n\t\t\t\t\t.select( blockEditorStore )\n\t\t\t\t\t.getBlock( lastBlockClientId );\n\t\t\t\tconst { selectBlock, insertDefaultBlock } =\n\t\t\t\t\tregistry.dispatch( blockEditorStore );\n\n\t\t\t\tif ( lastBlock && isUnmodifiedDefaultBlock( lastBlock ) ) {\n\t\t\t\t\tselectBlock( lastBlockClientId );\n\t\t\t\t} else {\n\t\t\t\t\tinsertDefaultBlock();\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst { ownerDocument } = node;\n\t\t\t// Adds the listener on the document so that in the iframed editor clicks below the\n\t\t\t// padding can be handled as they too should be treated as intent to append.\n\t\t\townerDocument.addEventListener( 'mousedown', onMouseDown );\n\t\t\treturn () => {\n\t\t\t\townerDocument.removeEventListener( 'mousedown', onMouseDown );\n\t\t\t};\n\t\t},\n\t\t[ registry ]\n\t);\n\treturn enabled ? [ effect, CSS ] : [];\n}\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,WAAW,QAAQ,iBAAiB;AAC7C,SAASC,YAAY,QAAQ,oBAAoB;AACjD,SAASC,KAAK,IAAIC,gBAAgB,QAAQ,yBAAyB;AACnE,SAASC,wBAAwB,QAAQ,mBAAmB;;AAE5D;AACA;AACA,MAAMC,GAAG,GACR,0FAA0F;AAE3F,OAAO,SAASC,kBAAkBA,CAAEC,OAAO,EAAG;EAC7C,MAAMC,QAAQ,GAAGR,WAAW,CAAC,CAAC;EAC9B,MAAMS,MAAM,GAAGR,YAAY,CACxBS,IAAI,IAAM;IACX,SAASC,WAAWA,CAAEC,KAAK,EAAG;MAC7B,IACCA,KAAK,CAACC,MAAM,KAAKH,IAAI;MACrB;MACA;MACA;MACAE,KAAK,CAACC,MAAM,KAAKH,IAAI,CAACI,aAAa,EAClC;QACD;MACD;;MAEA;MACA,MAAMC,SAAS,GAAGL,IAAI,CAACM,gBAAgB;MACvC,IAAK,CAAED,SAAS,EAAG;QAClB;MACD;MAEA,MAAME,aAAa,GAAGF,SAAS,CAACG,qBAAqB,CAAC,CAAC;MACvD,IAAKN,KAAK,CAACO,OAAO,GAAGF,aAAa,CAACG,MAAM,EAAG;QAC3C;MACD;MAEAR,KAAK,CAACS,cAAc,CAAC,CAAC;MAEtB,MAAMC,UAAU,GAAGd,QAAQ,CACzBe,MAAM,CAAEpB,gBAAiB,CAAC,CAC1BqB,aAAa,CAAE,EAAG,CAAC;MACrB,MAAMC,iBAAiB,GAAGH,UAAU,CAAEA,UAAU,CAACI,MAAM,GAAG,CAAC,CAAE;MAE7D,MAAMC,SAAS,GAAGnB,QAAQ,CACxBe,MAAM,CAAEpB,gBAAiB,CAAC,CAC1ByB,QAAQ,CAAEH,iBAAkB,CAAC;MAC/B,MAAM;QAAEI,WAAW;QAAEC;MAAmB,CAAC,GACxCtB,QAAQ,CAACuB,QAAQ,CAAE5B,gBAAiB,CAAC;MAEtC,IAAKwB,SAAS,IAAIvB,wBAAwB,CAAEuB,SAAU,CAAC,EAAG;QACzDE,WAAW,CAAEJ,iBAAkB,CAAC;MACjC,CAAC,MAAM;QACNK,kBAAkB,CAAC,CAAC;MACrB;IACD;IACA,MAAM;MAAEE;IAAc,CAAC,GAAGtB,IAAI;IAC9B;IACA;IACAsB,aAAa,CAACC,gBAAgB,CAAE,WAAW,EAAEtB,WAAY,CAAC;IAC1D,OAAO,MAAM;MACZqB,aAAa,CAACE,mBAAmB,CAAE,WAAW,EAAEvB,WAAY,CAAC;IAC9D,CAAC;EACF,CAAC,EACD,CAAEH,QAAQ,CACX,CAAC;EACD,OAAOD,OAAO,GAAG,CAAEE,MAAM,EAAEJ,GAAG,CAAE,GAAG,EAAE;AACtC","ignoreList":[]}