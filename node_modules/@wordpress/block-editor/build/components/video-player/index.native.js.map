{"version":3,"names":["_element","require","_components","_i18n","_reactNative","_reactNativeVideo","_interopRequireDefault","_styles","_gridiconPlay","_jsxRuntime","VIDEO_ASPECT_RATIO","exports","Video","Component","constructor","arguments","isIOS","Platform","OS","state","isFullScreen","videoContainerHeight","onPressPlay","bind","onVideoLayout","event","height","nativeEvent","layout","setState","player","presentFullscreenPlayer","source","props","uri","openURL","url","Linking","canOpenURL","then","supported","Alert","alert","__","window","console","warn","catch","err","error","render","isSelected","style","showPlayButton","jsxs","View","styles","videoContainer","children","jsx","default","ref","controls","ignoreSilentSwitch","paused","onLayout","onFullscreenPlayerWillPresent","onFullscreenPlayerDidDismiss","TouchableOpacity","disabled","onPress","overlayContainer","blackOverlay","Icon","icon","PlayIcon","playIcon","size","_default"],"sources":["@wordpress/block-editor/src/components/video-player/index.native.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { Icon } from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\n\n/**\n * External dependencies\n */\nimport { View, TouchableOpacity, Platform, Linking, Alert } from 'react-native';\nimport { default as VideoPlayer } from 'react-native-video';\n\n/**\n * Internal dependencies\n */\nimport styles from './styles.scss';\nimport PlayIcon from './gridicon-play';\n\n// Default Video ratio 16:9\nexport const VIDEO_ASPECT_RATIO = 16 / 9;\n\nclass Video extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.isIOS = Platform.OS === 'ios';\n\t\tthis.state = {\n\t\t\tisFullScreen: false,\n\t\t\tvideoContainerHeight: 0,\n\t\t};\n\t\tthis.onPressPlay = this.onPressPlay.bind( this );\n\t\tthis.onVideoLayout = this.onVideoLayout.bind( this );\n\t}\n\n\tonVideoLayout( event ) {\n\t\tconst { height } = event.nativeEvent.layout;\n\t\tif ( height !== this.state.videoContainerHeight ) {\n\t\t\tthis.setState( { videoContainerHeight: height } );\n\t\t}\n\t}\n\n\tonPressPlay() {\n\t\tif ( this.isIOS ) {\n\t\t\tif ( this.player ) {\n\t\t\t\tthis.player.presentFullscreenPlayer();\n\t\t\t}\n\t\t} else {\n\t\t\tconst { source } = this.props;\n\t\t\tif ( source && source.uri ) {\n\t\t\t\tthis.openURL( source.uri );\n\t\t\t}\n\t\t}\n\t}\n\n\t// Tries opening the URL outside of the app\n\topenURL( url ) {\n\t\tLinking.canOpenURL( url )\n\t\t\t.then( ( supported ) => {\n\t\t\t\tif ( ! supported ) {\n\t\t\t\t\tAlert.alert(\n\t\t\t\t\t\t__( 'Problem opening the video' ),\n\t\t\t\t\t\t__(\n\t\t\t\t\t\t\t'No application can handle this request. Please install a Web browser.'\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t\twindow.console.warn(\n\t\t\t\t\t\t'No application found that can open the video with URL: ' +\n\t\t\t\t\t\t\turl\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\treturn Linking.openURL( url );\n\t\t\t\t}\n\t\t\t} )\n\t\t\t.catch( ( err ) => {\n\t\t\t\tAlert.alert(\n\t\t\t\t\t__( 'Problem opening the video' ),\n\t\t\t\t\t__( 'An unknown error occurred. Please try again.' )\n\t\t\t\t);\n\t\t\t\twindow.console.error(\n\t\t\t\t\t'An error occurred while opening the video URL: ' + url,\n\t\t\t\t\terr\n\t\t\t\t);\n\t\t\t} );\n\t}\n\n\trender() {\n\t\tconst { isSelected, style } = this.props;\n\t\tconst { isFullScreen, videoContainerHeight } = this.state;\n\t\tconst showPlayButton = videoContainerHeight > 0;\n\n\t\treturn (\n\t\t\t<View style={ styles.videoContainer }>\n\t\t\t\t<VideoPlayer\n\t\t\t\t\t{ ...this.props }\n\t\t\t\t\tref={ ( ref ) => {\n\t\t\t\t\t\tthis.player = ref;\n\t\t\t\t\t} }\n\t\t\t\t\t// Using built-in player controls is messing up the layout on iOS.\n\t\t\t\t\t// So we are setting controls=false and adding a play button that\n\t\t\t\t\t// will trigger presentFullscreenPlayer()\n\t\t\t\t\tcontrols={ false }\n\t\t\t\t\tignoreSilentSwitch=\"ignore\"\n\t\t\t\t\tpaused={ ! isFullScreen }\n\t\t\t\t\tonLayout={ this.onVideoLayout }\n\t\t\t\t\tonFullscreenPlayerWillPresent={ () => {\n\t\t\t\t\t\tthis.setState( { isFullScreen: true } );\n\t\t\t\t\t} }\n\t\t\t\t\tonFullscreenPlayerDidDismiss={ () => {\n\t\t\t\t\t\tthis.setState( { isFullScreen: false } );\n\t\t\t\t\t} }\n\t\t\t\t/>\n\t\t\t\t{ showPlayButton && (\n\t\t\t\t\t// If we add the play icon as a subview to VideoPlayer then react-native-video decides to show control buttons\n\t\t\t\t\t// even if we set controls={ false }, so we are adding our play button as a sibling overlay view.\n\t\t\t\t\t<TouchableOpacity\n\t\t\t\t\t\tdisabled={ ! isSelected }\n\t\t\t\t\t\tonPress={ this.onPressPlay }\n\t\t\t\t\t\tstyle={ [ style, styles.overlayContainer ] }\n\t\t\t\t\t>\n\t\t\t\t\t\t<View style={ styles.blackOverlay } />\n\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\ticon={ PlayIcon }\n\t\t\t\t\t\t\tstyle={ styles.playIcon }\n\t\t\t\t\t\t\tsize={ styles.playIcon.size }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</TouchableOpacity>\n\t\t\t\t) }\n\t\t\t</View>\n\t\t);\n\t}\n}\n\nexport default Video;\n"],"mappings":"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","ignoreList":[]}