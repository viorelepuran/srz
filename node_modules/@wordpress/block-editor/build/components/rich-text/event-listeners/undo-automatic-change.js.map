{"version":3,"names":["_keycodes","require","_store","_default","props","element","onKeyDown","event","keyCode","defaultPrevented","BACKSPACE","ESCAPE","registry","current","didAutomaticChange","getSettings","select","blockEditorStore","__experimentalUndo","preventDefault","addEventListener","removeEventListener","exports","default"],"sources":["@wordpress/block-editor/src/components/rich-text/event-listeners/undo-automatic-change.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { BACKSPACE, ESCAPE } from '@wordpress/keycodes';\n\n/**\n * Internal dependencies\n */\nimport { store as blockEditorStore } from '../../../store';\n\nexport default ( props ) => ( element ) => {\n\tfunction onKeyDown( event ) {\n\t\tconst { keyCode } = event;\n\n\t\tif ( event.defaultPrevented ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( keyCode !== BACKSPACE && keyCode !== ESCAPE ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { registry } = props.current;\n\t\tconst { didAutomaticChange, getSettings } =\n\t\t\tregistry.select( blockEditorStore );\n\n\t\tconst { __experimentalUndo } = getSettings();\n\n\t\tif ( ! __experimentalUndo ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( ! didAutomaticChange() ) {\n\t\t\treturn;\n\t\t}\n\n\t\tevent.preventDefault();\n\t\t__experimentalUndo();\n\t}\n\n\telement.addEventListener( 'keydown', onKeyDown );\n\treturn () => {\n\t\telement.removeEventListener( 'keydown', onKeyDown );\n\t};\n};\n"],"mappings":";;;;;;AAGA,IAAAA,SAAA,GAAAC,OAAA;AAKA,IAAAC,MAAA,GAAAD,OAAA;AARA;AACA;AACA;AAGA;AACA;AACA;AAFA,IAAAE,QAAA,GAKiBC,KAAK,IAAQC,OAAO,IAAM;EAC1C,SAASC,SAASA,CAAEC,KAAK,EAAG;IAC3B,MAAM;MAAEC;IAAQ,CAAC,GAAGD,KAAK;IAEzB,IAAKA,KAAK,CAACE,gBAAgB,EAAG;MAC7B;IACD;IAEA,IAAKD,OAAO,KAAKE,mBAAS,IAAIF,OAAO,KAAKG,gBAAM,EAAG;MAClD;IACD;IAEA,MAAM;MAAEC;IAAS,CAAC,GAAGR,KAAK,CAACS,OAAO;IAClC,MAAM;MAAEC,kBAAkB;MAAEC;IAAY,CAAC,GACxCH,QAAQ,CAACI,MAAM,CAAEC,YAAiB,CAAC;IAEpC,MAAM;MAAEC;IAAmB,CAAC,GAAGH,WAAW,CAAC,CAAC;IAE5C,IAAK,CAAEG,kBAAkB,EAAG;MAC3B;IACD;IAEA,IAAK,CAAEJ,kBAAkB,CAAC,CAAC,EAAG;MAC7B;IACD;IAEAP,KAAK,CAACY,cAAc,CAAC,CAAC;IACtBD,kBAAkB,CAAC,CAAC;EACrB;EAEAb,OAAO,CAACe,gBAAgB,CAAE,SAAS,EAAEd,SAAU,CAAC;EAChD,OAAO,MAAM;IACZD,OAAO,CAACgB,mBAAmB,CAAE,SAAS,EAAEf,SAAU,CAAC;EACpD,CAAC;AACF,CAAC;AAAAgB,OAAA,CAAAC,OAAA,GAAApB,QAAA","ignoreList":[]}