{"version":3,"names":["_keycodes","require","_richText","_default","props","element","onKeyDownDeprecated","event","keyCode","ENTER","onReplace","onSplit","current","__deprecatedOnSplit","onKeyDown","defaultPrevented","target","value","onChange","disableLineBreaks","onSplitAtEnd","onSplitAtDoubleLineEnd","registry","preventDefault","text","start","end","shiftKey","insert","length","slice","batch","_value","remove","defaultView","ownerDocument","addEventListener","removeEventListener","exports","default"],"sources":["@wordpress/block-editor/src/components/rich-text/event-listeners/enter.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { ENTER } from '@wordpress/keycodes';\nimport { insert, remove } from '@wordpress/rich-text';\n\nexport default ( props ) => ( element ) => {\n\tfunction onKeyDownDeprecated( event ) {\n\t\tif ( event.keyCode !== ENTER ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { onReplace, onSplit } = props.current;\n\n\t\tif ( onReplace && onSplit ) {\n\t\t\tevent.__deprecatedOnSplit = true;\n\t\t}\n\t}\n\n\tfunction onKeyDown( event ) {\n\t\tif ( event.defaultPrevented ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// The event listener is attached to the window, so we need to check if\n\t\t// the target is the element.\n\t\tif ( event.target !== element ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( event.keyCode !== ENTER ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst {\n\t\t\tvalue,\n\t\t\tonChange,\n\t\t\tdisableLineBreaks,\n\t\t\tonSplitAtEnd,\n\t\t\tonSplitAtDoubleLineEnd,\n\t\t\tregistry,\n\t\t} = props.current;\n\n\t\tevent.preventDefault();\n\n\t\tconst { text, start, end } = value;\n\n\t\tif ( event.shiftKey ) {\n\t\t\tif ( ! disableLineBreaks ) {\n\t\t\t\tonChange( insert( value, '\\n' ) );\n\t\t\t}\n\t\t} else if ( onSplitAtEnd && start === end && end === text.length ) {\n\t\t\tonSplitAtEnd();\n\t\t} else if (\n\t\t\t// For some blocks it's desirable to split at the end of the\n\t\t\t// block when there are two line breaks at the end of the\n\t\t\t// block, so triple Enter exits the block.\n\t\t\tonSplitAtDoubleLineEnd &&\n\t\t\tstart === end &&\n\t\t\tend === text.length &&\n\t\t\ttext.slice( -2 ) === '\\n\\n'\n\t\t) {\n\t\t\tregistry.batch( () => {\n\t\t\t\tconst _value = { ...value };\n\t\t\t\t_value.start = _value.end - 2;\n\t\t\t\tonChange( remove( _value ) );\n\t\t\t\tonSplitAtDoubleLineEnd();\n\t\t\t} );\n\t\t} else if ( ! disableLineBreaks ) {\n\t\t\tonChange( insert( value, '\\n' ) );\n\t\t}\n\t}\n\n\tconst { defaultView } = element.ownerDocument;\n\n\t// Attach the listener to the window so parent elements have the chance to\n\t// prevent the default behavior.\n\tdefaultView.addEventListener( 'keydown', onKeyDown );\n\telement.addEventListener( 'keydown', onKeyDownDeprecated );\n\treturn () => {\n\t\tdefaultView.removeEventListener( 'keydown', onKeyDown );\n\t\telement.removeEventListener( 'keydown', onKeyDownDeprecated );\n\t};\n};\n"],"mappings":";;;;;;AAGA,IAAAA,SAAA,GAAAC,OAAA;AACA,IAAAC,SAAA,GAAAD,OAAA;AAJA;AACA;AACA;AAFA,IAAAE,QAAA,GAMiBC,KAAK,IAAQC,OAAO,IAAM;EAC1C,SAASC,mBAAmBA,CAAEC,KAAK,EAAG;IACrC,IAAKA,KAAK,CAACC,OAAO,KAAKC,eAAK,EAAG;MAC9B;IACD;IAEA,MAAM;MAAEC,SAAS;MAAEC;IAAQ,CAAC,GAAGP,KAAK,CAACQ,OAAO;IAE5C,IAAKF,SAAS,IAAIC,OAAO,EAAG;MAC3BJ,KAAK,CAACM,mBAAmB,GAAG,IAAI;IACjC;EACD;EAEA,SAASC,SAASA,CAAEP,KAAK,EAAG;IAC3B,IAAKA,KAAK,CAACQ,gBAAgB,EAAG;MAC7B;IACD;;IAEA;IACA;IACA,IAAKR,KAAK,CAACS,MAAM,KAAKX,OAAO,EAAG;MAC/B;IACD;IAEA,IAAKE,KAAK,CAACC,OAAO,KAAKC,eAAK,EAAG;MAC9B;IACD;IAEA,MAAM;MACLQ,KAAK;MACLC,QAAQ;MACRC,iBAAiB;MACjBC,YAAY;MACZC,sBAAsB;MACtBC;IACD,CAAC,GAAGlB,KAAK,CAACQ,OAAO;IAEjBL,KAAK,CAACgB,cAAc,CAAC,CAAC;IAEtB,MAAM;MAAEC,IAAI;MAAEC,KAAK;MAAEC;IAAI,CAAC,GAAGT,KAAK;IAElC,IAAKV,KAAK,CAACoB,QAAQ,EAAG;MACrB,IAAK,CAAER,iBAAiB,EAAG;QAC1BD,QAAQ,CAAE,IAAAU,gBAAM,EAAEX,KAAK,EAAE,IAAK,CAAE,CAAC;MAClC;IACD,CAAC,MAAM,IAAKG,YAAY,IAAIK,KAAK,KAAKC,GAAG,IAAIA,GAAG,KAAKF,IAAI,CAACK,MAAM,EAAG;MAClET,YAAY,CAAC,CAAC;IACf,CAAC,MAAM;IACN;IACA;IACA;IACAC,sBAAsB,IACtBI,KAAK,KAAKC,GAAG,IACbA,GAAG,KAAKF,IAAI,CAACK,MAAM,IACnBL,IAAI,CAACM,KAAK,CAAE,CAAC,CAAE,CAAC,KAAK,MAAM,EAC1B;MACDR,QAAQ,CAACS,KAAK,CAAE,MAAM;QACrB,MAAMC,MAAM,GAAG;UAAE,GAAGf;QAAM,CAAC;QAC3Be,MAAM,CAACP,KAAK,GAAGO,MAAM,CAACN,GAAG,GAAG,CAAC;QAC7BR,QAAQ,CAAE,IAAAe,gBAAM,EAAED,MAAO,CAAE,CAAC;QAC5BX,sBAAsB,CAAC,CAAC;MACzB,CAAE,CAAC;IACJ,CAAC,MAAM,IAAK,CAAEF,iBAAiB,EAAG;MACjCD,QAAQ,CAAE,IAAAU,gBAAM,EAAEX,KAAK,EAAE,IAAK,CAAE,CAAC;IAClC;EACD;EAEA,MAAM;IAAEiB;EAAY,CAAC,GAAG7B,OAAO,CAAC8B,aAAa;;EAE7C;EACA;EACAD,WAAW,CAACE,gBAAgB,CAAE,SAAS,EAAEtB,SAAU,CAAC;EACpDT,OAAO,CAAC+B,gBAAgB,CAAE,SAAS,EAAE9B,mBAAoB,CAAC;EAC1D,OAAO,MAAM;IACZ4B,WAAW,CAACG,mBAAmB,CAAE,SAAS,EAAEvB,SAAU,CAAC;IACvDT,OAAO,CAACgC,mBAAmB,CAAE,SAAS,EAAE/B,mBAAoB,CAAC;EAC9D,CAAC;AACF,CAAC;AAAAgC,OAAA,CAAAC,OAAA,GAAApC,QAAA","ignoreList":[]}