{"version":3,"names":["_element","require","_deprecated","_interopRequireDefault","_data","_keycodes","_richText","_","_store","_blockEdit","_utils","_jsxRuntime","RichTextMultiline","children","identifier","tagName","TagName","value","onChange","multiline","props","forwardedRef","deprecated","since","version","alternative","link","clientId","useBlockEditContext","getSelectionStart","getSelectionEnd","useSelect","blockEditorStore","selectionChange","useDispatch","multilineTagName","getMultilineTag","padded","values","split","shift","pop","_onChange","newValues","join","jsx","ref","map","_value","index","RichTextWrapper","newValue","slice","isSelected","undefined","onKeyDown","event","keyCode","ENTER","preventDefault","offset","start","end","richTextValue","create","html","array","v","toHTMLString","splice","onMerge","forward","length","_default","exports","default","forwardRef"],"sources":["@wordpress/block-editor/src/components/rich-text/multiline.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { forwardRef } from '@wordpress/element';\nimport deprecated from '@wordpress/deprecated';\nimport { useDispatch, useSelect } from '@wordpress/data';\nimport { ENTER } from '@wordpress/keycodes';\nimport { create, split, toHTMLString } from '@wordpress/rich-text';\n\n/**\n * Internal dependencies\n */\nimport { RichTextWrapper } from './';\nimport { store as blockEditorStore } from '../../store';\nimport { useBlockEditContext } from '../block-edit';\nimport { getMultilineTag } from './utils';\n\nfunction RichTextMultiline(\n\t{\n\t\tchildren,\n\t\tidentifier,\n\t\ttagName: TagName = 'div',\n\t\tvalue = '',\n\t\tonChange,\n\t\tmultiline,\n\t\t...props\n\t},\n\tforwardedRef\n) {\n\tdeprecated( 'wp.blockEditor.RichText multiline prop', {\n\t\tsince: '6.1',\n\t\tversion: '6.3',\n\t\talternative: 'nested blocks (InnerBlocks)',\n\t\tlink: 'https://developer.wordpress.org/block-editor/how-to-guides/block-tutorial/nested-blocks-inner-blocks/',\n\t} );\n\n\tconst { clientId } = useBlockEditContext();\n\tconst { getSelectionStart, getSelectionEnd } =\n\t\tuseSelect( blockEditorStore );\n\tconst { selectionChange } = useDispatch( blockEditorStore );\n\n\tconst multilineTagName = getMultilineTag( multiline );\n\tvalue = value || `<${ multilineTagName }></${ multilineTagName }>`;\n\tconst padded = `</${ multilineTagName }>${ value }<${ multilineTagName }>`;\n\tconst values = padded.split(\n\t\t`</${ multilineTagName }><${ multilineTagName }>`\n\t);\n\n\tvalues.shift();\n\tvalues.pop();\n\n\tfunction _onChange( newValues ) {\n\t\tonChange(\n\t\t\t`<${ multilineTagName }>${ newValues.join(\n\t\t\t\t`</${ multilineTagName }><${ multilineTagName }>`\n\t\t\t) }</${ multilineTagName }>`\n\t\t);\n\t}\n\n\treturn (\n\t\t<TagName ref={ forwardedRef }>\n\t\t\t{ values.map( ( _value, index ) => {\n\t\t\t\treturn (\n\t\t\t\t\t<RichTextWrapper\n\t\t\t\t\t\tkey={ index }\n\t\t\t\t\t\tidentifier={ `${ identifier }-${ index }` }\n\t\t\t\t\t\ttagName={ multilineTagName }\n\t\t\t\t\t\tvalue={ _value }\n\t\t\t\t\t\tonChange={ ( newValue ) => {\n\t\t\t\t\t\t\tconst newValues = values.slice();\n\t\t\t\t\t\t\tnewValues[ index ] = newValue;\n\t\t\t\t\t\t\t_onChange( newValues );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tisSelected={ undefined }\n\t\t\t\t\t\tonKeyDown={ ( event ) => {\n\t\t\t\t\t\t\tif ( event.keyCode !== ENTER ) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\t\t\tconst { offset: start } = getSelectionStart();\n\t\t\t\t\t\t\tconst { offset: end } = getSelectionEnd();\n\n\t\t\t\t\t\t\t// Cannot split if there is no selection.\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\ttypeof start !== 'number' ||\n\t\t\t\t\t\t\t\ttypeof end !== 'number'\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst richTextValue = create( { html: _value } );\n\t\t\t\t\t\t\trichTextValue.start = start;\n\t\t\t\t\t\t\trichTextValue.end = end;\n\n\t\t\t\t\t\t\tconst array = split( richTextValue ).map( ( v ) =>\n\t\t\t\t\t\t\t\ttoHTMLString( { value: v } )\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tconst newValues = values.slice();\n\t\t\t\t\t\t\tnewValues.splice( index, 1, ...array );\n\t\t\t\t\t\t\t_onChange( newValues );\n\t\t\t\t\t\t\tselectionChange(\n\t\t\t\t\t\t\t\tclientId,\n\t\t\t\t\t\t\t\t`${ identifier }-${ index + 1 }`,\n\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\t0\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tonMerge={ ( forward ) => {\n\t\t\t\t\t\t\tconst newValues = values.slice();\n\t\t\t\t\t\t\tlet offset = 0;\n\t\t\t\t\t\t\tif ( forward ) {\n\t\t\t\t\t\t\t\tif ( ! newValues[ index + 1 ] ) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tnewValues.splice(\n\t\t\t\t\t\t\t\t\tindex,\n\t\t\t\t\t\t\t\t\t2,\n\t\t\t\t\t\t\t\t\tnewValues[ index ] + newValues[ index + 1 ]\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\toffset = newValues[ index ].length - 1;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif ( ! newValues[ index - 1 ] ) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tnewValues.splice(\n\t\t\t\t\t\t\t\t\tindex - 1,\n\t\t\t\t\t\t\t\t\t2,\n\t\t\t\t\t\t\t\t\tnewValues[ index - 1 ] + newValues[ index ]\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\toffset = newValues[ index - 1 ].length - 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t_onChange( newValues );\n\t\t\t\t\t\t\tselectionChange(\n\t\t\t\t\t\t\t\tclientId,\n\t\t\t\t\t\t\t\t`${ identifier }-${\n\t\t\t\t\t\t\t\t\tindex - ( forward ? 0 : 1 )\n\t\t\t\t\t\t\t\t}`,\n\t\t\t\t\t\t\t\toffset,\n\t\t\t\t\t\t\t\toffset\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} }\n\t\t\t\t\t\t{ ...props }\n\t\t\t\t\t/>\n\t\t\t\t);\n\t\t\t} ) }\n\t\t</TagName>\n\t);\n}\n\nexport default forwardRef( RichTextMultiline );\n"],"mappings":"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","ignoreList":[]}