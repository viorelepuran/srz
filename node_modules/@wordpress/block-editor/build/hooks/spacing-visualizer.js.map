{"version":3,"names":["_element","require","_isShallowEqual","_interopRequireDefault","_cover","_useBlockRefs","_jsxRuntime","SpacingVisualizer","clientId","value","computeStyle","forceShow","blockElement","useBlockElement","style","updateStyle","useReducer","useEffect","observer","window","MutationObserver","observe","attributes","attributeFilter","disconnect","previousValueRef","useRef","isActive","setIsActive","useState","isShallowEqual","current","timeout","setTimeout","clearTimeout","jsx","default","__unstablePopoverSlot","children","className","getComputedCSS","element","property","ownerDocument","defaultView","getComputedStyle","getPropertyValue","MarginVisualizer","spacing","margin","top","right","bottom","left","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","PaddingVisualizer","padding"],"sources":["@wordpress/block-editor/src/hooks/spacing-visualizer.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useState, useRef, useEffect, useReducer } from '@wordpress/element';\nimport isShallowEqual from '@wordpress/is-shallow-equal';\n\n/**\n * Internal dependencies\n */\nimport BlockPopoverCover from '../components/block-popover/cover';\nimport { useBlockElement } from '../components/block-list/use-block-props/use-block-refs';\n\nfunction SpacingVisualizer( { clientId, value, computeStyle, forceShow } ) {\n\tconst blockElement = useBlockElement( clientId );\n\tconst [ style, updateStyle ] = useReducer( () =>\n\t\tcomputeStyle( blockElement )\n\t);\n\n\t// It's not sufficient to read the block’s computed style when `value` changes because\n\t// the effect would run before the block’s style has updated. Thus observing mutations\n\t// to the block’s attributes is used to trigger updates to the visualizer’s styles.\n\tuseEffect( () => {\n\t\tif ( ! blockElement ) {\n\t\t\treturn;\n\t\t}\n\t\tconst observer = new window.MutationObserver( updateStyle );\n\t\tobserver.observe( blockElement, {\n\t\t\tattributes: true,\n\t\t\tattributeFilter: [ 'style', 'class' ],\n\t\t} );\n\t\treturn () => {\n\t\t\tobserver.disconnect();\n\t\t};\n\t}, [ blockElement ] );\n\n\tconst previousValueRef = useRef( value );\n\tconst [ isActive, setIsActive ] = useState( false );\n\n\tuseEffect( () => {\n\t\tif ( isShallowEqual( value, previousValueRef.current ) || forceShow ) {\n\t\t\treturn;\n\t\t}\n\n\t\tsetIsActive( true );\n\t\tpreviousValueRef.current = value;\n\n\t\tconst timeout = setTimeout( () => {\n\t\t\tsetIsActive( false );\n\t\t}, 400 );\n\n\t\treturn () => {\n\t\t\tsetIsActive( false );\n\t\t\tclearTimeout( timeout );\n\t\t};\n\t}, [ value, forceShow ] );\n\n\tif ( ! isActive && ! forceShow ) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<BlockPopoverCover\n\t\t\tclientId={ clientId }\n\t\t\t__unstablePopoverSlot=\"block-toolbar\"\n\t\t>\n\t\t\t<div className=\"block-editor__spacing-visualizer\" style={ style } />\n\t\t</BlockPopoverCover>\n\t);\n}\n\nfunction getComputedCSS( element, property ) {\n\treturn element.ownerDocument.defaultView\n\t\t.getComputedStyle( element )\n\t\t.getPropertyValue( property );\n}\n\nexport function MarginVisualizer( { clientId, value, forceShow } ) {\n\treturn (\n\t\t<SpacingVisualizer\n\t\t\tclientId={ clientId }\n\t\t\tvalue={ value?.spacing?.margin }\n\t\t\tcomputeStyle={ ( blockElement ) => {\n\t\t\t\tconst top = getComputedCSS( blockElement, 'margin-top' );\n\t\t\t\tconst right = getComputedCSS( blockElement, 'margin-right' );\n\t\t\t\tconst bottom = getComputedCSS( blockElement, 'margin-bottom' );\n\t\t\t\tconst left = getComputedCSS( blockElement, 'margin-left' );\n\t\t\t\treturn {\n\t\t\t\t\tborderTopWidth: top,\n\t\t\t\t\tborderRightWidth: right,\n\t\t\t\t\tborderBottomWidth: bottom,\n\t\t\t\t\tborderLeftWidth: left,\n\t\t\t\t\ttop: top ? `-${ top }` : 0,\n\t\t\t\t\tright: right ? `-${ right }` : 0,\n\t\t\t\t\tbottom: bottom ? `-${ bottom }` : 0,\n\t\t\t\t\tleft: left ? `-${ left }` : 0,\n\t\t\t\t};\n\t\t\t} }\n\t\t\tforceShow={ forceShow }\n\t\t/>\n\t);\n}\n\nexport function PaddingVisualizer( { clientId, value, forceShow } ) {\n\treturn (\n\t\t<SpacingVisualizer\n\t\t\tclientId={ clientId }\n\t\t\tvalue={ value?.spacing?.padding }\n\t\t\tcomputeStyle={ ( blockElement ) => ( {\n\t\t\t\tborderTopWidth: getComputedCSS( blockElement, 'padding-top' ),\n\t\t\t\tborderRightWidth: getComputedCSS(\n\t\t\t\t\tblockElement,\n\t\t\t\t\t'padding-right'\n\t\t\t\t),\n\t\t\t\tborderBottomWidth: getComputedCSS(\n\t\t\t\t\tblockElement,\n\t\t\t\t\t'padding-bottom'\n\t\t\t\t),\n\t\t\t\tborderLeftWidth: getComputedCSS( blockElement, 'padding-left' ),\n\t\t\t} ) }\n\t\t\tforceShow={ forceShow }\n\t\t/>\n\t);\n}\n"],"mappings":"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","ignoreList":[]}