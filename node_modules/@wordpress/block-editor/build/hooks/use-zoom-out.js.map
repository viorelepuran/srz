{"version":3,"names":["_data","require","_element","_store","_lockUnlock","useZoomOut","enabled","setZoomLevel","resetZoomLevel","unlock","useDispatch","blockEditorStore","isZoomedOut","isZoomOut","useSelect","select","_isZoomOut","controlZoomLevelRef","useRef","isEnabledRef","useEffect","current"],"sources":["@wordpress/block-editor/src/hooks/use-zoom-out.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { useEffect, useRef } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport { store as blockEditorStore } from '../store';\nimport { unlock } from '../lock-unlock';\n\n/**\n * A hook used to set the editor mode to zoomed out mode, invoking the hook sets the mode.\n * Concepts:\n * - If we most recently changed the zoom level for them (in or out), we always resetZoomLevel() level when unmounting.\n * - If the user most recently changed the zoom level (manually toggling), we do nothing when unmounting.\n *\n * @param {boolean} enabled If we should enter into zoomOut mode or not\n */\nexport function useZoomOut( enabled = true ) {\n\tconst { setZoomLevel, resetZoomLevel } = unlock(\n\t\tuseDispatch( blockEditorStore )\n\t);\n\n\t/**\n\t * We need access to both the value and the function. The value is to trigger a useEffect hook\n\t * and the function is to check zoom out within another hook without triggering a re-render.\n\t */\n\tconst { isZoomedOut, isZoomOut } = useSelect( ( select ) => {\n\t\tconst { isZoomOut: _isZoomOut } = unlock( select( blockEditorStore ) );\n\t\treturn {\n\t\t\tisZoomedOut: _isZoomOut(),\n\t\t\tisZoomOut: _isZoomOut,\n\t\t};\n\t}, [] );\n\n\tconst controlZoomLevelRef = useRef( false );\n\tconst isEnabledRef = useRef( enabled );\n\n\t/**\n\t * This hook tracks if the zoom state was changed manually by the user via clicking\n\t * the zoom out button. We only want this to run when isZoomedOut changes, so we use\n\t * a ref to track the enabled state.\n\t */\n\tuseEffect( () => {\n\t\t// If the zoom state changed (isZoomOut) and it does not match the requested zoom\n\t\t// state (zoomOut), then it means the user manually changed the zoom state while\n\t\t// this hook was mounted, and we should no longer control the zoom state.\n\t\tif ( isZoomedOut !== isEnabledRef.current ) {\n\t\t\tcontrolZoomLevelRef.current = false;\n\t\t}\n\t}, [ isZoomedOut ] );\n\n\tuseEffect( () => {\n\t\tisEnabledRef.current = enabled;\n\n\t\tif ( enabled !== isZoomOut() ) {\n\t\t\tcontrolZoomLevelRef.current = true;\n\n\t\t\tif ( enabled ) {\n\t\t\t\tsetZoomLevel( 'auto-scaled' );\n\t\t\t} else {\n\t\t\t\tresetZoomLevel();\n\t\t\t}\n\t\t}\n\n\t\treturn () => {\n\t\t\t// If we are controlling zoom level and are zoomed out, reset the zoom level.\n\t\t\tif ( controlZoomLevelRef.current && isZoomOut() ) {\n\t\t\t\tresetZoomLevel();\n\t\t\t}\n\t\t};\n\t}, [ enabled, isZoomOut, resetZoomLevel, setZoomLevel ] );\n}\n"],"mappings":";;;;;;AAGA,IAAAA,KAAA,GAAAC,OAAA;AACA,IAAAC,QAAA,GAAAD,OAAA;AAKA,IAAAE,MAAA,GAAAF,OAAA;AACA,IAAAG,WAAA,GAAAH,OAAA;AAVA;AACA;AACA;;AAIA;AACA;AACA;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAASI,UAAUA,CAAEC,OAAO,GAAG,IAAI,EAAG;EAC5C,MAAM;IAAEC,YAAY;IAAEC;EAAe,CAAC,GAAG,IAAAC,kBAAM,EAC9C,IAAAC,iBAAW,EAAEC,YAAiB,CAC/B,CAAC;;EAED;AACD;AACA;AACA;EACC,MAAM;IAAEC,WAAW;IAAEC;EAAU,CAAC,GAAG,IAAAC,eAAS,EAAIC,MAAM,IAAM;IAC3D,MAAM;MAAEF,SAAS,EAAEG;IAAW,CAAC,GAAG,IAAAP,kBAAM,EAAEM,MAAM,CAAEJ,YAAiB,CAAE,CAAC;IACtE,OAAO;MACNC,WAAW,EAAEI,UAAU,CAAC,CAAC;MACzBH,SAAS,EAAEG;IACZ,CAAC;EACF,CAAC,EAAE,EAAG,CAAC;EAEP,MAAMC,mBAAmB,GAAG,IAAAC,eAAM,EAAE,KAAM,CAAC;EAC3C,MAAMC,YAAY,GAAG,IAAAD,eAAM,EAAEZ,OAAQ,CAAC;;EAEtC;AACD;AACA;AACA;AACA;EACC,IAAAc,kBAAS,EAAE,MAAM;IAChB;IACA;IACA;IACA,IAAKR,WAAW,KAAKO,YAAY,CAACE,OAAO,EAAG;MAC3CJ,mBAAmB,CAACI,OAAO,GAAG,KAAK;IACpC;EACD,CAAC,EAAE,CAAET,WAAW,CAAG,CAAC;EAEpB,IAAAQ,kBAAS,EAAE,MAAM;IAChBD,YAAY,CAACE,OAAO,GAAGf,OAAO;IAE9B,IAAKA,OAAO,KAAKO,SAAS,CAAC,CAAC,EAAG;MAC9BI,mBAAmB,CAACI,OAAO,GAAG,IAAI;MAElC,IAAKf,OAAO,EAAG;QACdC,YAAY,CAAE,aAAc,CAAC;MAC9B,CAAC,MAAM;QACNC,cAAc,CAAC,CAAC;MACjB;IACD;IAEA,OAAO,MAAM;MACZ;MACA,IAAKS,mBAAmB,CAACI,OAAO,IAAIR,SAAS,CAAC,CAAC,EAAG;QACjDL,cAAc,CAAC,CAAC;MACjB;IACD,CAAC;EACF,CAAC,EAAE,CAAEF,OAAO,EAAEO,SAAS,EAAEL,cAAc,EAAED,YAAY,CAAG,CAAC;AAC1D","ignoreList":[]}