{"version":3,"names":["useSelect","useDispatch","useEffect","useRef","store","blockEditorStore","unlock","useZoomOut","enabled","setZoomLevel","resetZoomLevel","isZoomedOut","isZoomOut","select","_isZoomOut","controlZoomLevelRef","isEnabledRef","current"],"sources":["@wordpress/block-editor/src/hooks/use-zoom-out.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { useEffect, useRef } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport { store as blockEditorStore } from '../store';\nimport { unlock } from '../lock-unlock';\n\n/**\n * A hook used to set the editor mode to zoomed out mode, invoking the hook sets the mode.\n * Concepts:\n * - If we most recently changed the zoom level for them (in or out), we always resetZoomLevel() level when unmounting.\n * - If the user most recently changed the zoom level (manually toggling), we do nothing when unmounting.\n *\n * @param {boolean} enabled If we should enter into zoomOut mode or not\n */\nexport function useZoomOut( enabled = true ) {\n\tconst { setZoomLevel, resetZoomLevel } = unlock(\n\t\tuseDispatch( blockEditorStore )\n\t);\n\n\t/**\n\t * We need access to both the value and the function. The value is to trigger a useEffect hook\n\t * and the function is to check zoom out within another hook without triggering a re-render.\n\t */\n\tconst { isZoomedOut, isZoomOut } = useSelect( ( select ) => {\n\t\tconst { isZoomOut: _isZoomOut } = unlock( select( blockEditorStore ) );\n\t\treturn {\n\t\t\tisZoomedOut: _isZoomOut(),\n\t\t\tisZoomOut: _isZoomOut,\n\t\t};\n\t}, [] );\n\n\tconst controlZoomLevelRef = useRef( false );\n\tconst isEnabledRef = useRef( enabled );\n\n\t/**\n\t * This hook tracks if the zoom state was changed manually by the user via clicking\n\t * the zoom out button. We only want this to run when isZoomedOut changes, so we use\n\t * a ref to track the enabled state.\n\t */\n\tuseEffect( () => {\n\t\t// If the zoom state changed (isZoomOut) and it does not match the requested zoom\n\t\t// state (zoomOut), then it means the user manually changed the zoom state while\n\t\t// this hook was mounted, and we should no longer control the zoom state.\n\t\tif ( isZoomedOut !== isEnabledRef.current ) {\n\t\t\tcontrolZoomLevelRef.current = false;\n\t\t}\n\t}, [ isZoomedOut ] );\n\n\tuseEffect( () => {\n\t\tisEnabledRef.current = enabled;\n\n\t\tif ( enabled !== isZoomOut() ) {\n\t\t\tcontrolZoomLevelRef.current = true;\n\n\t\t\tif ( enabled ) {\n\t\t\t\tsetZoomLevel( 'auto-scaled' );\n\t\t\t} else {\n\t\t\t\tresetZoomLevel();\n\t\t\t}\n\t\t}\n\n\t\treturn () => {\n\t\t\t// If we are controlling zoom level and are zoomed out, reset the zoom level.\n\t\t\tif ( controlZoomLevelRef.current && isZoomOut() ) {\n\t\t\t\tresetZoomLevel();\n\t\t\t}\n\t\t};\n\t}, [ enabled, isZoomOut, resetZoomLevel, setZoomLevel ] );\n}\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAS,EAAEC,WAAW,QAAQ,iBAAiB;AACxD,SAASC,SAAS,EAAEC,MAAM,QAAQ,oBAAoB;;AAEtD;AACA;AACA;AACA,SAASC,KAAK,IAAIC,gBAAgB,QAAQ,UAAU;AACpD,SAASC,MAAM,QAAQ,gBAAgB;;AAEvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,UAAUA,CAAEC,OAAO,GAAG,IAAI,EAAG;EAC5C,MAAM;IAAEC,YAAY;IAAEC;EAAe,CAAC,GAAGJ,MAAM,CAC9CL,WAAW,CAAEI,gBAAiB,CAC/B,CAAC;;EAED;AACD;AACA;AACA;EACC,MAAM;IAAEM,WAAW;IAAEC;EAAU,CAAC,GAAGZ,SAAS,CAAIa,MAAM,IAAM;IAC3D,MAAM;MAAED,SAAS,EAAEE;IAAW,CAAC,GAAGR,MAAM,CAAEO,MAAM,CAAER,gBAAiB,CAAE,CAAC;IACtE,OAAO;MACNM,WAAW,EAAEG,UAAU,CAAC,CAAC;MACzBF,SAAS,EAAEE;IACZ,CAAC;EACF,CAAC,EAAE,EAAG,CAAC;EAEP,MAAMC,mBAAmB,GAAGZ,MAAM,CAAE,KAAM,CAAC;EAC3C,MAAMa,YAAY,GAAGb,MAAM,CAAEK,OAAQ,CAAC;;EAEtC;AACD;AACA;AACA;AACA;EACCN,SAAS,CAAE,MAAM;IAChB;IACA;IACA;IACA,IAAKS,WAAW,KAAKK,YAAY,CAACC,OAAO,EAAG;MAC3CF,mBAAmB,CAACE,OAAO,GAAG,KAAK;IACpC;EACD,CAAC,EAAE,CAAEN,WAAW,CAAG,CAAC;EAEpBT,SAAS,CAAE,MAAM;IAChBc,YAAY,CAACC,OAAO,GAAGT,OAAO;IAE9B,IAAKA,OAAO,KAAKI,SAAS,CAAC,CAAC,EAAG;MAC9BG,mBAAmB,CAACE,OAAO,GAAG,IAAI;MAElC,IAAKT,OAAO,EAAG;QACdC,YAAY,CAAE,aAAc,CAAC;MAC9B,CAAC,MAAM;QACNC,cAAc,CAAC,CAAC;MACjB;IACD;IAEA,OAAO,MAAM;MACZ;MACA,IAAKK,mBAAmB,CAACE,OAAO,IAAIL,SAAS,CAAC,CAAC,EAAG;QACjDF,cAAc,CAAC,CAAC;MACjB;IACD,CAAC;EACF,CAAC,EAAE,CAAEF,OAAO,EAAEI,SAAS,EAAEF,cAAc,EAAED,YAAY,CAAG,CAAC;AAC1D","ignoreList":[]}