{"version":3,"names":["BACKSPACE","ESCAPE","store","blockEditorStore","props","element","onKeyDown","event","keyCode","defaultPrevented","registry","current","didAutomaticChange","getSettings","select","__experimentalUndo","preventDefault","addEventListener","removeEventListener"],"sources":["@wordpress/block-editor/src/components/rich-text/event-listeners/undo-automatic-change.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { BACKSPACE, ESCAPE } from '@wordpress/keycodes';\n\n/**\n * Internal dependencies\n */\nimport { store as blockEditorStore } from '../../../store';\n\nexport default ( props ) => ( element ) => {\n\tfunction onKeyDown( event ) {\n\t\tconst { keyCode } = event;\n\n\t\tif ( event.defaultPrevented ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( keyCode !== BACKSPACE && keyCode !== ESCAPE ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { registry } = props.current;\n\t\tconst { didAutomaticChange, getSettings } =\n\t\t\tregistry.select( blockEditorStore );\n\n\t\tconst { __experimentalUndo } = getSettings();\n\n\t\tif ( ! __experimentalUndo ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( ! didAutomaticChange() ) {\n\t\t\treturn;\n\t\t}\n\n\t\tevent.preventDefault();\n\t\t__experimentalUndo();\n\t}\n\n\telement.addEventListener( 'keydown', onKeyDown );\n\treturn () => {\n\t\telement.removeEventListener( 'keydown', onKeyDown );\n\t};\n};\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAS,EAAEC,MAAM,QAAQ,qBAAqB;;AAEvD;AACA;AACA;AACA,SAASC,KAAK,IAAIC,gBAAgB,QAAQ,gBAAgB;AAE1D,eAAiBC,KAAK,IAAQC,OAAO,IAAM;EAC1C,SAASC,SAASA,CAAEC,KAAK,EAAG;IAC3B,MAAM;MAAEC;IAAQ,CAAC,GAAGD,KAAK;IAEzB,IAAKA,KAAK,CAACE,gBAAgB,EAAG;MAC7B;IACD;IAEA,IAAKD,OAAO,KAAKR,SAAS,IAAIQ,OAAO,KAAKP,MAAM,EAAG;MAClD;IACD;IAEA,MAAM;MAAES;IAAS,CAAC,GAAGN,KAAK,CAACO,OAAO;IAClC,MAAM;MAAEC,kBAAkB;MAAEC;IAAY,CAAC,GACxCH,QAAQ,CAACI,MAAM,CAAEX,gBAAiB,CAAC;IAEpC,MAAM;MAAEY;IAAmB,CAAC,GAAGF,WAAW,CAAC,CAAC;IAE5C,IAAK,CAAEE,kBAAkB,EAAG;MAC3B;IACD;IAEA,IAAK,CAAEH,kBAAkB,CAAC,CAAC,EAAG;MAC7B;IACD;IAEAL,KAAK,CAACS,cAAc,CAAC,CAAC;IACtBD,kBAAkB,CAAC,CAAC;EACrB;EAEAV,OAAO,CAACY,gBAAgB,CAAE,SAAS,EAAEX,SAAU,CAAC;EAChD,OAAO,MAAM;IACZD,OAAO,CAACa,mBAAmB,CAAE,SAAS,EAAEZ,SAAU,CAAC;EACpD,CAAC;AACF,CAAC","ignoreList":[]}