{"version":3,"names":["_components","require","_utils","_editor","_interopRequireDefault","MAX_COLUMNS_NUM_IN_ROW","MIN_WIDTH","styles","columnsContainer","minWidth","MARGIN","marginLeft","getColumnsInRow","width","columnCount","ALIGNMENT_BREAKPOINTS","mobile","medium","Math","min","max","exports","calculateContainerWidth","containerWidth","columnsInRow","getContentWidths","innerColumns","globalStyles","widths","columnWidthsWithUnits","getWidths","columnWidths","getColumnWidths","columnWidthsValues","map","v","convertUnitToMobile","columnWidthsSum","reduce","acc","curr","columnRatios","colWidth","columnWidthsPerRatio","columnRatio","filteredColumnWidthsPerRatio","filter","columnWidthPerRatio","baseContainerWidth","length","minPercentageRatio","largeColumnsWidthsSum","ratio","index","columnWidth","maxColumnWidth","forEach","attributes","innerColumnAttributes","clientId","attributeWidth","proportionalRatio","percentageRatio","initialColumnWidth","round","newColumnWidth","floor","maxWidth"],"sources":["@wordpress/block-library/src/columns/columnCalculations.native.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport {\n\tALIGNMENT_BREAKPOINTS,\n\tconvertUnitToMobile,\n} from '@wordpress/components';\n\n/**\n * Internal dependencies\n */\nimport { getColumnWidths, getWidths } from './utils';\nimport styles from './editor.scss';\n\n/**\n * Maximum number of columns in a row\n *\n * @type {number}\n */\nconst MAX_COLUMNS_NUM_IN_ROW = 3;\n\n/**\n * Minimum width of column\n *\n * @type {number}\n */\nconst MIN_WIDTH = styles.columnsContainer?.minWidth;\n\n/**\n * Container margin value\n *\n * @type {number}\n */\nconst MARGIN = styles.columnsContainer?.marginLeft;\n\nexport const getColumnsInRow = ( width, columnCount ) => {\n\tif ( width ) {\n\t\tif ( width < ALIGNMENT_BREAKPOINTS.mobile ) {\n\t\t\t// show only 1 Column in row for mobile breakpoint container width\n\t\t\treturn 1;\n\t\t} else if ( width <= ALIGNMENT_BREAKPOINTS.medium ) {\n\t\t\t// show the maximum number of columns in a row for large breakpoint container width\n\t\t\treturn Math.min(\n\t\t\t\tMath.max( 1, columnCount ),\n\t\t\t\tMAX_COLUMNS_NUM_IN_ROW\n\t\t\t);\n\t\t}\n\t\t// Show all Column in one row.\n\t\treturn columnCount;\n\t}\n};\n\nexport const calculateContainerWidth = ( containerWidth, columnsInRow ) =>\n\t2 * MARGIN + containerWidth - columnsInRow * 2 * MARGIN;\n\nexport const getContentWidths = (\n\tcolumnsInRow,\n\twidth,\n\tcolumnCount,\n\tinnerColumns,\n\tglobalStyles\n) => {\n\tconst widths = {};\n\tconst columnWidthsWithUnits = getWidths( innerColumns, false );\n\tconst columnWidths = getColumnWidths( innerColumns, columnCount );\n\n\t// Array of column width attribute values\n\tconst columnWidthsValues = columnWidthsWithUnits.map( ( v ) =>\n\t\tconvertUnitToMobile( { width }, globalStyles, v )\n\t);\n\n\t// The sum of column width attribute values\n\tconst columnWidthsSum = columnWidthsValues.reduce(\n\t\t( acc, curr ) => acc + curr,\n\t\t0\n\t);\n\n\t// Array of ratios of each column width attribute value to their sum\n\tconst columnRatios = columnWidthsValues.map(\n\t\t( colWidth ) => colWidth / columnWidthsSum\n\t);\n\n\t// Array of calculated column width for its ratio\n\tconst columnWidthsPerRatio = columnRatios.map(\n\t\t( columnRatio ) =>\n\t\t\tcolumnRatio * calculateContainerWidth( width, columnsInRow )\n\t);\n\n\t//  Array of columns whose calculated width is lower than minimum width value\n\tconst filteredColumnWidthsPerRatio = columnWidthsPerRatio.filter(\n\t\t( columnWidthPerRatio ) => columnWidthPerRatio <= MIN_WIDTH\n\t);\n\n\t// Container width to be divided. If there are some results within `filteredColumnWidthsPerRatio`\n\t// there is a need to reduce the main width by multiplying number\n\t// of results in `filteredColumnWidthsPerRatio` and minimum width value\n\tconst baseContainerWidth =\n\t\twidth - filteredColumnWidthsPerRatio.length * MIN_WIDTH;\n\n\t// The minimum percentage ratio for which column width is equal minimum width value\n\tconst minPercentageRatio =\n\t\tMIN_WIDTH / calculateContainerWidth( width, columnsInRow );\n\n\t// The sum of column widths which ratio is higher than `minPercentageRatio`\n\tconst largeColumnsWidthsSum = columnRatios\n\t\t.map( ( ratio, index ) => {\n\t\t\tif ( ratio > minPercentageRatio ) {\n\t\t\t\treturn columnWidthsValues[ index ];\n\t\t\t}\n\t\t\treturn 0;\n\t\t} )\n\t\t.reduce( ( acc, curr ) => acc + curr, 0 );\n\n\tconst containerWidth = calculateContainerWidth(\n\t\tbaseContainerWidth,\n\t\tcolumnsInRow\n\t);\n\n\tlet columnWidth =\n\t\tcalculateContainerWidth( width, columnsInRow ) / columnsInRow;\n\tlet maxColumnWidth = columnWidth;\n\n\tinnerColumns.forEach(\n\t\t( { attributes: innerColumnAttributes, clientId } ) => {\n\t\t\tconst attributeWidth = convertUnitToMobile(\n\t\t\t\t{ width },\n\t\t\t\tglobalStyles,\n\t\t\t\tinnerColumnAttributes.width || columnWidths[ clientId ]\n\t\t\t);\n\t\t\tconst proportionalRatio = attributeWidth / columnWidthsSum;\n\t\t\tconst percentageRatio = attributeWidth / width;\n\t\t\tconst initialColumnWidth = proportionalRatio * containerWidth;\n\n\t\t\tif ( columnCount === 1 && width > ALIGNMENT_BREAKPOINTS.medium ) {\n\t\t\t\t// Exactly one column inside columns on the breakpoint higher than medium\n\t\t\t\t// has to take a percentage of the full width\n\t\t\t\tcolumnWidth = percentageRatio * containerWidth;\n\t\t\t} else if ( columnsInRow > 1 ) {\n\t\t\t\tif ( width > ALIGNMENT_BREAKPOINTS.medium ) {\n\t\t\t\t\tif ( initialColumnWidth <= MIN_WIDTH ) {\n\t\t\t\t\t\t// Column width cannot be lower than minimum 32px\n\t\t\t\t\t\tcolumnWidth = MIN_WIDTH;\n\t\t\t\t\t} else if ( initialColumnWidth > MIN_WIDTH ) {\n\t\t\t\t\t\t// Column width has to be the result of multiplying the container width and\n\t\t\t\t\t\t// the ratio of attribute and the sum of widths of columns wider than 32px\n\t\t\t\t\t\tcolumnWidth =\n\t\t\t\t\t\t\t( attributeWidth / largeColumnsWidthsSum ) *\n\t\t\t\t\t\t\tcontainerWidth;\n\t\t\t\t\t}\n\n\t\t\t\t\tmaxColumnWidth = columnWidth;\n\n\t\t\t\t\tif ( Math.round( columnWidthsSum ) < width ) {\n\t\t\t\t\t\t// In case that column width attribute values does not exceed 100, each column\n\t\t\t\t\t\t// should have attribute percentage of container width\n\t\t\t\t\t\tconst newColumnWidth = percentageRatio * containerWidth;\n\t\t\t\t\t\tif ( newColumnWidth <= MIN_WIDTH ) {\n\t\t\t\t\t\t\tcolumnWidth = MIN_WIDTH;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcolumnWidth = newColumnWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if ( width < ALIGNMENT_BREAKPOINTS.medium ) {\n\t\t\t\t\t// On the breakpoint lower than medium each column inside columns\n\t\t\t\t\t// has to take equal part of container width\n\t\t\t\t\tcolumnWidth =\n\t\t\t\t\t\tcalculateContainerWidth( width, columnsInRow ) /\n\t\t\t\t\t\tcolumnsInRow;\n\t\t\t\t}\n\t\t\t}\n\t\t\twidths[ clientId ] = {\n\t\t\t\twidth: Math.floor( columnWidth ),\n\t\t\t\tmaxWidth: Math.floor( maxColumnWidth ),\n\t\t\t};\n\t\t}\n\t);\n\treturn widths;\n};\n"],"mappings":"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","ignoreList":[]}