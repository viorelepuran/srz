{"version":3,"names":["_reactNative","require","_shared","_galleryStyles","_interopRequireDefault","_i18n","_blockEditor","_element","_reactNativeBridge","_components","_compose","_viewport","_jsxRuntime","TILE_SPACING","MAX_DISPLAYED_COLUMNS","MAX_DISPLAYED_COLUMNS_NARROW","Gallery","props","isCaptionSelected","setIsCaptionSelected","useState","resizeObserver","sizes","useResizeObserver","maxWidth","setMaxWidth","useEffect","mediaUploadSync","mediaPlaceholder","attributes","images","isNarrow","onBlur","insertBlocksAfter","clientId","width","align","columns","defaultColumnsNumber","length","displayedColumns","Math","min","innerBlocksProps","useInnerBlocksProps","contentResizeMode","orientation","renderAppender","numColumns","marginHorizontal","marginVertical","layout","type","alignments","gridProperties","parentWidth","focusGalleryCaption","isFullWidth","WIDE_ALIGNMENTS","full","jsxs","View","style","styles","fullWidth","children","jsx","galleryAppender","BlockCaption","isSelected","accessible","accessibilityLabelCreator","caption","RichText","isEmpty","sprintf","__","onFocus","exports","_default","default","withViewportMatch"],"sources":["@wordpress/block-library/src/gallery/gallery.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport { View } from 'react-native';\n\n/**\n * Internal dependencies\n */\nimport { defaultColumnsNumber } from './shared';\nimport styles from './gallery-styles.scss';\n\n/**\n * WordPress dependencies\n */\nimport { __, sprintf } from '@wordpress/i18n';\nimport {\n\tBlockCaption,\n\tRichText,\n\tuseInnerBlocksProps,\n} from '@wordpress/block-editor';\nimport { useState, useEffect } from '@wordpress/element';\nimport { mediaUploadSync } from '@wordpress/react-native-bridge';\nimport { WIDE_ALIGNMENTS } from '@wordpress/components';\nimport { useResizeObserver } from '@wordpress/compose';\nimport { withViewportMatch } from '@wordpress/viewport';\n\nconst TILE_SPACING = 8;\n\n// we must limit displayed columns since readable content max-width is 580px\nconst MAX_DISPLAYED_COLUMNS = 4;\nconst MAX_DISPLAYED_COLUMNS_NARROW = 2;\n\nexport const Gallery = ( props ) => {\n\tconst [ isCaptionSelected, setIsCaptionSelected ] = useState( false );\n\tconst [ resizeObserver, sizes ] = useResizeObserver();\n\tconst [ maxWidth, setMaxWidth ] = useState( 0 );\n\tuseEffect( mediaUploadSync, [] );\n\n\tconst {\n\t\tmediaPlaceholder,\n\t\tattributes,\n\t\timages,\n\t\tisNarrow,\n\t\tonBlur,\n\t\tinsertBlocksAfter,\n\t\tclientId,\n\t} = props;\n\n\tuseEffect( () => {\n\t\tconst { width } = sizes || {};\n\t\tif ( width ) {\n\t\t\tsetMaxWidth( width );\n\t\t}\n\t}, [ sizes ] );\n\n\tconst { align, columns = defaultColumnsNumber( images.length ) } =\n\t\tattributes;\n\n\tconst displayedColumns = Math.min(\n\t\tcolumns,\n\t\tisNarrow ? MAX_DISPLAYED_COLUMNS_NARROW : MAX_DISPLAYED_COLUMNS\n\t);\n\n\tconst innerBlocksProps = useInnerBlocksProps(\n\t\t{},\n\t\t{\n\t\t\tcontentResizeMode: 'stretch',\n\t\t\torientation: 'horizontal',\n\t\t\trenderAppender: false,\n\t\t\tnumColumns: displayedColumns,\n\t\t\tmarginHorizontal: TILE_SPACING,\n\t\t\tmarginVertical: TILE_SPACING,\n\t\t\tlayout: { type: 'default', alignments: [] },\n\t\t\tgridProperties: {\n\t\t\t\tnumColumns: displayedColumns,\n\t\t\t},\n\t\t\tparentWidth: maxWidth + 2 * TILE_SPACING,\n\t\t}\n\t);\n\n\tconst focusGalleryCaption = () => {\n\t\tif ( ! isCaptionSelected ) {\n\t\t\tsetIsCaptionSelected( true );\n\t\t}\n\t};\n\n\tconst isFullWidth = align === WIDE_ALIGNMENTS.alignments.full;\n\n\treturn (\n\t\t<View style={ isFullWidth && styles.fullWidth }>\n\t\t\t{ resizeObserver }\n\t\t\t<View { ...innerBlocksProps } />\n\t\t\t<View\n\t\t\t\tstyle={ [\n\t\t\t\t\tisFullWidth && styles.fullWidth,\n\t\t\t\t\tstyles.galleryAppender,\n\t\t\t\t] }\n\t\t\t>\n\t\t\t\t{ mediaPlaceholder }\n\t\t\t</View>\n\t\t\t<BlockCaption\n\t\t\t\tclientId={ clientId }\n\t\t\t\tisSelected={ isCaptionSelected }\n\t\t\t\taccessible\n\t\t\t\taccessibilityLabelCreator={ ( caption ) =>\n\t\t\t\t\tRichText.isEmpty( caption )\n\t\t\t\t\t\t? /* translators: accessibility text. Empty gallery caption. */\n\n\t\t\t\t\t\t  'Gallery caption. Empty'\n\t\t\t\t\t\t: sprintf(\n\t\t\t\t\t\t\t\t/* translators: accessibility text. %s: gallery caption. */\n\t\t\t\t\t\t\t\t__( 'Gallery caption. %s' ),\n\t\t\t\t\t\t\t\tcaption\n\t\t\t\t\t\t  )\n\t\t\t\t}\n\t\t\t\tonFocus={ focusGalleryCaption }\n\t\t\t\tonBlur={ onBlur } // Always assign onBlur as props.\n\t\t\t\tinsertBlocksAfter={ insertBlocksAfter }\n\t\t\t/>\n\t\t</View>\n\t);\n};\n\nexport default withViewportMatch( { isNarrow: '< small' } )( Gallery );\n"],"mappings":"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","ignoreList":[]}