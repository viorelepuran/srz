{"version":3,"names":["_blockEditor","require","_coreData","_i18n","_components","_icons","_jsxRuntime","FootnotesEdit","context","postType","postId","meta","updateMeta","useEntityProp","footnotesSupported","footnotes","JSON","parse","blockProps","useBlockProps","jsx","children","Placeholder","icon","BlockIcon","label","__","instructions","length","map","id","content","jsxs","onMouseDown","event","target","currentTarget","firstElementChild","focus","preventDefault","RichText","tagName","value","identifier","onFocus","textContent","trim","scrollIntoView","onChange","nextFootnote","stringify","footnote","href"],"sources":["@wordpress/block-library/src/footnotes/edit.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { BlockIcon, RichText, useBlockProps } from '@wordpress/block-editor';\nimport { useEntityProp } from '@wordpress/core-data';\nimport { __ } from '@wordpress/i18n';\nimport { Placeholder } from '@wordpress/components';\nimport { formatListNumbered as icon } from '@wordpress/icons';\n\nexport default function FootnotesEdit( { context: { postType, postId } } ) {\n\tconst [ meta, updateMeta ] = useEntityProp(\n\t\t'postType',\n\t\tpostType,\n\t\t'meta',\n\t\tpostId\n\t);\n\tconst footnotesSupported = 'string' === typeof meta?.footnotes;\n\tconst footnotes = meta?.footnotes ? JSON.parse( meta.footnotes ) : [];\n\tconst blockProps = useBlockProps();\n\n\tif ( ! footnotesSupported ) {\n\t\treturn (\n\t\t\t<div { ...blockProps }>\n\t\t\t\t<Placeholder\n\t\t\t\t\ticon={ <BlockIcon icon={ icon } /> }\n\t\t\t\t\tlabel={ __( 'Footnotes' ) }\n\t\t\t\t\tinstructions={ __(\n\t\t\t\t\t\t'Footnotes are not supported here. Add this block to post or page content.'\n\t\t\t\t\t) }\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n\n\tif ( ! footnotes.length ) {\n\t\treturn (\n\t\t\t<div { ...blockProps }>\n\t\t\t\t<Placeholder\n\t\t\t\t\ticon={ <BlockIcon icon={ icon } /> }\n\t\t\t\t\tlabel={ __( 'Footnotes' ) }\n\t\t\t\t\tinstructions={ __(\n\t\t\t\t\t\t'Footnotes found in blocks within this document will be displayed here.'\n\t\t\t\t\t) }\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn (\n\t\t<ol { ...blockProps }>\n\t\t\t{ footnotes.map( ( { id, content } ) => (\n\t\t\t\t/* eslint-disable-next-line jsx-a11y/no-noninteractive-element-interactions */\n\t\t\t\t<li\n\t\t\t\t\tkey={ id }\n\t\t\t\t\tonMouseDown={ ( event ) => {\n\t\t\t\t\t\t// When clicking on the list item (not on descendants),\n\t\t\t\t\t\t// focus the rich text element since it's only 1px wide when\n\t\t\t\t\t\t// empty.\n\t\t\t\t\t\tif ( event.target === event.currentTarget ) {\n\t\t\t\t\t\t\tevent.target.firstElementChild.focus();\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t} }\n\t\t\t\t>\n\t\t\t\t\t<RichText\n\t\t\t\t\t\tid={ id }\n\t\t\t\t\t\ttagName=\"span\"\n\t\t\t\t\t\tvalue={ content }\n\t\t\t\t\t\tidentifier={ id }\n\t\t\t\t\t\t// To do: figure out why the browser is not scrolling\n\t\t\t\t\t\t// into view when it receives focus.\n\t\t\t\t\t\tonFocus={ ( event ) => {\n\t\t\t\t\t\t\tif ( ! event.target.textContent.trim() ) {\n\t\t\t\t\t\t\t\tevent.target.scrollIntoView();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tonChange={ ( nextFootnote ) => {\n\t\t\t\t\t\t\tupdateMeta( {\n\t\t\t\t\t\t\t\t...meta,\n\t\t\t\t\t\t\t\tfootnotes: JSON.stringify(\n\t\t\t\t\t\t\t\t\tfootnotes.map( ( footnote ) => {\n\t\t\t\t\t\t\t\t\t\treturn footnote.id === id\n\t\t\t\t\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontent: nextFootnote,\n\t\t\t\t\t\t\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t\t\t\t\t: footnote;\n\t\t\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>{ ' ' }\n\t\t\t\t\t<a href={ `#${ id }-link` }>↩︎</a>\n\t\t\t\t</li>\n\t\t\t) ) }\n\t\t</ol>\n\t);\n}\n"],"mappings":"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","ignoreList":[]}