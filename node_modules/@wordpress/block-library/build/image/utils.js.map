{"version":3,"names":["_constants","require","evalAspectRatio","value","width","height","split","map","Number","aspectRatio","Infinity","NaN","removeNewTabRel","currentRel","newRel","undefined","NEW_TAB_REL","forEach","relVal","regExp","RegExp","replace","trim","getUpdatedLinkTargetSettings","rel","linkTarget","updatedRel","getImageSizeAttributes","image","size","url","media_details","sizes","source_url","sizeSlug","isValidFileType","file","ALLOWED_MEDIA_TYPES","some","mediaType","type","indexOf"],"sources":["@wordpress/block-library/src/image/utils.js"],"sourcesContent":["/**\n * Internal dependencies\n */\nimport { NEW_TAB_REL, ALLOWED_MEDIA_TYPES } from './constants';\n\n/**\n * Evaluates a CSS aspect-ratio property value as a number.\n *\n * Degenerate or invalid ratios behave as 'auto'. And 'auto' ratios return NaN.\n *\n * @see https://drafts.csswg.org/css-sizing-4/#aspect-ratio\n *\n * @param {string} value CSS aspect-ratio property value.\n * @return {number} Numerical aspect ratio or NaN if invalid.\n */\nexport function evalAspectRatio( value ) {\n\tconst [ width, height = 1 ] = value.split( '/' ).map( Number );\n\tconst aspectRatio = width / height;\n\treturn aspectRatio === Infinity || aspectRatio === 0 ? NaN : aspectRatio;\n}\n\nexport function removeNewTabRel( currentRel ) {\n\tlet newRel = currentRel;\n\n\tif ( currentRel !== undefined && newRel ) {\n\t\tNEW_TAB_REL.forEach( ( relVal ) => {\n\t\t\tconst regExp = new RegExp( '\\\\b' + relVal + '\\\\b', 'gi' );\n\t\t\tnewRel = newRel.replace( regExp, '' );\n\t\t} );\n\n\t\t// Only trim if NEW_TAB_REL values was replaced.\n\t\tif ( newRel !== currentRel ) {\n\t\t\tnewRel = newRel.trim();\n\t\t}\n\n\t\tif ( ! newRel ) {\n\t\t\tnewRel = undefined;\n\t\t}\n\t}\n\n\treturn newRel;\n}\n\n/**\n * Helper to get the link target settings to be stored.\n *\n * @param {boolean} value          The new link target value.\n * @param {Object}  attributes     Block attributes.\n * @param {Object}  attributes.rel Image block's rel attribute.\n *\n * @return {Object} Updated link target settings.\n */\nexport function getUpdatedLinkTargetSettings( value, { rel } ) {\n\tconst linkTarget = value ? '_blank' : undefined;\n\n\tlet updatedRel;\n\tif ( ! linkTarget && ! rel ) {\n\t\tupdatedRel = undefined;\n\t} else {\n\t\tupdatedRel = removeNewTabRel( rel );\n\t}\n\n\treturn {\n\t\tlinkTarget,\n\t\trel: updatedRel,\n\t};\n}\n\n/**\n * Determines new Image block attributes size selection.\n *\n * @param {Object} image Media file object for gallery image.\n * @param {string} size  Selected size slug to apply.\n */\nexport function getImageSizeAttributes( image, size ) {\n\tconst url = image?.media_details?.sizes?.[ size ]?.source_url;\n\n\tif ( url ) {\n\t\treturn { url, width: undefined, height: undefined, sizeSlug: size };\n\t}\n\n\treturn {};\n}\n\n/**\n * Checks if the file has a valid file type.\n *\n * @param {File} file - The file to check.\n * @return {boolean} - Returns true if the file has a valid file type, otherwise false.\n */\nexport function isValidFileType( file ) {\n\treturn ALLOWED_MEDIA_TYPES.some(\n\t\t( mediaType ) => file.type.indexOf( mediaType ) === 0\n\t);\n}\n"],"mappings":";;;;;;;;;;AAGA,IAAAA,UAAA,GAAAC,OAAA;AAHA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAASC,eAAeA,CAAEC,KAAK,EAAG;EACxC,MAAM,CAAEC,KAAK,EAAEC,MAAM,GAAG,CAAC,CAAE,GAAGF,KAAK,CAACG,KAAK,CAAE,GAAI,CAAC,CAACC,GAAG,CAAEC,MAAO,CAAC;EAC9D,MAAMC,WAAW,GAAGL,KAAK,GAAGC,MAAM;EAClC,OAAOI,WAAW,KAAKC,QAAQ,IAAID,WAAW,KAAK,CAAC,GAAGE,GAAG,GAAGF,WAAW;AACzE;AAEO,SAASG,eAAeA,CAAEC,UAAU,EAAG;EAC7C,IAAIC,MAAM,GAAGD,UAAU;EAEvB,IAAKA,UAAU,KAAKE,SAAS,IAAID,MAAM,EAAG;IACzCE,sBAAW,CAACC,OAAO,CAAIC,MAAM,IAAM;MAClC,MAAMC,MAAM,GAAG,IAAIC,MAAM,CAAE,KAAK,GAAGF,MAAM,GAAG,KAAK,EAAE,IAAK,CAAC;MACzDJ,MAAM,GAAGA,MAAM,CAACO,OAAO,CAAEF,MAAM,EAAE,EAAG,CAAC;IACtC,CAAE,CAAC;;IAEH;IACA,IAAKL,MAAM,KAAKD,UAAU,EAAG;MAC5BC,MAAM,GAAGA,MAAM,CAACQ,IAAI,CAAC,CAAC;IACvB;IAEA,IAAK,CAAER,MAAM,EAAG;MACfA,MAAM,GAAGC,SAAS;IACnB;EACD;EAEA,OAAOD,MAAM;AACd;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAASS,4BAA4BA,CAAEpB,KAAK,EAAE;EAAEqB;AAAI,CAAC,EAAG;EAC9D,MAAMC,UAAU,GAAGtB,KAAK,GAAG,QAAQ,GAAGY,SAAS;EAE/C,IAAIW,UAAU;EACd,IAAK,CAAED,UAAU,IAAI,CAAED,GAAG,EAAG;IAC5BE,UAAU,GAAGX,SAAS;EACvB,CAAC,MAAM;IACNW,UAAU,GAAGd,eAAe,CAAEY,GAAI,CAAC;EACpC;EAEA,OAAO;IACNC,UAAU;IACVD,GAAG,EAAEE;EACN,CAAC;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACO,SAASC,sBAAsBA,CAAEC,KAAK,EAAEC,IAAI,EAAG;EACrD,MAAMC,GAAG,GAAGF,KAAK,EAAEG,aAAa,EAAEC,KAAK,GAAIH,IAAI,CAAE,EAAEI,UAAU;EAE7D,IAAKH,GAAG,EAAG;IACV,OAAO;MAAEA,GAAG;MAAE1B,KAAK,EAAEW,SAAS;MAAEV,MAAM,EAAEU,SAAS;MAAEmB,QAAQ,EAAEL;IAAK,CAAC;EACpE;EAEA,OAAO,CAAC,CAAC;AACV;;AAEA;AACA;AACA;AACA;AACA;AACA;AACO,SAASM,eAAeA,CAAEC,IAAI,EAAG;EACvC,OAAOC,8BAAmB,CAACC,IAAI,CAC5BC,SAAS,IAAMH,IAAI,CAACI,IAAI,CAACC,OAAO,CAAEF,SAAU,CAAC,KAAK,CACrD,CAAC;AACF","ignoreList":[]}