{"version":3,"names":["_blocks","require","_coreData","_data","_element","_useGenerateDefaultNavigationTitle","_interopRequireDefault","CREATE_NAVIGATION_MENU_SUCCESS","exports","CREATE_NAVIGATION_MENU_ERROR","CREATE_NAVIGATION_MENU_PENDING","CREATE_NAVIGATION_MENU_IDLE","useCreateNavigationMenu","clientId","status","setStatus","useState","value","setValue","error","setError","saveEntityRecord","editEntityRecord","useDispatch","coreStore","generateDefaultTitle","useGenerateDefaultNavigationTitle","create","useCallback","title","blocks","postStatus","Error","catch","err","message","cause","record","content","serialize","then","response","id","isIdle","isPending","isSuccess","isError"],"sources":["@wordpress/block-library/src/navigation/edit/use-create-navigation-menu.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { serialize } from '@wordpress/blocks';\nimport { store as coreStore } from '@wordpress/core-data';\nimport { useDispatch } from '@wordpress/data';\nimport { useState, useCallback } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport useGenerateDefaultNavigationTitle from './use-generate-default-navigation-title';\n\nexport const CREATE_NAVIGATION_MENU_SUCCESS = 'success';\nexport const CREATE_NAVIGATION_MENU_ERROR = 'error';\nexport const CREATE_NAVIGATION_MENU_PENDING = 'pending';\nexport const CREATE_NAVIGATION_MENU_IDLE = 'idle';\n\nexport default function useCreateNavigationMenu( clientId ) {\n\tconst [ status, setStatus ] = useState( CREATE_NAVIGATION_MENU_IDLE );\n\tconst [ value, setValue ] = useState( null );\n\tconst [ error, setError ] = useState( null );\n\n\tconst { saveEntityRecord, editEntityRecord } = useDispatch( coreStore );\n\tconst generateDefaultTitle = useGenerateDefaultNavigationTitle( clientId );\n\n\t// This callback uses data from the two placeholder steps and only creates\n\t// a new navigation menu when the user completes the final step.\n\tconst create = useCallback(\n\t\tasync ( title = null, blocks = [], postStatus ) => {\n\t\t\t// Guard against creating Navigations without a title.\n\t\t\t// Note you can pass no title, but if one is passed it must be\n\t\t\t// a string otherwise the title may end up being empty.\n\t\t\tif ( title && typeof title !== 'string' ) {\n\t\t\t\tsetError(\n\t\t\t\t\t'Invalid title supplied when creating Navigation Menu.'\n\t\t\t\t);\n\t\t\t\tsetStatus( CREATE_NAVIGATION_MENU_ERROR );\n\t\t\t\tthrow new Error(\n\t\t\t\t\t`Value of supplied title argument was not a string.`\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tsetStatus( CREATE_NAVIGATION_MENU_PENDING );\n\t\t\tsetValue( null );\n\t\t\tsetError( null );\n\n\t\t\tif ( ! title ) {\n\t\t\t\ttitle = await generateDefaultTitle().catch( ( err ) => {\n\t\t\t\t\tsetError( err?.message );\n\t\t\t\t\tsetStatus( CREATE_NAVIGATION_MENU_ERROR );\n\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t'Failed to create title when saving new Navigation Menu.',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcause: err,\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t} );\n\t\t\t}\n\t\t\tconst record = {\n\t\t\t\ttitle,\n\t\t\t\tcontent: serialize( blocks ),\n\t\t\t\tstatus: postStatus,\n\t\t\t};\n\n\t\t\t// Return affords ability to await on this function directly\n\t\t\treturn saveEntityRecord( 'postType', 'wp_navigation', record )\n\t\t\t\t.then( ( response ) => {\n\t\t\t\t\tsetValue( response );\n\t\t\t\t\tsetStatus( CREATE_NAVIGATION_MENU_SUCCESS );\n\n\t\t\t\t\t// Set the status to publish so that the Navigation block\n\t\t\t\t\t// shows up in the multi entity save flow.\n\t\t\t\t\tif ( postStatus !== 'publish' ) {\n\t\t\t\t\t\teditEntityRecord(\n\t\t\t\t\t\t\t'postType',\n\t\t\t\t\t\t\t'wp_navigation',\n\t\t\t\t\t\t\tresponse.id,\n\t\t\t\t\t\t\t{ status: 'publish' }\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn response;\n\t\t\t\t} )\n\t\t\t\t.catch( ( err ) => {\n\t\t\t\t\tsetError( err?.message );\n\t\t\t\t\tsetStatus( CREATE_NAVIGATION_MENU_ERROR );\n\t\t\t\t\tthrow new Error( 'Unable to save new Navigation Menu', {\n\t\t\t\t\t\tcause: err,\n\t\t\t\t\t} );\n\t\t\t\t} );\n\t\t},\n\t\t[ saveEntityRecord, editEntityRecord, generateDefaultTitle ]\n\t);\n\n\treturn {\n\t\tcreate,\n\t\tstatus,\n\t\tvalue,\n\t\terror,\n\t\tisIdle: status === CREATE_NAVIGATION_MENU_IDLE,\n\t\tisPending: status === CREATE_NAVIGATION_MENU_PENDING,\n\t\tisSuccess: status === CREATE_NAVIGATION_MENU_SUCCESS,\n\t\tisError: status === CREATE_NAVIGATION_MENU_ERROR,\n\t};\n}\n"],"mappings":"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","ignoreList":[]}