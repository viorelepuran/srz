{"version":3,"names":["_clsx","_interopRequireDefault","require","_element","_compose","_i18n","_blockEditor","_components","_icons","_blocks","_lockUnlock","_jsxRuntime","Caption","attributeKey","attributes","setAttributes","isSelected","insertBlocksAfter","placeholder","__","label","showToolbarButton","excludeElementClassName","className","readOnly","tagName","addLabel","removeLabel","icon","captionIcon","props","caption","prevCaption","usePrevious","PrivateRichText","RichText","unlock","blockEditorPrivateApis","isCaptionEmpty","isEmpty","isPrevCaptionEmpty","showCaption","setShowCaption","useState","useEffect","ref","useCallback","node","focus","jsxs","Fragment","children","jsx","BlockControls","group","ToolbarButton","onClick","undefined","isPressed","identifier","clsx","__experimentalGetElementClassName","value","onChange","inlineToolbar","__unstableOnSplitAtEnd","createBlock","getDefaultBlockName"],"sources":["@wordpress/block-library/src/utils/caption.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport clsx from 'clsx';\n\n/**\n * WordPress dependencies\n */\nimport { useState, useEffect, useCallback } from '@wordpress/element';\nimport { usePrevious } from '@wordpress/compose';\nimport { __ } from '@wordpress/i18n';\nimport {\n\tBlockControls,\n\t__experimentalGetElementClassName,\n\tprivateApis as blockEditorPrivateApis,\n} from '@wordpress/block-editor';\nimport { ToolbarButton } from '@wordpress/components';\nimport { caption as captionIcon } from '@wordpress/icons';\nimport { createBlock, getDefaultBlockName } from '@wordpress/blocks';\n\n/**\n * Internal dependencies\n */\nimport { unlock } from '../lock-unlock';\n\nexport function Caption( {\n\tattributeKey = 'caption',\n\tattributes,\n\tsetAttributes,\n\tisSelected,\n\tinsertBlocksAfter,\n\tplaceholder = __( 'Add caption' ),\n\tlabel = __( 'Caption text' ),\n\tshowToolbarButton = true,\n\texcludeElementClassName,\n\tclassName,\n\treadOnly,\n\ttagName = 'figcaption',\n\taddLabel = __( 'Add caption' ),\n\tremoveLabel = __( 'Remove caption' ),\n\ticon = captionIcon,\n\t...props\n} ) {\n\tconst caption = attributes[ attributeKey ];\n\tconst prevCaption = usePrevious( caption );\n\tconst { PrivateRichText: RichText } = unlock( blockEditorPrivateApis );\n\tconst isCaptionEmpty = RichText.isEmpty( caption );\n\tconst isPrevCaptionEmpty = RichText.isEmpty( prevCaption );\n\tconst [ showCaption, setShowCaption ] = useState( ! isCaptionEmpty );\n\n\t// We need to show the caption when changes come from\n\t// history navigation(undo/redo).\n\tuseEffect( () => {\n\t\tif ( ! isCaptionEmpty && isPrevCaptionEmpty ) {\n\t\t\tsetShowCaption( true );\n\t\t}\n\t}, [ isCaptionEmpty, isPrevCaptionEmpty ] );\n\n\tuseEffect( () => {\n\t\tif ( ! isSelected && isCaptionEmpty ) {\n\t\t\tsetShowCaption( false );\n\t\t}\n\t}, [ isSelected, isCaptionEmpty ] );\n\n\t// Focus the caption when we click to add one.\n\tconst ref = useCallback(\n\t\t( node ) => {\n\t\t\tif ( node && isCaptionEmpty ) {\n\t\t\t\tnode.focus();\n\t\t\t}\n\t\t},\n\t\t[ isCaptionEmpty ]\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t{ showToolbarButton && (\n\t\t\t\t<BlockControls group=\"block\">\n\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\tsetShowCaption( ! showCaption );\n\t\t\t\t\t\t\tif ( showCaption && caption ) {\n\t\t\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\t\t\t[ attributeKey ]: undefined,\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} }\n\t\t\t\t\t\ticon={ icon }\n\t\t\t\t\t\tisPressed={ showCaption }\n\t\t\t\t\t\tlabel={ showCaption ? removeLabel : addLabel }\n\t\t\t\t\t/>\n\t\t\t\t</BlockControls>\n\t\t\t) }\n\t\t\t{ showCaption &&\n\t\t\t\t( ! RichText.isEmpty( caption ) || isSelected ) && (\n\t\t\t\t\t<RichText\n\t\t\t\t\t\tidentifier={ attributeKey }\n\t\t\t\t\t\ttagName={ tagName }\n\t\t\t\t\t\tclassName={ clsx(\n\t\t\t\t\t\t\tclassName,\n\t\t\t\t\t\t\texcludeElementClassName\n\t\t\t\t\t\t\t\t? ''\n\t\t\t\t\t\t\t\t: __experimentalGetElementClassName( 'caption' )\n\t\t\t\t\t\t) }\n\t\t\t\t\t\tref={ ref }\n\t\t\t\t\t\taria-label={ label }\n\t\t\t\t\t\tplaceholder={ placeholder }\n\t\t\t\t\t\tvalue={ caption }\n\t\t\t\t\t\tonChange={ ( value ) =>\n\t\t\t\t\t\t\tsetAttributes( { [ attributeKey ]: value } )\n\t\t\t\t\t\t}\n\t\t\t\t\t\tinlineToolbar\n\t\t\t\t\t\t__unstableOnSplitAtEnd={ () =>\n\t\t\t\t\t\t\tinsertBlocksAfter(\n\t\t\t\t\t\t\t\tcreateBlock( getDefaultBlockName() )\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t}\n\t\t\t\t\t\treadOnly={ readOnly }\n\t\t\t\t\t\t{ ...props }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t</>\n\t);\n}\n"],"mappings":";;;;;;;AAGA,IAAAA,KAAA,GAAAC,sBAAA,CAAAC,OAAA;AAKA,IAAAC,QAAA,GAAAD,OAAA;AACA,IAAAE,QAAA,GAAAF,OAAA;AACA,IAAAG,KAAA,GAAAH,OAAA;AACA,IAAAI,YAAA,GAAAJ,OAAA;AAKA,IAAAK,WAAA,GAAAL,OAAA;AACA,IAAAM,MAAA,GAAAN,OAAA;AACA,IAAAO,OAAA,GAAAP,OAAA;AAKA,IAAAQ,WAAA,GAAAR,OAAA;AAAwC,IAAAS,WAAA,GAAAT,OAAA;AAvBxC;AACA;AACA;;AAGA;AACA;AACA;;AAaA;AACA;AACA;;AAGO,SAASU,OAAOA,CAAE;EACxBC,YAAY,GAAG,SAAS;EACxBC,UAAU;EACVC,aAAa;EACbC,UAAU;EACVC,iBAAiB;EACjBC,WAAW,GAAG,IAAAC,QAAE,EAAE,aAAc,CAAC;EACjCC,KAAK,GAAG,IAAAD,QAAE,EAAE,cAAe,CAAC;EAC5BE,iBAAiB,GAAG,IAAI;EACxBC,uBAAuB;EACvBC,SAAS;EACTC,QAAQ;EACRC,OAAO,GAAG,YAAY;EACtBC,QAAQ,GAAG,IAAAP,QAAE,EAAE,aAAc,CAAC;EAC9BQ,WAAW,GAAG,IAAAR,QAAE,EAAE,gBAAiB,CAAC;EACpCS,IAAI,GAAGC,cAAW;EAClB,GAAGC;AACJ,CAAC,EAAG;EACH,MAAMC,OAAO,GAAGjB,UAAU,CAAED,YAAY,CAAE;EAC1C,MAAMmB,WAAW,GAAG,IAAAC,oBAAW,EAAEF,OAAQ,CAAC;EAC1C,MAAM;IAAEG,eAAe,EAAEC;EAAS,CAAC,GAAG,IAAAC,kBAAM,EAAEC,wBAAuB,CAAC;EACtE,MAAMC,cAAc,GAAGH,QAAQ,CAACI,OAAO,CAAER,OAAQ,CAAC;EAClD,MAAMS,kBAAkB,GAAGL,QAAQ,CAACI,OAAO,CAAEP,WAAY,CAAC;EAC1D,MAAM,CAAES,WAAW,EAAEC,cAAc,CAAE,GAAG,IAAAC,iBAAQ,EAAE,CAAEL,cAAe,CAAC;;EAEpE;EACA;EACA,IAAAM,kBAAS,EAAE,MAAM;IAChB,IAAK,CAAEN,cAAc,IAAIE,kBAAkB,EAAG;MAC7CE,cAAc,CAAE,IAAK,CAAC;IACvB;EACD,CAAC,EAAE,CAAEJ,cAAc,EAAEE,kBAAkB,CAAG,CAAC;EAE3C,IAAAI,kBAAS,EAAE,MAAM;IAChB,IAAK,CAAE5B,UAAU,IAAIsB,cAAc,EAAG;MACrCI,cAAc,CAAE,KAAM,CAAC;IACxB;EACD,CAAC,EAAE,CAAE1B,UAAU,EAAEsB,cAAc,CAAG,CAAC;;EAEnC;EACA,MAAMO,GAAG,GAAG,IAAAC,oBAAW,EACpBC,IAAI,IAAM;IACX,IAAKA,IAAI,IAAIT,cAAc,EAAG;MAC7BS,IAAI,CAACC,KAAK,CAAC,CAAC;IACb;EACD,CAAC,EACD,CAAEV,cAAc,CACjB,CAAC;EAED,oBACC,IAAA3B,WAAA,CAAAsC,IAAA,EAAAtC,WAAA,CAAAuC,QAAA;IAAAC,QAAA,GACG9B,iBAAiB,iBAClB,IAAAV,WAAA,CAAAyC,GAAA,EAAC9C,YAAA,CAAA+C,aAAa;MAACC,KAAK,EAAC,OAAO;MAAAH,QAAA,eAC3B,IAAAxC,WAAA,CAAAyC,GAAA,EAAC7C,WAAA,CAAAgD,aAAa;QACbC,OAAO,EAAGA,CAAA,KAAM;UACfd,cAAc,CAAE,CAAED,WAAY,CAAC;UAC/B,IAAKA,WAAW,IAAIV,OAAO,EAAG;YAC7BhB,aAAa,CAAE;cACd,CAAEF,YAAY,GAAI4C;YACnB,CAAE,CAAC;UACJ;QACD,CAAG;QACH7B,IAAI,EAAGA,IAAM;QACb8B,SAAS,EAAGjB,WAAa;QACzBrB,KAAK,EAAGqB,WAAW,GAAGd,WAAW,GAAGD;MAAU,CAC9C;IAAC,CACY,CACf,EACCe,WAAW,KACV,CAAEN,QAAQ,CAACI,OAAO,CAAER,OAAQ,CAAC,IAAIf,UAAU,CAAE,iBAC9C,IAAAL,WAAA,CAAAyC,GAAA,EAACjB,QAAQ;MACRwB,UAAU,EAAG9C,YAAc;MAC3BY,OAAO,EAAGA,OAAS;MACnBF,SAAS,EAAG,IAAAqC,aAAI,EACfrC,SAAS,EACTD,uBAAuB,GACpB,EAAE,GACF,IAAAuC,8CAAiC,EAAE,SAAU,CACjD,CAAG;MACHhB,GAAG,EAAGA,GAAK;MACX,cAAazB,KAAO;MACpBF,WAAW,EAAGA,WAAa;MAC3B4C,KAAK,EAAG/B,OAAS;MACjBgC,QAAQ,EAAKD,KAAK,IACjB/C,aAAa,CAAE;QAAE,CAAEF,YAAY,GAAIiD;MAAM,CAAE,CAC3C;MACDE,aAAa;MACbC,sBAAsB,EAAGA,CAAA,KACxBhD,iBAAiB,CAChB,IAAAiD,mBAAW,EAAE,IAAAC,2BAAmB,EAAC,CAAE,CACpC,CACA;MACD3C,QAAQ,EAAGA,QAAU;MAAA,GAChBM;IAAK,CACV,CACD;EAAA,CACD,CAAC;AAEL","ignoreList":[]}