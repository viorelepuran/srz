{"version":3,"names":["createBlock","addSubmenu","chevronUp","chevronDown","moreVertical","DropdownMenu","MenuItem","MenuGroup","useDispatch","useSelect","__","sprintf","BlockTitle","store","blockEditorStore","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","POPOVER_PROPS","className","placement","BLOCKS_THAT_CAN_BE_CONVERTED_TO_SUBMENU","AddSubmenuItem","block","onClose","expandedState","expand","setInsertedBlock","insertBlock","replaceBlock","replaceInnerBlocks","clientId","isDisabled","includes","name","icon","disabled","onClick","updateSelectionOnInsert","newLink","innerBlocks","length","newSubmenu","attributes","children","LeafMoreMenu","props","moveBlocksDown","moveBlocksUp","removeBlocks","removeLabel","maximumLength","rootClientId","select","getBlockRootClientId","label","popoverProps","noIcons","expanded"],"sources":["@wordpress/block-library/src/navigation/edit/leaf-more-menu.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { createBlock } from '@wordpress/blocks';\nimport {\n\taddSubmenu,\n\tchevronUp,\n\tchevronDown,\n\tmoreVertical,\n} from '@wordpress/icons';\nimport { DropdownMenu, MenuItem, MenuGroup } from '@wordpress/components';\nimport { useDispatch, useSelect } from '@wordpress/data';\nimport { __, sprintf } from '@wordpress/i18n';\nimport { BlockTitle, store as blockEditorStore } from '@wordpress/block-editor';\n\nconst POPOVER_PROPS = {\n\tclassName: 'block-editor-block-settings-menu__popover',\n\tplacement: 'bottom-start',\n};\n\nconst BLOCKS_THAT_CAN_BE_CONVERTED_TO_SUBMENU = [\n\t'core/navigation-link',\n\t'core/navigation-submenu',\n];\n\nfunction AddSubmenuItem( {\n\tblock,\n\tonClose,\n\texpandedState,\n\texpand,\n\tsetInsertedBlock,\n} ) {\n\tconst { insertBlock, replaceBlock, replaceInnerBlocks } =\n\t\tuseDispatch( blockEditorStore );\n\n\tconst clientId = block.clientId;\n\tconst isDisabled = ! BLOCKS_THAT_CAN_BE_CONVERTED_TO_SUBMENU.includes(\n\t\tblock.name\n\t);\n\treturn (\n\t\t<MenuItem\n\t\t\ticon={ addSubmenu }\n\t\t\tdisabled={ isDisabled }\n\t\t\tonClick={ () => {\n\t\t\t\tconst updateSelectionOnInsert = false;\n\t\t\t\tconst newLink = createBlock( 'core/navigation-link' );\n\n\t\t\t\tif ( block.name === 'core/navigation-submenu' ) {\n\t\t\t\t\tinsertBlock(\n\t\t\t\t\t\tnewLink,\n\t\t\t\t\t\tblock.innerBlocks.length,\n\t\t\t\t\t\tclientId,\n\t\t\t\t\t\tupdateSelectionOnInsert\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\t// Convert to a submenu if the block currently isn't one.\n\t\t\t\t\tconst newSubmenu = createBlock(\n\t\t\t\t\t\t'core/navigation-submenu',\n\t\t\t\t\t\tblock.attributes,\n\t\t\t\t\t\tblock.innerBlocks\n\t\t\t\t\t);\n\n\t\t\t\t\t// The following must happen as two independent actions.\n\t\t\t\t\t// Why? Because the offcanvas editor relies on the getLastInsertedBlocksClientIds\n\t\t\t\t\t// selector to determine which block is \"active\". As the UX needs the newLink to be\n\t\t\t\t\t// the \"active\" block it must be the last block to be inserted.\n\t\t\t\t\t// Therefore the Submenu is first created and **then** the newLink is inserted\n\t\t\t\t\t// thus ensuring it is the last inserted block.\n\t\t\t\t\treplaceBlock( clientId, newSubmenu );\n\n\t\t\t\t\treplaceInnerBlocks(\n\t\t\t\t\t\tnewSubmenu.clientId,\n\t\t\t\t\t\t[ newLink ],\n\t\t\t\t\t\tupdateSelectionOnInsert\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// This call sets the local List View state for the \"last inserted block\".\n\t\t\t\t// This is required for the Nav Block to determine whether or not to display\n\t\t\t\t// the Link UI for this new block.\n\t\t\t\tsetInsertedBlock( newLink );\n\n\t\t\t\tif ( ! expandedState[ block.clientId ] ) {\n\t\t\t\t\texpand( block.clientId );\n\t\t\t\t}\n\t\t\t\tonClose();\n\t\t\t} }\n\t\t>\n\t\t\t{ __( 'Add submenu link' ) }\n\t\t</MenuItem>\n\t);\n}\n\nexport default function LeafMoreMenu( props ) {\n\tconst { block } = props;\n\tconst { clientId } = block;\n\n\tconst { moveBlocksDown, moveBlocksUp, removeBlocks } =\n\t\tuseDispatch( blockEditorStore );\n\n\tconst removeLabel = sprintf(\n\t\t/* translators: %s: block name */\n\t\t__( 'Remove %s' ),\n\t\tBlockTitle( { clientId, maximumLength: 25 } )\n\t);\n\n\tconst rootClientId = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getBlockRootClientId } = select( blockEditorStore );\n\n\t\t\treturn getBlockRootClientId( clientId );\n\t\t},\n\t\t[ clientId ]\n\t);\n\n\treturn (\n\t\t<DropdownMenu\n\t\t\ticon={ moreVertical }\n\t\t\tlabel={ __( 'Options' ) }\n\t\t\tclassName=\"block-editor-block-settings-menu\"\n\t\t\tpopoverProps={ POPOVER_PROPS }\n\t\t\tnoIcons\n\t\t\t{ ...props }\n\t\t>\n\t\t\t{ ( { onClose } ) => (\n\t\t\t\t<>\n\t\t\t\t\t<MenuGroup>\n\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\ticon={ chevronUp }\n\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\tmoveBlocksUp( [ clientId ], rootClientId );\n\t\t\t\t\t\t\t\tonClose();\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ __( 'Move up' ) }\n\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\ticon={ chevronDown }\n\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\tmoveBlocksDown( [ clientId ], rootClientId );\n\t\t\t\t\t\t\t\tonClose();\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ __( 'Move down' ) }\n\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t<AddSubmenuItem\n\t\t\t\t\t\t\tblock={ block }\n\t\t\t\t\t\t\tonClose={ onClose }\n\t\t\t\t\t\t\texpanded\n\t\t\t\t\t\t\texpandedState={ props.expandedState }\n\t\t\t\t\t\t\texpand={ props.expand }\n\t\t\t\t\t\t\tsetInsertedBlock={ props.setInsertedBlock }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</MenuGroup>\n\t\t\t\t\t<MenuGroup>\n\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\tremoveBlocks( [ clientId ], false );\n\t\t\t\t\t\t\t\tonClose();\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ removeLabel }\n\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t</MenuGroup>\n\t\t\t\t</>\n\t\t\t) }\n\t\t</DropdownMenu>\n\t);\n}\n"],"mappings":"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","ignoreList":[]}