{"version":3,"names":["Disabled","store","coreStore","useRegistry","useContext","useCallback","__","sprintf","useTemplatePartAreaLabel","DRAFT_MENU_PARAMS","status","per_page","PUBLISHED_MENU_PARAMS","useGenerateDefaultNavigationTitle","clientId","isDisabled","Context","area","undefined","registry","getEntityRecords","resolveSelect","draftNavigationMenus","navigationMenus","Promise","all","title","matchingMenuTitleCount","reduce","count","menu","raw","startsWith","titleWithCount"],"sources":["@wordpress/block-library/src/navigation/edit/use-generate-default-navigation-title.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { Disabled } from '@wordpress/components';\nimport { store as coreStore } from '@wordpress/core-data';\nimport { useRegistry } from '@wordpress/data';\nimport { useContext, useCallback } from '@wordpress/element';\nimport { __, sprintf } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport useTemplatePartAreaLabel from '../use-template-part-area-label';\n\nconst DRAFT_MENU_PARAMS = [\n\t'postType',\n\t'wp_navigation',\n\t{ status: 'draft', per_page: -1 },\n];\n\nconst PUBLISHED_MENU_PARAMS = [\n\t'postType',\n\t'wp_navigation',\n\t{ per_page: -1, status: 'publish' },\n];\n\nexport default function useGenerateDefaultNavigationTitle( clientId ) {\n\t// The block will be disabled in a block preview, use this as a way of\n\t// avoiding the side-effects of this component for block previews.\n\tconst isDisabled = useContext( Disabled.Context );\n\n\t// Because we can't conditionally call hooks, pass an undefined client id\n\t// arg to bypass the expensive `useTemplateArea` code. The hook will return\n\t// early.\n\tconst area = useTemplatePartAreaLabel( isDisabled ? undefined : clientId );\n\n\tconst registry = useRegistry();\n\treturn useCallback( async () => {\n\t\t// Ensure other navigation menus have loaded so an\n\t\t// accurate name can be created.\n\t\tif ( isDisabled ) {\n\t\t\treturn '';\n\t\t}\n\t\tconst { getEntityRecords } = registry.resolveSelect( coreStore );\n\n\t\tconst [ draftNavigationMenus, navigationMenus ] = await Promise.all( [\n\t\t\tgetEntityRecords( ...DRAFT_MENU_PARAMS ),\n\t\t\tgetEntityRecords( ...PUBLISHED_MENU_PARAMS ),\n\t\t] );\n\n\t\tconst title = area\n\t\t\t? sprintf(\n\t\t\t\t\t// translators: %s: the name of a menu (e.g. Header menu).\n\t\t\t\t\t__( '%s menu' ),\n\t\t\t\t\tarea\n\t\t\t  )\n\t\t\t: // translators: 'menu' as in website navigation menu.\n\t\t\t  __( 'Menu' );\n\n\t\t// Determine how many menus start with the automatic title.\n\t\tconst matchingMenuTitleCount = [\n\t\t\t...draftNavigationMenus,\n\t\t\t...navigationMenus,\n\t\t].reduce(\n\t\t\t( count, menu ) =>\n\t\t\t\tmenu?.title?.raw?.startsWith( title ) ? count + 1 : count,\n\t\t\t0\n\t\t);\n\n\t\t// Append a number to the end of the title if a menu with\n\t\t// the same name exists.\n\t\tconst titleWithCount =\n\t\t\tmatchingMenuTitleCount > 0\n\t\t\t\t? `${ title } ${ matchingMenuTitleCount + 1 }`\n\t\t\t\t: title;\n\n\t\treturn titleWithCount || '';\n\t}, [ isDisabled, area, registry ] );\n}\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,QAAQ,QAAQ,uBAAuB;AAChD,SAASC,KAAK,IAAIC,SAAS,QAAQ,sBAAsB;AACzD,SAASC,WAAW,QAAQ,iBAAiB;AAC7C,SAASC,UAAU,EAAEC,WAAW,QAAQ,oBAAoB;AAC5D,SAASC,EAAE,EAAEC,OAAO,QAAQ,iBAAiB;;AAE7C;AACA;AACA;AACA,OAAOC,wBAAwB,MAAM,iCAAiC;AAEtE,MAAMC,iBAAiB,GAAG,CACzB,UAAU,EACV,eAAe,EACf;EAAEC,MAAM,EAAE,OAAO;EAAEC,QAAQ,EAAE,CAAC;AAAE,CAAC,CACjC;AAED,MAAMC,qBAAqB,GAAG,CAC7B,UAAU,EACV,eAAe,EACf;EAAED,QAAQ,EAAE,CAAC,CAAC;EAAED,MAAM,EAAE;AAAU,CAAC,CACnC;AAED,eAAe,SAASG,iCAAiCA,CAAEC,QAAQ,EAAG;EACrE;EACA;EACA,MAAMC,UAAU,GAAGX,UAAU,CAAEJ,QAAQ,CAACgB,OAAQ,CAAC;;EAEjD;EACA;EACA;EACA,MAAMC,IAAI,GAAGT,wBAAwB,CAAEO,UAAU,GAAGG,SAAS,GAAGJ,QAAS,CAAC;EAE1E,MAAMK,QAAQ,GAAGhB,WAAW,CAAC,CAAC;EAC9B,OAAOE,WAAW,CAAE,YAAY;IAC/B;IACA;IACA,IAAKU,UAAU,EAAG;MACjB,OAAO,EAAE;IACV;IACA,MAAM;MAAEK;IAAiB,CAAC,GAAGD,QAAQ,CAACE,aAAa,CAAEnB,SAAU,CAAC;IAEhE,MAAM,CAAEoB,oBAAoB,EAAEC,eAAe,CAAE,GAAG,MAAMC,OAAO,CAACC,GAAG,CAAE,CACpEL,gBAAgB,CAAE,GAAGX,iBAAkB,CAAC,EACxCW,gBAAgB,CAAE,GAAGR,qBAAsB,CAAC,CAC3C,CAAC;IAEH,MAAMc,KAAK,GAAGT,IAAI,GACfV,OAAO;IACP;IACAD,EAAE,CAAE,SAAU,CAAC,EACfW,IACA,CAAC;IACD;IACAX,EAAE,CAAE,MAAO,CAAC;;IAEf;IACA,MAAMqB,sBAAsB,GAAG,CAC9B,GAAGL,oBAAoB,EACvB,GAAGC,eAAe,CAClB,CAACK,MAAM,CACP,CAAEC,KAAK,EAAEC,IAAI,KACZA,IAAI,EAAEJ,KAAK,EAAEK,GAAG,EAAEC,UAAU,CAAEN,KAAM,CAAC,GAAGG,KAAK,GAAG,CAAC,GAAGA,KAAK,EAC1D,CACD,CAAC;;IAED;IACA;IACA,MAAMI,cAAc,GACnBN,sBAAsB,GAAG,CAAC,GACvB,GAAID,KAAK,IAAMC,sBAAsB,GAAG,CAAC,EAAG,GAC5CD,KAAK;IAET,OAAOO,cAAc,IAAI,EAAE;EAC5B,CAAC,EAAE,CAAElB,UAAU,EAAEE,IAAI,EAAEE,QAAQ,CAAG,CAAC;AACpC","ignoreList":[]}