{"version":3,"names":["useDispatch","_x","sprintf","store","noticesStore","useMemo","parse","CreateTemplatePartModalContents","getItemTitle","jsx","_jsx","duplicateTemplatePart","id","label","isEligible","item","type","modalHeader","modalFocusOnMount","RenderModal","items","closeModal","blocks","_item$blocks","content","raw","__unstableSkipMigrationLogs","createSuccessNotice","onTemplatePartSuccess","templatePart","defaultArea","area","defaultTitle","onCreate","onError","confirmLabel"],"sources":["@wordpress/fields/src/actions/duplicate-template-part.tsx"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useDispatch } from '@wordpress/data';\nimport { _x, sprintf } from '@wordpress/i18n';\nimport { store as noticesStore } from '@wordpress/notices';\nimport { useMemo } from '@wordpress/element';\n// @ts-ignore\nimport { parse } from '@wordpress/blocks';\nimport type { Action } from '@wordpress/dataviews';\n\n/**\n * Internal dependencies\n */\nimport type { Post, TemplatePart } from '../types';\nimport { CreateTemplatePartModalContents } from '../components/create-template-part-modal';\nimport { getItemTitle } from './utils';\n\n/**\n * This action is used to duplicate a template part.\n */\nconst duplicateTemplatePart: Action< TemplatePart > = {\n\tid: 'duplicate-template-part',\n\tlabel: _x( 'Duplicate', 'action label' ),\n\tisEligible: ( item ) => item.type === 'wp_template_part',\n\tmodalHeader: _x( 'Duplicate template part', 'action label' ),\n\tmodalFocusOnMount: 'firstContentElement',\n\tRenderModal: ( { items, closeModal } ) => {\n\t\tconst [ item ] = items;\n\t\tconst blocks = useMemo( () => {\n\t\t\treturn (\n\t\t\t\titem.blocks ??\n\t\t\t\tparse(\n\t\t\t\t\ttypeof item.content === 'string'\n\t\t\t\t\t\t? item.content\n\t\t\t\t\t\t: item.content.raw,\n\t\t\t\t\t{\n\t\t\t\t\t\t__unstableSkipMigrationLogs: true,\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}, [ item.content, item.blocks ] );\n\t\tconst { createSuccessNotice } = useDispatch( noticesStore );\n\t\tfunction onTemplatePartSuccess( templatePart: Post ) {\n\t\t\tcreateSuccessNotice(\n\t\t\t\tsprintf(\n\t\t\t\t\t// translators: %s: The new template part's title e.g. 'Call to action (copy)'.\n\t\t\t\t\t_x( '\"%s\" duplicated.', 'template part' ),\n\t\t\t\t\tgetItemTitle( templatePart )\n\t\t\t\t),\n\t\t\t\t{ type: 'snackbar', id: 'edit-site-patterns-success' }\n\t\t\t);\n\t\t\tcloseModal?.();\n\t\t}\n\t\treturn (\n\t\t\t<CreateTemplatePartModalContents\n\t\t\t\tblocks={ blocks }\n\t\t\t\tdefaultArea={ item.area }\n\t\t\t\tdefaultTitle={ sprintf(\n\t\t\t\t\t/* translators: %s: Existing template part title */\n\t\t\t\t\t_x( '%s (Copy)', 'template part' ),\n\t\t\t\t\tgetItemTitle( item )\n\t\t\t\t) }\n\t\t\t\tonCreate={ onTemplatePartSuccess }\n\t\t\t\tonError={ closeModal }\n\t\t\t\tconfirmLabel={ _x( 'Duplicate', 'action label' ) }\n\t\t\t\tcloseModal={ closeModal ?? ( () => {} ) }\n\t\t\t/>\n\t\t);\n\t},\n};\n/**\n * Duplicate action for TemplatePart.\n */\nexport default duplicateTemplatePart;\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,WAAW,QAAQ,iBAAiB;AAC7C,SAASC,EAAE,EAAEC,OAAO,QAAQ,iBAAiB;AAC7C,SAASC,KAAK,IAAIC,YAAY,QAAQ,oBAAoB;AAC1D,SAASC,OAAO,QAAQ,oBAAoB;AAC5C;AACA,SAASC,KAAK,QAAQ,mBAAmB;;AAGzC;AACA;AACA;;AAEA,SAASC,+BAA+B,QAAQ,0CAA0C;AAC1F,SAASC,YAAY,QAAQ,SAAS;;AAEtC;AACA;AACA;AAFA,SAAAC,GAAA,IAAAC,IAAA;AAGA,MAAMC,qBAA6C,GAAG;EACrDC,EAAE,EAAE,yBAAyB;EAC7BC,KAAK,EAAEZ,EAAE,CAAE,WAAW,EAAE,cAAe,CAAC;EACxCa,UAAU,EAAIC,IAAI,IAAMA,IAAI,CAACC,IAAI,KAAK,kBAAkB;EACxDC,WAAW,EAAEhB,EAAE,CAAE,yBAAyB,EAAE,cAAe,CAAC;EAC5DiB,iBAAiB,EAAE,qBAAqB;EACxCC,WAAW,EAAEA,CAAE;IAAEC,KAAK;IAAEC;EAAW,CAAC,KAAM;IACzC,MAAM,CAAEN,IAAI,CAAE,GAAGK,KAAK;IACtB,MAAME,MAAM,GAAGjB,OAAO,CAAE,MAAM;MAAA,IAAAkB,YAAA;MAC7B,QAAAA,YAAA,GACCR,IAAI,CAACO,MAAM,cAAAC,YAAA,cAAAA,YAAA,GACXjB,KAAK,CACJ,OAAOS,IAAI,CAACS,OAAO,KAAK,QAAQ,GAC7BT,IAAI,CAACS,OAAO,GACZT,IAAI,CAACS,OAAO,CAACC,GAAG,EACnB;QACCC,2BAA2B,EAAE;MAC9B,CACD,CAAC;IAEH,CAAC,EAAE,CAAEX,IAAI,CAACS,OAAO,EAAET,IAAI,CAACO,MAAM,CAAG,CAAC;IAClC,MAAM;MAAEK;IAAoB,CAAC,GAAG3B,WAAW,CAAEI,YAAa,CAAC;IAC3D,SAASwB,qBAAqBA,CAAEC,YAAkB,EAAG;MACpDF,mBAAmB,CAClBzB,OAAO;MACN;MACAD,EAAE,CAAE,kBAAkB,EAAE,eAAgB,CAAC,EACzCO,YAAY,CAAEqB,YAAa,CAC5B,CAAC,EACD;QAAEb,IAAI,EAAE,UAAU;QAAEJ,EAAE,EAAE;MAA6B,CACtD,CAAC;MACDS,UAAU,GAAG,CAAC;IACf;IACA,oBACCX,IAAA,CAACH,+BAA+B;MAC/Be,MAAM,EAAGA,MAAQ;MACjBQ,WAAW,EAAGf,IAAI,CAACgB,IAAM;MACzBC,YAAY,EAAG9B,OAAO,CACrB;MACAD,EAAE,CAAE,WAAW,EAAE,eAAgB,CAAC,EAClCO,YAAY,CAAEO,IAAK,CACpB,CAAG;MACHkB,QAAQ,EAAGL,qBAAuB;MAClCM,OAAO,EAAGb,UAAY;MACtBc,YAAY,EAAGlC,EAAE,CAAE,WAAW,EAAE,cAAe,CAAG;MAClDoB,UAAU,EAAGA,UAAU,aAAVA,UAAU,cAAVA,UAAU,GAAM,MAAM,CAAC;IAAK,CACzC,CAAC;EAEJ;AACD,CAAC;AACD;AACA;AACA;AACA,eAAeV,qBAAqB","ignoreList":[]}