{"version":3,"names":["_components","require","_icons","_compose","_data","_element","_notices","_url","_i18n","_utils","_jsxRuntime","SlugEdit","field","onChange","data","id","slug","getValue","item","getSlug","permalinkTemplate","permalink_template","PERMALINK_POSTNAME_REGEX","prefix","suffix","split","permalinkPrefix","permalinkSuffix","isEditable","test","originalSlugRef","useRef","slugToDisplay","current","permalink","safeDecodeURIComponent","link","useEffect","undefined","onChangeControl","useCallback","newValue","createNotice","useDispatch","noticesStore","copyButtonRef","useCopyToClipboard","__","isDismissible","type","postUrlSlugDescriptionId","useInstanceId","jsxs","className","children","__experimentalVStack","spacing","jsx","ExternalLink","href","__experimentalInputControl","__next40pxDefaultSize","__experimentalInputControlPrefixWrapper","Button","icon","copySmall","ref","label","hideLabelFromVision","value","autoComplete","spellCheck","onBlur","_default","exports","default"],"sources":["@wordpress/fields/src/fields/slug/slug-edit.tsx"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport {\n\tButton,\n\tExternalLink,\n\t__experimentalInputControl as InputControl,\n\t__experimentalInputControlPrefixWrapper as InputControlPrefixWrapper,\n\t__experimentalVStack as VStack,\n} from '@wordpress/components';\nimport { copySmall } from '@wordpress/icons';\nimport { useCopyToClipboard, useInstanceId } from '@wordpress/compose';\nimport { useDispatch } from '@wordpress/data';\nimport { useCallback, useEffect, useRef } from '@wordpress/element';\nimport { store as noticesStore } from '@wordpress/notices';\nimport { safeDecodeURIComponent } from '@wordpress/url';\nimport type { DataFormControlProps } from '@wordpress/dataviews';\nimport { __ } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport type { BasePost } from '../../types';\nimport { getSlug } from './utils';\n\nconst SlugEdit = ( {\n\tfield,\n\tonChange,\n\tdata,\n}: DataFormControlProps< BasePost > ) => {\n\tconst { id } = field;\n\n\tconst slug = field.getValue( { item: data } ) || getSlug( data );\n\tconst permalinkTemplate = data.permalink_template || '';\n\tconst PERMALINK_POSTNAME_REGEX = /%(?:postname|pagename)%/;\n\tconst [ prefix, suffix ] = permalinkTemplate.split(\n\t\tPERMALINK_POSTNAME_REGEX\n\t);\n\tconst permalinkPrefix = prefix;\n\tconst permalinkSuffix = suffix;\n\tconst isEditable = PERMALINK_POSTNAME_REGEX.test( permalinkTemplate );\n\tconst originalSlugRef = useRef( slug );\n\tconst slugToDisplay = slug || originalSlugRef.current;\n\tconst permalink = isEditable\n\t\t? `${ permalinkPrefix }${ slugToDisplay }${ permalinkSuffix }`\n\t\t: safeDecodeURIComponent( data.link || '' );\n\n\tuseEffect( () => {\n\t\tif ( slug && originalSlugRef.current === undefined ) {\n\t\t\toriginalSlugRef.current = slug;\n\t\t}\n\t}, [ slug ] );\n\n\tconst onChangeControl = useCallback(\n\t\t( newValue?: string ) =>\n\t\t\tonChange( {\n\t\t\t\t[ id ]: newValue,\n\t\t\t} ),\n\t\t[ id, onChange ]\n\t);\n\n\tconst { createNotice } = useDispatch( noticesStore );\n\n\tconst copyButtonRef = useCopyToClipboard( permalink, () => {\n\t\tcreateNotice( 'info', __( 'Copied Permalink to clipboard.' ), {\n\t\t\tisDismissible: true,\n\t\t\ttype: 'snackbar',\n\t\t} );\n\t} );\n\n\tconst postUrlSlugDescriptionId =\n\t\t'editor-post-url__slug-description-' + useInstanceId( SlugEdit );\n\n\treturn (\n\t\t<fieldset className=\"fields-controls__slug\">\n\t\t\t{ isEditable && (\n\t\t\t\t<VStack>\n\t\t\t\t\t<VStack spacing=\"0px\">\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t{ __(\n\t\t\t\t\t\t\t\t'Customize the last part of the Permalink.'\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<ExternalLink href=\"https://wordpress.org/documentation/article/page-post-settings-sidebar/#permalink\">\n\t\t\t\t\t\t\t{ __( 'Learn more' ) }\n\t\t\t\t\t\t</ExternalLink>\n\t\t\t\t\t</VStack>\n\t\t\t\t\t<InputControl\n\t\t\t\t\t\t__next40pxDefaultSize\n\t\t\t\t\t\tprefix={\n\t\t\t\t\t\t\t<InputControlPrefixWrapper>\n\t\t\t\t\t\t\t\t/\n\t\t\t\t\t\t\t</InputControlPrefixWrapper>\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsuffix={\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t__next40pxDefaultSize\n\t\t\t\t\t\t\t\ticon={ copySmall }\n\t\t\t\t\t\t\t\tref={ copyButtonRef }\n\t\t\t\t\t\t\t\tlabel={ __( 'Copy' ) }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlabel={ __( 'Link' ) }\n\t\t\t\t\t\thideLabelFromVision\n\t\t\t\t\t\tvalue={ slug }\n\t\t\t\t\t\tautoComplete=\"off\"\n\t\t\t\t\t\tspellCheck=\"false\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tclassName=\"fields-controls__slug-input\"\n\t\t\t\t\t\tonChange={ ( newValue?: string ) => {\n\t\t\t\t\t\t\tonChangeControl( newValue );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tonBlur={ () => {\n\t\t\t\t\t\t\tif ( slug === '' ) {\n\t\t\t\t\t\t\t\tonChangeControl( originalSlugRef.current );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} }\n\t\t\t\t\t\taria-describedby={ postUrlSlugDescriptionId }\n\t\t\t\t\t/>\n\t\t\t\t\t<div className=\"fields-controls__slug-help\">\n\t\t\t\t\t\t<span className=\"fields-controls__slug-help-visual-label\">\n\t\t\t\t\t\t\t{ __( 'Permalink:' ) }\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<ExternalLink\n\t\t\t\t\t\t\tclassName=\"fields-controls__slug-help-link\"\n\t\t\t\t\t\t\thref={ permalink }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span className=\"fields-controls__slug-help-prefix\">\n\t\t\t\t\t\t\t\t{ permalinkPrefix }\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span className=\"fields-controls__slug-help-slug\">\n\t\t\t\t\t\t\t\t{ slugToDisplay }\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span className=\"fields-controls__slug-help-suffix\">\n\t\t\t\t\t\t\t\t{ permalinkSuffix }\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</ExternalLink>\n\t\t\t\t\t</div>\n\t\t\t\t</VStack>\n\t\t\t) }\n\t\t\t{ ! isEditable && (\n\t\t\t\t<ExternalLink\n\t\t\t\t\tclassName=\"fields-controls__slug-help\"\n\t\t\t\t\thref={ permalink }\n\t\t\t\t>\n\t\t\t\t\t{ permalink }\n\t\t\t\t</ExternalLink>\n\t\t\t) }\n\t\t</fieldset>\n\t);\n};\n\nexport default SlugEdit;\n"],"mappings":"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","ignoreList":[]}