{"version":3,"names":["__","sprintf","useMemo","Button","__experimentalText","Text","__experimentalHStack","HStack","__experimentalVStack","VStack","useDispatch","useSelect","store","coreStore","noticesStore","getItemTitle","jsx","_jsx","jsxs","_jsxs","SetAsHomepageModal","items","closeModal","item","pageTitle","showOnFront","currentHomePage","isSaving","select","getEntityRecord","isSavingEntityRecord","siteSettings","currentHomePageItem","page_on_front","show_on_front","saveEntityRecord","createSuccessNotice","createErrorNotice","onSetPageAsHomepage","event","preventDefault","id","type","error","errorMessage","message","code","modalWarning","modalText","trim","modalButtonLabel","onSubmit","children","spacing","justify","__next40pxDefaultSize","variant","onClick","disabled","accessibleWhenDisabled","useSetAsHomepageAction","pageOnFront","pageForPosts","canUser","kind","name","undefined","page_for_posts","label","isEligible","post","status","modalFocusOnMount","RenderModal"],"sources":["@wordpress/editor/src/components/post-actions/set-as-homepage.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { __, sprintf } from '@wordpress/i18n';\nimport { useMemo } from '@wordpress/element';\nimport {\n\tButton,\n\t__experimentalText as Text,\n\t__experimentalHStack as HStack,\n\t__experimentalVStack as VStack,\n} from '@wordpress/components';\nimport { useDispatch, useSelect } from '@wordpress/data';\nimport { store as coreStore } from '@wordpress/core-data';\nimport { store as noticesStore } from '@wordpress/notices';\n\n/**\n * Internal dependencies\n */\nimport { getItemTitle } from '../../utils/get-item-title';\n\nconst SetAsHomepageModal = ( { items, closeModal } ) => {\n\tconst [ item ] = items;\n\tconst pageTitle = getItemTitle( item );\n\tconst { showOnFront, currentHomePage, isSaving } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getEntityRecord, isSavingEntityRecord } =\n\t\t\t\tselect( coreStore );\n\t\t\tconst siteSettings = getEntityRecord( 'root', 'site' );\n\t\t\tconst currentHomePageItem = getEntityRecord(\n\t\t\t\t'postType',\n\t\t\t\t'page',\n\t\t\t\tsiteSettings?.page_on_front\n\t\t\t);\n\t\t\treturn {\n\t\t\t\tshowOnFront: siteSettings?.show_on_front,\n\t\t\t\tcurrentHomePage: currentHomePageItem,\n\t\t\t\tisSaving: isSavingEntityRecord( 'root', 'site' ),\n\t\t\t};\n\t\t}\n\t);\n\n\tconst { saveEntityRecord } = useDispatch( coreStore );\n\tconst { createSuccessNotice, createErrorNotice } =\n\t\tuseDispatch( noticesStore );\n\n\tasync function onSetPageAsHomepage( event ) {\n\t\tevent.preventDefault();\n\n\t\ttry {\n\t\t\tawait saveEntityRecord( 'root', 'site', {\n\t\t\t\tpage_on_front: item.id,\n\t\t\t\tshow_on_front: 'page',\n\t\t\t} );\n\n\t\t\tcreateSuccessNotice( __( 'Homepage updated.' ), {\n\t\t\t\ttype: 'snackbar',\n\t\t\t} );\n\t\t} catch ( error ) {\n\t\t\tconst errorMessage =\n\t\t\t\terror.message && error.code !== 'unknown_error'\n\t\t\t\t\t? error.message\n\t\t\t\t\t: __( 'An error occurred while setting the homepage.' );\n\t\t\tcreateErrorNotice( errorMessage, { type: 'snackbar' } );\n\t\t} finally {\n\t\t\tcloseModal?.();\n\t\t}\n\t}\n\n\tlet modalWarning = '';\n\tif ( 'posts' === showOnFront ) {\n\t\tmodalWarning = __(\n\t\t\t'This will replace the current homepage which is set to display latest posts.'\n\t\t);\n\t} else if ( currentHomePage ) {\n\t\tmodalWarning = sprintf(\n\t\t\t// translators: %s: title of the current home page.\n\t\t\t__( 'This will replace the current homepage: \"%s\"' ),\n\t\t\tgetItemTitle( currentHomePage )\n\t\t);\n\t}\n\n\tconst modalText = sprintf(\n\t\t// translators: %1$s: title of the page to be set as the homepage, %2$s: homepage replacement warning message.\n\t\t__( 'Set \"%1$s\" as the site homepage? %2$s' ),\n\t\tpageTitle,\n\t\tmodalWarning\n\t).trim();\n\n\t// translators: Button label to confirm setting the specified page as the homepage.\n\tconst modalButtonLabel = __( 'Set homepage' );\n\n\treturn (\n\t\t<form onSubmit={ onSetPageAsHomepage }>\n\t\t\t<VStack spacing=\"5\">\n\t\t\t\t<Text>{ modalText }</Text>\n\t\t\t\t<HStack justify=\"right\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\t__next40pxDefaultSize\n\t\t\t\t\t\tvariant=\"tertiary\"\n\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\tcloseModal?.();\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tdisabled={ isSaving }\n\t\t\t\t\t\taccessibleWhenDisabled\n\t\t\t\t\t>\n\t\t\t\t\t\t{ __( 'Cancel' ) }\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\t__next40pxDefaultSize\n\t\t\t\t\t\tvariant=\"primary\"\n\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\tdisabled={ isSaving }\n\t\t\t\t\t\taccessibleWhenDisabled\n\t\t\t\t\t>\n\t\t\t\t\t\t{ modalButtonLabel }\n\t\t\t\t\t</Button>\n\t\t\t\t</HStack>\n\t\t\t</VStack>\n\t\t</form>\n\t);\n};\n\nexport const useSetAsHomepageAction = () => {\n\tconst { pageOnFront, pageForPosts } = useSelect( ( select ) => {\n\t\tconst { getEntityRecord, canUser } = select( coreStore );\n\t\tconst siteSettings = canUser( 'read', {\n\t\t\tkind: 'root',\n\t\t\tname: 'site',\n\t\t} )\n\t\t\t? getEntityRecord( 'root', 'site' )\n\t\t\t: undefined;\n\t\treturn {\n\t\t\tpageOnFront: siteSettings?.page_on_front,\n\t\t\tpageForPosts: siteSettings?.page_for_posts,\n\t\t};\n\t} );\n\n\treturn useMemo(\n\t\t() => ( {\n\t\t\tid: 'set-as-homepage',\n\t\t\tlabel: __( 'Set as homepage' ),\n\t\t\tisEligible( post ) {\n\t\t\t\tif ( post.status !== 'publish' ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif ( post.type !== 'page' ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// Don't show the action if the page is already set as the homepage.\n\t\t\t\tif ( pageOnFront === post.id ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// Don't show the action if the page is already set as the page for posts.\n\t\t\t\tif ( pageForPosts === post.id ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tmodalFocusOnMount: 'firstContentElement',\n\t\t\tRenderModal: SetAsHomepageModal,\n\t\t} ),\n\t\t[ pageForPosts, pageOnFront ]\n\t);\n};\n"],"mappings":"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","ignoreList":[]}