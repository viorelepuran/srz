{"version":3,"names":["__","sprintf","useMemo","Button","__experimentalText","Text","__experimentalHStack","HStack","__experimentalVStack","VStack","useDispatch","useSelect","store","coreStore","noticesStore","getItemTitle","jsx","_jsx","jsxs","_jsxs","SetAsPostsPageModal","items","closeModal","item","pageTitle","currentPostsPage","isPageForPostsSet","isSaving","select","getEntityRecord","isSavingEntityRecord","siteSettings","currentPostsPageItem","page_for_posts","saveEntityRecord","createSuccessNotice","createErrorNotice","onSetPageAsPostsPage","event","preventDefault","id","show_on_front","type","error","errorMessage","message","code","modalWarning","modalText","modalButtonLabel","onSubmit","children","spacing","justify","__next40pxDefaultSize","variant","onClick","disabled","accessibleWhenDisabled","useSetAsPostsPageAction","pageOnFront","pageForPosts","canUser","kind","name","undefined","page_on_front","label","isEligible","post","status","modalFocusOnMount","RenderModal"],"sources":["@wordpress/editor/src/components/post-actions/set-as-posts-page.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { __, sprintf } from '@wordpress/i18n';\nimport { useMemo } from '@wordpress/element';\nimport {\n\tButton,\n\t__experimentalText as Text,\n\t__experimentalHStack as HStack,\n\t__experimentalVStack as VStack,\n} from '@wordpress/components';\nimport { useDispatch, useSelect } from '@wordpress/data';\nimport { store as coreStore } from '@wordpress/core-data';\nimport { store as noticesStore } from '@wordpress/notices';\n\n/**\n * Internal dependencies\n */\nimport { getItemTitle } from '../../utils/get-item-title';\n\nconst SetAsPostsPageModal = ( { items, closeModal } ) => {\n\tconst [ item ] = items;\n\tconst pageTitle = getItemTitle( item );\n\tconst { currentPostsPage, isPageForPostsSet, isSaving } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getEntityRecord, isSavingEntityRecord } =\n\t\t\t\tselect( coreStore );\n\t\t\tconst siteSettings = getEntityRecord( 'root', 'site' );\n\t\t\tconst currentPostsPageItem = getEntityRecord(\n\t\t\t\t'postType',\n\t\t\t\t'page',\n\t\t\t\tsiteSettings?.page_for_posts\n\t\t\t);\n\t\t\treturn {\n\t\t\t\tcurrentPostsPage: currentPostsPageItem,\n\t\t\t\tisPageForPostsSet: siteSettings?.page_for_posts !== 0,\n\t\t\t\tisSaving: isSavingEntityRecord( 'root', 'site' ),\n\t\t\t};\n\t\t}\n\t);\n\n\tconst { saveEntityRecord } = useDispatch( coreStore );\n\tconst { createSuccessNotice, createErrorNotice } =\n\t\tuseDispatch( noticesStore );\n\n\tasync function onSetPageAsPostsPage( event ) {\n\t\tevent.preventDefault();\n\n\t\ttry {\n\t\t\tawait saveEntityRecord( 'root', 'site', {\n\t\t\t\tpage_for_posts: item.id,\n\t\t\t\tshow_on_front: 'page',\n\t\t\t} );\n\n\t\t\tcreateSuccessNotice( __( 'Posts page updated.' ), {\n\t\t\t\ttype: 'snackbar',\n\t\t\t} );\n\t\t} catch ( error ) {\n\t\t\tconst errorMessage =\n\t\t\t\terror.message && error.code !== 'unknown_error'\n\t\t\t\t\t? error.message\n\t\t\t\t\t: __( 'An error occurred while setting the posts page.' );\n\t\t\tcreateErrorNotice( errorMessage, { type: 'snackbar' } );\n\t\t} finally {\n\t\t\tcloseModal?.();\n\t\t}\n\t}\n\n\tconst modalWarning =\n\t\tisPageForPostsSet && currentPostsPage\n\t\t\t? sprintf(\n\t\t\t\t\t// translators: %s: title of the current posts page.\n\t\t\t\t\t__( 'This will replace the current posts page: \"%s\"' ),\n\t\t\t\t\tgetItemTitle( currentPostsPage )\n\t\t\t  )\n\t\t\t: __( 'This page will show the latest posts.' );\n\n\tconst modalText = sprintf(\n\t\t// translators: %1$s: title of the page to be set as the posts page, %2$s: posts page replacement warning message.\n\t\t__( 'Set \"%1$s\" as the posts page? %2$s' ),\n\t\tpageTitle,\n\t\tmodalWarning\n\t);\n\n\t// translators: Button label to confirm setting the specified page as the posts page.\n\tconst modalButtonLabel = __( 'Set posts page' );\n\n\treturn (\n\t\t<form onSubmit={ onSetPageAsPostsPage }>\n\t\t\t<VStack spacing=\"5\">\n\t\t\t\t<Text>{ modalText }</Text>\n\t\t\t\t<HStack justify=\"right\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\t__next40pxDefaultSize\n\t\t\t\t\t\tvariant=\"tertiary\"\n\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\tcloseModal?.();\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tdisabled={ isSaving }\n\t\t\t\t\t\taccessibleWhenDisabled\n\t\t\t\t\t>\n\t\t\t\t\t\t{ __( 'Cancel' ) }\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\t__next40pxDefaultSize\n\t\t\t\t\t\tvariant=\"primary\"\n\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\tdisabled={ isSaving }\n\t\t\t\t\t\taccessibleWhenDisabled\n\t\t\t\t\t>\n\t\t\t\t\t\t{ modalButtonLabel }\n\t\t\t\t\t</Button>\n\t\t\t\t</HStack>\n\t\t\t</VStack>\n\t\t</form>\n\t);\n};\n\nexport const useSetAsPostsPageAction = () => {\n\tconst { pageOnFront, pageForPosts } = useSelect( ( select ) => {\n\t\tconst { getEntityRecord, canUser } = select( coreStore );\n\t\tconst siteSettings = canUser( 'read', {\n\t\t\tkind: 'root',\n\t\t\tname: 'site',\n\t\t} )\n\t\t\t? getEntityRecord( 'root', 'site' )\n\t\t\t: undefined;\n\n\t\treturn {\n\t\t\tpageOnFront: siteSettings?.page_on_front,\n\t\t\tpageForPosts: siteSettings?.page_for_posts,\n\t\t};\n\t} );\n\n\treturn useMemo(\n\t\t() => ( {\n\t\t\tid: 'set-as-posts-page',\n\t\t\tlabel: __( 'Set as posts page' ),\n\t\t\tisEligible( post ) {\n\t\t\t\tif ( post.status !== 'publish' ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif ( post.type !== 'page' ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// Don't show the action if the page is already set as the homepage.\n\t\t\t\tif ( pageOnFront === post.id ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// Don't show the action if the page is already set as the page for posts.\n\t\t\t\tif ( pageForPosts === post.id ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tmodalFocusOnMount: 'firstContentElement',\n\t\t\tRenderModal: SetAsPostsPageModal,\n\t\t} ),\n\t\t[ pageForPosts, pageOnFront ]\n\t);\n};\n"],"mappings":"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","ignoreList":[]}