{"version":3,"names":["_data","require","_htmlEntities","_components","_element","_i18n","_coreData","_icons","_notices","_preferences","_postPanelRow","_interopRequireDefault","_store","_swapTemplateButton","_resetDefaultTemplate","_lockUnlock","_createNewTemplate","_jsxRuntime","BlockThemeControl","id","isTemplateHidden","onNavigateToEntityRecord","getEditorSettings","hasGoBack","useSelect","select","getRenderingMode","_getEditorSettings","unlock","editorStore","editorSettings","hasOwnProperty","get","getPreference","preferencesStore","editedRecord","template","hasResolved","useEntityRecord","createSuccessNotice","useDispatch","noticesStore","setRenderingMode","setDefaultRenderingMode","canCreateTemplate","coreStore","canUser","kind","name","popoverAnchor","setPopoverAnchor","useState","popoverProps","useMemo","anchor","className","placement","offset","shift","notificationAction","label","__","onClick","onNavigateToPreviousEntityRecord","undefined","mayShowTemplateEditNotice","type","actions","jsx","default","ref","children","DropdownMenu","focusOnMount","toggleProps","size","variant","tooltipPosition","text","decodeEntities","title","icon","onClose","jsxs","Fragment","MenuGroup","MenuItem","postId","postType","check","isSelected","role","newRenderingMode"],"sources":["@wordpress/editor/src/components/post-template/block-theme.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { decodeEntities } from '@wordpress/html-entities';\nimport { DropdownMenu, MenuGroup, MenuItem } from '@wordpress/components';\nimport { useState, useMemo } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport { useEntityRecord, store as coreStore } from '@wordpress/core-data';\nimport { check } from '@wordpress/icons';\nimport { store as noticesStore } from '@wordpress/notices';\nimport { store as preferencesStore } from '@wordpress/preferences';\n\n/**\n * Internal dependencies\n */\nimport PostPanelRow from '../post-panel-row';\n\n/**\n * Internal dependencies\n */\nimport { store as editorStore } from '../../store';\nimport SwapTemplateButton from './swap-template-button';\nimport ResetDefaultTemplate from './reset-default-template';\nimport { unlock } from '../../lock-unlock';\nimport CreateNewTemplate from './create-new-template';\n\nexport default function BlockThemeControl( { id } ) {\n\tconst {\n\t\tisTemplateHidden,\n\t\tonNavigateToEntityRecord,\n\t\tgetEditorSettings,\n\t\thasGoBack,\n\t} = useSelect( ( select ) => {\n\t\tconst { getRenderingMode, getEditorSettings: _getEditorSettings } =\n\t\t\tunlock( select( editorStore ) );\n\t\tconst editorSettings = _getEditorSettings();\n\t\treturn {\n\t\t\tisTemplateHidden: getRenderingMode() === 'post-only',\n\t\t\tonNavigateToEntityRecord: editorSettings.onNavigateToEntityRecord,\n\t\t\tgetEditorSettings: _getEditorSettings,\n\t\t\thasGoBack: editorSettings.hasOwnProperty(\n\t\t\t\t'onNavigateToPreviousEntityRecord'\n\t\t\t),\n\t\t};\n\t}, [] );\n\n\tconst { get: getPreference } = useSelect( preferencesStore );\n\n\tconst { editedRecord: template, hasResolved } = useEntityRecord(\n\t\t'postType',\n\t\t'wp_template',\n\t\tid\n\t);\n\tconst { createSuccessNotice } = useDispatch( noticesStore );\n\tconst { setRenderingMode, setDefaultRenderingMode } = unlock(\n\t\tuseDispatch( editorStore )\n\t);\n\n\tconst canCreateTemplate = useSelect(\n\t\t( select ) =>\n\t\t\t!! select( coreStore ).canUser( 'create', {\n\t\t\t\tkind: 'postType',\n\t\t\t\tname: 'wp_template',\n\t\t\t} ),\n\t\t[]\n\t);\n\n\tconst [ popoverAnchor, setPopoverAnchor ] = useState( null );\n\t// Memoize popoverProps to avoid returning a new object every time.\n\tconst popoverProps = useMemo(\n\t\t() => ( {\n\t\t\t// Anchor the popover to the middle of the entire row so that it doesn't\n\t\t\t// move around when the label changes.\n\t\t\tanchor: popoverAnchor,\n\t\t\tclassName: 'editor-post-template__dropdown',\n\t\t\tplacement: 'left-start',\n\t\t\toffset: 36,\n\t\t\tshift: true,\n\t\t} ),\n\t\t[ popoverAnchor ]\n\t);\n\n\tif ( ! hasResolved ) {\n\t\treturn null;\n\t}\n\n\t// The site editor does not have a `onNavigateToPreviousEntityRecord` setting as it uses its own routing\n\t// and assigns its own backlink to focusMode pages.\n\tconst notificationAction = hasGoBack\n\t\t? [\n\t\t\t\t{\n\t\t\t\t\tlabel: __( 'Go back' ),\n\t\t\t\t\tonClick: () =>\n\t\t\t\t\t\tgetEditorSettings().onNavigateToPreviousEntityRecord(),\n\t\t\t\t},\n\t\t  ]\n\t\t: undefined;\n\n\tconst mayShowTemplateEditNotice = () => {\n\t\tif ( ! getPreference( 'core/edit-site', 'welcomeGuideTemplate' ) ) {\n\t\t\tcreateSuccessNotice(\n\t\t\t\t__(\n\t\t\t\t\t'Editing template. Changes made here affect all posts and pages that use the template.'\n\t\t\t\t),\n\t\t\t\t{ type: 'snackbar', actions: notificationAction }\n\t\t\t);\n\t\t}\n\t};\n\treturn (\n\t\t<PostPanelRow label={ __( 'Template' ) } ref={ setPopoverAnchor }>\n\t\t\t<DropdownMenu\n\t\t\t\tpopoverProps={ popoverProps }\n\t\t\t\tfocusOnMount\n\t\t\t\ttoggleProps={ {\n\t\t\t\t\tsize: 'compact',\n\t\t\t\t\tvariant: 'tertiary',\n\t\t\t\t\ttooltipPosition: 'middle left',\n\t\t\t\t} }\n\t\t\t\tlabel={ __( 'Template options' ) }\n\t\t\t\ttext={ decodeEntities( template.title ) }\n\t\t\t\ticon={ null }\n\t\t\t>\n\t\t\t\t{ ( { onClose } ) => (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<MenuGroup>\n\t\t\t\t\t\t\t{ canCreateTemplate && (\n\t\t\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\t\t\tonNavigateToEntityRecord( {\n\t\t\t\t\t\t\t\t\t\t\tpostId: template.id,\n\t\t\t\t\t\t\t\t\t\t\tpostType: 'wp_template',\n\t\t\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\t\t\tonClose();\n\t\t\t\t\t\t\t\t\t\tmayShowTemplateEditNotice();\n\t\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{ __( 'Edit template' ) }\n\t\t\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t\t) }\n\n\t\t\t\t\t\t\t<SwapTemplateButton onClick={ onClose } />\n\t\t\t\t\t\t\t<ResetDefaultTemplate onClick={ onClose } />\n\t\t\t\t\t\t\t{ canCreateTemplate && <CreateNewTemplate /> }\n\t\t\t\t\t\t</MenuGroup>\n\t\t\t\t\t\t<MenuGroup>\n\t\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\t\ticon={ ! isTemplateHidden ? check : undefined }\n\t\t\t\t\t\t\t\tisSelected={ ! isTemplateHidden }\n\t\t\t\t\t\t\t\trole=\"menuitemcheckbox\"\n\t\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\t\tconst newRenderingMode = isTemplateHidden\n\t\t\t\t\t\t\t\t\t\t? 'template-locked'\n\t\t\t\t\t\t\t\t\t\t: 'post-only';\n\t\t\t\t\t\t\t\t\tsetRenderingMode( newRenderingMode );\n\t\t\t\t\t\t\t\t\tsetDefaultRenderingMode( newRenderingMode );\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ __( 'Show template' ) }\n\t\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t</MenuGroup>\n\t\t\t\t\t</>\n\t\t\t\t) }\n\t\t\t</DropdownMenu>\n\t\t</PostPanelRow>\n\t);\n}\n"],"mappings":"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","ignoreList":[]}