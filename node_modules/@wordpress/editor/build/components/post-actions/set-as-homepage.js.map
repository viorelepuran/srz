{"version":3,"names":["_i18n","require","_element","_components","_data","_coreData","_notices","_getItemTitle","_jsxRuntime","SetAsHomepageModal","items","closeModal","item","pageTitle","getItemTitle","showOnFront","currentHomePage","isSaving","useSelect","select","getEntityRecord","isSavingEntityRecord","coreStore","siteSettings","currentHomePageItem","page_on_front","show_on_front","saveEntityRecord","useDispatch","createSuccessNotice","createErrorNotice","noticesStore","onSetPageAsHomepage","event","preventDefault","id","__","type","error","errorMessage","message","code","modalWarning","sprintf","modalText","trim","modalButtonLabel","jsx","onSubmit","children","jsxs","__experimentalVStack","spacing","__experimentalText","__experimentalHStack","justify","Button","__next40pxDefaultSize","variant","onClick","disabled","accessibleWhenDisabled","useSetAsHomepageAction","pageOnFront","pageForPosts","canUser","kind","name","undefined","page_for_posts","useMemo","label","isEligible","post","status","modalFocusOnMount","RenderModal","exports"],"sources":["@wordpress/editor/src/components/post-actions/set-as-homepage.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { __, sprintf } from '@wordpress/i18n';\nimport { useMemo } from '@wordpress/element';\nimport {\n\tButton,\n\t__experimentalText as Text,\n\t__experimentalHStack as HStack,\n\t__experimentalVStack as VStack,\n} from '@wordpress/components';\nimport { useDispatch, useSelect } from '@wordpress/data';\nimport { store as coreStore } from '@wordpress/core-data';\nimport { store as noticesStore } from '@wordpress/notices';\n\n/**\n * Internal dependencies\n */\nimport { getItemTitle } from '../../utils/get-item-title';\n\nconst SetAsHomepageModal = ( { items, closeModal } ) => {\n\tconst [ item ] = items;\n\tconst pageTitle = getItemTitle( item );\n\tconst { showOnFront, currentHomePage, isSaving } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getEntityRecord, isSavingEntityRecord } =\n\t\t\t\tselect( coreStore );\n\t\t\tconst siteSettings = getEntityRecord( 'root', 'site' );\n\t\t\tconst currentHomePageItem = getEntityRecord(\n\t\t\t\t'postType',\n\t\t\t\t'page',\n\t\t\t\tsiteSettings?.page_on_front\n\t\t\t);\n\t\t\treturn {\n\t\t\t\tshowOnFront: siteSettings?.show_on_front,\n\t\t\t\tcurrentHomePage: currentHomePageItem,\n\t\t\t\tisSaving: isSavingEntityRecord( 'root', 'site' ),\n\t\t\t};\n\t\t}\n\t);\n\n\tconst { saveEntityRecord } = useDispatch( coreStore );\n\tconst { createSuccessNotice, createErrorNotice } =\n\t\tuseDispatch( noticesStore );\n\n\tasync function onSetPageAsHomepage( event ) {\n\t\tevent.preventDefault();\n\n\t\ttry {\n\t\t\tawait saveEntityRecord( 'root', 'site', {\n\t\t\t\tpage_on_front: item.id,\n\t\t\t\tshow_on_front: 'page',\n\t\t\t} );\n\n\t\t\tcreateSuccessNotice( __( 'Homepage updated.' ), {\n\t\t\t\ttype: 'snackbar',\n\t\t\t} );\n\t\t} catch ( error ) {\n\t\t\tconst errorMessage =\n\t\t\t\terror.message && error.code !== 'unknown_error'\n\t\t\t\t\t? error.message\n\t\t\t\t\t: __( 'An error occurred while setting the homepage.' );\n\t\t\tcreateErrorNotice( errorMessage, { type: 'snackbar' } );\n\t\t} finally {\n\t\t\tcloseModal?.();\n\t\t}\n\t}\n\n\tlet modalWarning = '';\n\tif ( 'posts' === showOnFront ) {\n\t\tmodalWarning = __(\n\t\t\t'This will replace the current homepage which is set to display latest posts.'\n\t\t);\n\t} else if ( currentHomePage ) {\n\t\tmodalWarning = sprintf(\n\t\t\t// translators: %s: title of the current home page.\n\t\t\t__( 'This will replace the current homepage: \"%s\"' ),\n\t\t\tgetItemTitle( currentHomePage )\n\t\t);\n\t}\n\n\tconst modalText = sprintf(\n\t\t// translators: %1$s: title of the page to be set as the homepage, %2$s: homepage replacement warning message.\n\t\t__( 'Set \"%1$s\" as the site homepage? %2$s' ),\n\t\tpageTitle,\n\t\tmodalWarning\n\t).trim();\n\n\t// translators: Button label to confirm setting the specified page as the homepage.\n\tconst modalButtonLabel = __( 'Set homepage' );\n\n\treturn (\n\t\t<form onSubmit={ onSetPageAsHomepage }>\n\t\t\t<VStack spacing=\"5\">\n\t\t\t\t<Text>{ modalText }</Text>\n\t\t\t\t<HStack justify=\"right\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\t__next40pxDefaultSize\n\t\t\t\t\t\tvariant=\"tertiary\"\n\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\tcloseModal?.();\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tdisabled={ isSaving }\n\t\t\t\t\t\taccessibleWhenDisabled\n\t\t\t\t\t>\n\t\t\t\t\t\t{ __( 'Cancel' ) }\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\t__next40pxDefaultSize\n\t\t\t\t\t\tvariant=\"primary\"\n\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\tdisabled={ isSaving }\n\t\t\t\t\t\taccessibleWhenDisabled\n\t\t\t\t\t>\n\t\t\t\t\t\t{ modalButtonLabel }\n\t\t\t\t\t</Button>\n\t\t\t\t</HStack>\n\t\t\t</VStack>\n\t\t</form>\n\t);\n};\n\nexport const useSetAsHomepageAction = () => {\n\tconst { pageOnFront, pageForPosts } = useSelect( ( select ) => {\n\t\tconst { getEntityRecord, canUser } = select( coreStore );\n\t\tconst siteSettings = canUser( 'read', {\n\t\t\tkind: 'root',\n\t\t\tname: 'site',\n\t\t} )\n\t\t\t? getEntityRecord( 'root', 'site' )\n\t\t\t: undefined;\n\t\treturn {\n\t\t\tpageOnFront: siteSettings?.page_on_front,\n\t\t\tpageForPosts: siteSettings?.page_for_posts,\n\t\t};\n\t} );\n\n\treturn useMemo(\n\t\t() => ( {\n\t\t\tid: 'set-as-homepage',\n\t\t\tlabel: __( 'Set as homepage' ),\n\t\t\tisEligible( post ) {\n\t\t\t\tif ( post.status !== 'publish' ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif ( post.type !== 'page' ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// Don't show the action if the page is already set as the homepage.\n\t\t\t\tif ( pageOnFront === post.id ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// Don't show the action if the page is already set as the page for posts.\n\t\t\t\tif ( pageForPosts === post.id ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tmodalFocusOnMount: 'firstContentElement',\n\t\t\tRenderModal: SetAsHomepageModal,\n\t\t} ),\n\t\t[ pageForPosts, pageOnFront ]\n\t);\n};\n"],"mappings":"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","ignoreList":[]}