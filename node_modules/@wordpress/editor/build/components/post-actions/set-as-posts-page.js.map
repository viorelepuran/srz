{"version":3,"names":["_i18n","require","_element","_components","_data","_coreData","_notices","_getItemTitle","_jsxRuntime","SetAsPostsPageModal","items","closeModal","item","pageTitle","getItemTitle","currentPostsPage","isPageForPostsSet","isSaving","useSelect","select","getEntityRecord","isSavingEntityRecord","coreStore","siteSettings","currentPostsPageItem","page_for_posts","saveEntityRecord","useDispatch","createSuccessNotice","createErrorNotice","noticesStore","onSetPageAsPostsPage","event","preventDefault","id","show_on_front","__","type","error","errorMessage","message","code","modalWarning","sprintf","modalText","modalButtonLabel","jsx","onSubmit","children","jsxs","__experimentalVStack","spacing","__experimentalText","__experimentalHStack","justify","Button","__next40pxDefaultSize","variant","onClick","disabled","accessibleWhenDisabled","useSetAsPostsPageAction","pageOnFront","pageForPosts","canUser","kind","name","undefined","page_on_front","useMemo","label","isEligible","post","status","modalFocusOnMount","RenderModal","exports"],"sources":["@wordpress/editor/src/components/post-actions/set-as-posts-page.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { __, sprintf } from '@wordpress/i18n';\nimport { useMemo } from '@wordpress/element';\nimport {\n\tButton,\n\t__experimentalText as Text,\n\t__experimentalHStack as HStack,\n\t__experimentalVStack as VStack,\n} from '@wordpress/components';\nimport { useDispatch, useSelect } from '@wordpress/data';\nimport { store as coreStore } from '@wordpress/core-data';\nimport { store as noticesStore } from '@wordpress/notices';\n\n/**\n * Internal dependencies\n */\nimport { getItemTitle } from '../../utils/get-item-title';\n\nconst SetAsPostsPageModal = ( { items, closeModal } ) => {\n\tconst [ item ] = items;\n\tconst pageTitle = getItemTitle( item );\n\tconst { currentPostsPage, isPageForPostsSet, isSaving } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getEntityRecord, isSavingEntityRecord } =\n\t\t\t\tselect( coreStore );\n\t\t\tconst siteSettings = getEntityRecord( 'root', 'site' );\n\t\t\tconst currentPostsPageItem = getEntityRecord(\n\t\t\t\t'postType',\n\t\t\t\t'page',\n\t\t\t\tsiteSettings?.page_for_posts\n\t\t\t);\n\t\t\treturn {\n\t\t\t\tcurrentPostsPage: currentPostsPageItem,\n\t\t\t\tisPageForPostsSet: siteSettings?.page_for_posts !== 0,\n\t\t\t\tisSaving: isSavingEntityRecord( 'root', 'site' ),\n\t\t\t};\n\t\t}\n\t);\n\n\tconst { saveEntityRecord } = useDispatch( coreStore );\n\tconst { createSuccessNotice, createErrorNotice } =\n\t\tuseDispatch( noticesStore );\n\n\tasync function onSetPageAsPostsPage( event ) {\n\t\tevent.preventDefault();\n\n\t\ttry {\n\t\t\tawait saveEntityRecord( 'root', 'site', {\n\t\t\t\tpage_for_posts: item.id,\n\t\t\t\tshow_on_front: 'page',\n\t\t\t} );\n\n\t\t\tcreateSuccessNotice( __( 'Posts page updated.' ), {\n\t\t\t\ttype: 'snackbar',\n\t\t\t} );\n\t\t} catch ( error ) {\n\t\t\tconst errorMessage =\n\t\t\t\terror.message && error.code !== 'unknown_error'\n\t\t\t\t\t? error.message\n\t\t\t\t\t: __( 'An error occurred while setting the posts page.' );\n\t\t\tcreateErrorNotice( errorMessage, { type: 'snackbar' } );\n\t\t} finally {\n\t\t\tcloseModal?.();\n\t\t}\n\t}\n\n\tconst modalWarning =\n\t\tisPageForPostsSet && currentPostsPage\n\t\t\t? sprintf(\n\t\t\t\t\t// translators: %s: title of the current posts page.\n\t\t\t\t\t__( 'This will replace the current posts page: \"%s\"' ),\n\t\t\t\t\tgetItemTitle( currentPostsPage )\n\t\t\t  )\n\t\t\t: __( 'This page will show the latest posts.' );\n\n\tconst modalText = sprintf(\n\t\t// translators: %1$s: title of the page to be set as the posts page, %2$s: posts page replacement warning message.\n\t\t__( 'Set \"%1$s\" as the posts page? %2$s' ),\n\t\tpageTitle,\n\t\tmodalWarning\n\t);\n\n\t// translators: Button label to confirm setting the specified page as the posts page.\n\tconst modalButtonLabel = __( 'Set posts page' );\n\n\treturn (\n\t\t<form onSubmit={ onSetPageAsPostsPage }>\n\t\t\t<VStack spacing=\"5\">\n\t\t\t\t<Text>{ modalText }</Text>\n\t\t\t\t<HStack justify=\"right\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\t__next40pxDefaultSize\n\t\t\t\t\t\tvariant=\"tertiary\"\n\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\tcloseModal?.();\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tdisabled={ isSaving }\n\t\t\t\t\t\taccessibleWhenDisabled\n\t\t\t\t\t>\n\t\t\t\t\t\t{ __( 'Cancel' ) }\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\t__next40pxDefaultSize\n\t\t\t\t\t\tvariant=\"primary\"\n\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\tdisabled={ isSaving }\n\t\t\t\t\t\taccessibleWhenDisabled\n\t\t\t\t\t>\n\t\t\t\t\t\t{ modalButtonLabel }\n\t\t\t\t\t</Button>\n\t\t\t\t</HStack>\n\t\t\t</VStack>\n\t\t</form>\n\t);\n};\n\nexport const useSetAsPostsPageAction = () => {\n\tconst { pageOnFront, pageForPosts } = useSelect( ( select ) => {\n\t\tconst { getEntityRecord, canUser } = select( coreStore );\n\t\tconst siteSettings = canUser( 'read', {\n\t\t\tkind: 'root',\n\t\t\tname: 'site',\n\t\t} )\n\t\t\t? getEntityRecord( 'root', 'site' )\n\t\t\t: undefined;\n\n\t\treturn {\n\t\t\tpageOnFront: siteSettings?.page_on_front,\n\t\t\tpageForPosts: siteSettings?.page_for_posts,\n\t\t};\n\t} );\n\n\treturn useMemo(\n\t\t() => ( {\n\t\t\tid: 'set-as-posts-page',\n\t\t\tlabel: __( 'Set as posts page' ),\n\t\t\tisEligible( post ) {\n\t\t\t\tif ( post.status !== 'publish' ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif ( post.type !== 'page' ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// Don't show the action if the page is already set as the homepage.\n\t\t\t\tif ( pageOnFront === post.id ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// Don't show the action if the page is already set as the page for posts.\n\t\t\t\tif ( pageForPosts === post.id ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tmodalFocusOnMount: 'firstContentElement',\n\t\t\tRenderModal: SetAsPostsPageModal,\n\t\t} ),\n\t\t[ pageForPosts, pageOnFront ]\n\t);\n};\n"],"mappings":"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","ignoreList":[]}