{"version":3,"names":["_i18n","require","_data","_coreData","_components","_element","_blockEditor","_constants","_postPanelRow","_interopRequireDefault","_store","_jsxRuntime","COMMENT_OPTIONS","label","_x","value","description","__","join","SiteDiscussion","editEntityRecord","useDispatch","coreStore","allowCommentsOnNewPosts","isTemplate","postSlug","useSelect","select","getEditedPostAttribute","getCurrentPostType","editorStore","getEditedEntityRecord","canUser","siteSettings","kind","name","undefined","TEMPLATE_POST_TYPE","default_comment_status","popoverAnchor","setPopoverAnchor","useState","popoverProps","useMemo","anchor","placement","offset","shift","includes","setAllowCommentsOnNewPosts","newValue","jsx","default","ref","children","Dropdown","contentClassName","focusOnMount","renderToggle","isOpen","onToggle","Button","size","variant","onClick","renderContent","onClose","jsxs","Fragment","__experimentalInspectorPopoverHeader","title","__experimentalVStack","spacing","__experimentalText","RadioControl","className","hideLabelFromVision","options","onChange","selected"],"sources":["@wordpress/editor/src/components/site-discussion/index.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { __, _x } from '@wordpress/i18n';\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { store as coreStore } from '@wordpress/core-data';\nimport {\n\tButton,\n\tDropdown,\n\tRadioControl,\n\t__experimentalVStack as VStack,\n\t__experimentalText as Text,\n} from '@wordpress/components';\nimport { useState, useMemo } from '@wordpress/element';\nimport { __experimentalInspectorPopoverHeader as InspectorPopoverHeader } from '@wordpress/block-editor';\n\n/**\n * Internal dependencies\n */\nimport { TEMPLATE_POST_TYPE } from '../../store/constants';\nimport PostPanelRow from '../post-panel-row';\nimport { store as editorStore } from '../../store';\n\nconst COMMENT_OPTIONS = [\n\t{\n\t\tlabel: _x( 'Open', 'Adjective: e.g. \"Comments are open\"' ),\n\t\tvalue: 'open',\n\t\tdescription: __( 'Visitors can add new comments and replies.' ),\n\t},\n\t{\n\t\tlabel: __( 'Closed' ),\n\t\tvalue: '',\n\t\tdescription: [\n\t\t\t__( 'Visitors cannot add new comments or replies.' ),\n\t\t\t__( 'Existing comments remain visible.' ),\n\t\t].join( ' ' ),\n\t},\n];\n\nexport default function SiteDiscussion() {\n\tconst { editEntityRecord } = useDispatch( coreStore );\n\tconst { allowCommentsOnNewPosts, isTemplate, postSlug } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getEditedPostAttribute, getCurrentPostType } =\n\t\t\t\tselect( editorStore );\n\t\t\tconst { getEditedEntityRecord, canUser } = select( coreStore );\n\t\t\tconst siteSettings = canUser( 'read', {\n\t\t\t\tkind: 'root',\n\t\t\t\tname: 'site',\n\t\t\t} )\n\t\t\t\t? getEditedEntityRecord( 'root', 'site' )\n\t\t\t\t: undefined;\n\t\t\treturn {\n\t\t\t\tisTemplate: getCurrentPostType() === TEMPLATE_POST_TYPE,\n\t\t\t\tpostSlug: getEditedPostAttribute( 'slug' ),\n\t\t\t\tallowCommentsOnNewPosts:\n\t\t\t\t\tsiteSettings?.default_comment_status || '',\n\t\t\t};\n\t\t},\n\t\t[]\n\t);\n\t// Use internal state instead of a ref to make sure that the component\n\t// re-renders when the popover's anchor updates.\n\tconst [ popoverAnchor, setPopoverAnchor ] = useState( null );\n\t// Memoize popoverProps to avoid returning a new object every time.\n\tconst popoverProps = useMemo(\n\t\t() => ( {\n\t\t\t// Anchor the popover to the middle of the entire row so that it doesn't\n\t\t\t// move around when the label changes.\n\t\t\tanchor: popoverAnchor,\n\t\t\tplacement: 'left-start',\n\t\t\toffset: 36,\n\t\t\tshift: true,\n\t\t} ),\n\t\t[ popoverAnchor ]\n\t);\n\n\tif ( ! isTemplate || ! [ 'home', 'index' ].includes( postSlug ) ) {\n\t\treturn null;\n\t}\n\tconst setAllowCommentsOnNewPosts = ( newValue ) => {\n\t\teditEntityRecord( 'root', 'site', undefined, {\n\t\t\tdefault_comment_status: newValue ? 'open' : null,\n\t\t} );\n\t};\n\treturn (\n\t\t<PostPanelRow label={ __( 'Discussion' ) } ref={ setPopoverAnchor }>\n\t\t\t<Dropdown\n\t\t\t\tpopoverProps={ popoverProps }\n\t\t\t\tcontentClassName=\"editor-site-discussion-dropdown__content\"\n\t\t\t\tfocusOnMount\n\t\t\t\trenderToggle={ ( { isOpen, onToggle } ) => (\n\t\t\t\t\t<Button\n\t\t\t\t\t\tsize=\"compact\"\n\t\t\t\t\t\tvariant=\"tertiary\"\n\t\t\t\t\t\taria-expanded={ isOpen }\n\t\t\t\t\t\taria-label={ __( 'Change discussion settings' ) }\n\t\t\t\t\t\tonClick={ onToggle }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ allowCommentsOnNewPosts\n\t\t\t\t\t\t\t? __( 'Comments open' )\n\t\t\t\t\t\t\t: __( 'Comments closed' ) }\n\t\t\t\t\t</Button>\n\t\t\t\t) }\n\t\t\t\trenderContent={ ( { onClose } ) => (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<InspectorPopoverHeader\n\t\t\t\t\t\t\ttitle={ __( 'Discussion' ) }\n\t\t\t\t\t\t\tonClose={ onClose }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<VStack spacing={ 3 }>\n\t\t\t\t\t\t\t<Text>\n\t\t\t\t\t\t\t\t{ __(\n\t\t\t\t\t\t\t\t\t'Changes will apply to new posts only. Individual posts may override these settings.'\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t\t<RadioControl\n\t\t\t\t\t\t\t\tclassName=\"editor-site-discussion__options\"\n\t\t\t\t\t\t\t\thideLabelFromVision\n\t\t\t\t\t\t\t\tlabel={ __( 'Comment status' ) }\n\t\t\t\t\t\t\t\toptions={ COMMENT_OPTIONS }\n\t\t\t\t\t\t\t\tonChange={ setAllowCommentsOnNewPosts }\n\t\t\t\t\t\t\t\tselected={ allowCommentsOnNewPosts }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</VStack>\n\t\t\t\t\t</>\n\t\t\t\t) }\n\t\t\t/>\n\t\t</PostPanelRow>\n\t);\n}\n"],"mappings":"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","ignoreList":[]}