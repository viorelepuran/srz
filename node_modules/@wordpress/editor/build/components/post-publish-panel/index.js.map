{"version":3,"names":["_i18n","require","_element","_components","_data","_compose","_icons","_coreData","_postPublishButton","_interopRequireDefault","_prepublish","_postpublish","_store","_jsxRuntime","PostPublishPanel","Component","constructor","arguments","onSubmit","bind","cancelButtonNode","createRef","componentDidMount","timeoutID","setTimeout","current","focus","componentWillUnmount","clearTimeout","componentDidUpdate","prevProps","isPublished","props","isSaving","isDirty","currentPostId","onClose","hasPublishAction","isPostTypeViewable","render","forceIsDirty","isBeingScheduled","isPublishSidebarEnabled","isScheduled","isSavingNonPostEntityChanges","onTogglePublishSidebar","PostPublishExtension","PrePublishExtension","additionalProps","propsForPanel","isPublishedOrScheduled","isPrePublish","isPostPublish","jsxs","className","children","jsx","Button","size","onClick","icon","closeSmall","label","__","Fragment","ref","accessibleWhenDisabled","disabled","variant","default","focusOnMount","Spinner","CheckboxControl","__nextHasNoMarginBottom","checked","onChange","exports","_default","compose","withSelect","select","_getCurrentPost$_link","getPostType","coreStore","getCurrentPost","getCurrentPostId","getEditedPostAttribute","isCurrentPostPublished","isCurrentPostScheduled","isEditedPostBeingScheduled","isEditedPostDirty","isAutosavingPost","isSavingPost","editorStore","postType","_links","viewable","withDispatch","dispatch","disablePublishSidebar","enablePublishSidebar","withFocusReturn","withConstrainedTabbing"],"sources":["@wordpress/editor/src/components/post-publish-panel/index.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Component, createRef } from '@wordpress/element';\nimport {\n\tButton,\n\tSpinner,\n\tCheckboxControl,\n\twithFocusReturn,\n\twithConstrainedTabbing,\n} from '@wordpress/components';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { compose } from '@wordpress/compose';\nimport { closeSmall } from '@wordpress/icons';\nimport { store as coreStore } from '@wordpress/core-data';\n\n/**\n * Internal dependencies\n */\nimport PostPublishButton from '../post-publish-button';\nimport PostPublishPanelPrepublish from './prepublish';\nimport PostPublishPanelPostpublish from './postpublish';\nimport { store as editorStore } from '../../store';\n\nexport class PostPublishPanel extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.onSubmit = this.onSubmit.bind( this );\n\t\tthis.cancelButtonNode = createRef();\n\t}\n\n\tcomponentDidMount() {\n\t\t// This timeout is necessary to make sure the `useEffect` hook of\n\t\t// `useFocusReturn` gets the correct element (the button that opens the\n\t\t// PostPublishPanel) otherwise it will get this button.\n\t\tthis.timeoutID = setTimeout( () => {\n\t\t\tthis.cancelButtonNode.current.focus();\n\t\t}, 0 );\n\t}\n\n\tcomponentWillUnmount() {\n\t\tclearTimeout( this.timeoutID );\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\t// Automatically collapse the publish sidebar when a post\n\t\t// is published and the user makes an edit.\n\t\tif (\n\t\t\t( prevProps.isPublished &&\n\t\t\t\t! this.props.isSaving &&\n\t\t\t\tthis.props.isDirty ) ||\n\t\t\tthis.props.currentPostId !== prevProps.currentPostId\n\t\t) {\n\t\t\tthis.props.onClose();\n\t\t}\n\t}\n\n\tonSubmit() {\n\t\tconst { onClose, hasPublishAction, isPostTypeViewable } = this.props;\n\t\tif ( ! hasPublishAction || ! isPostTypeViewable ) {\n\t\t\tonClose();\n\t\t}\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tforceIsDirty,\n\t\t\tisBeingScheduled,\n\t\t\tisPublished,\n\t\t\tisPublishSidebarEnabled,\n\t\t\tisScheduled,\n\t\t\tisSaving,\n\t\t\tisSavingNonPostEntityChanges,\n\t\t\tonClose,\n\t\t\tonTogglePublishSidebar,\n\t\t\tPostPublishExtension,\n\t\t\tPrePublishExtension,\n\t\t\tcurrentPostId,\n\t\t\t...additionalProps\n\t\t} = this.props;\n\t\tconst {\n\t\t\thasPublishAction,\n\t\t\tisDirty,\n\t\t\tisPostTypeViewable,\n\t\t\t...propsForPanel\n\t\t} = additionalProps;\n\t\tconst isPublishedOrScheduled =\n\t\t\tisPublished || ( isScheduled && isBeingScheduled );\n\t\tconst isPrePublish = ! isPublishedOrScheduled && ! isSaving;\n\t\tconst isPostPublish = isPublishedOrScheduled && ! isSaving;\n\t\treturn (\n\t\t\t<div className=\"editor-post-publish-panel\" { ...propsForPanel }>\n\t\t\t\t<div className=\"editor-post-publish-panel__header\">\n\t\t\t\t\t{ isPostPublish ? (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tsize=\"compact\"\n\t\t\t\t\t\t\tonClick={ onClose }\n\t\t\t\t\t\t\ticon={ closeSmall }\n\t\t\t\t\t\t\tlabel={ __( 'Close panel' ) }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<div className=\"editor-post-publish-panel__header-cancel-button\">\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tref={ this.cancelButtonNode }\n\t\t\t\t\t\t\t\t\taccessibleWhenDisabled\n\t\t\t\t\t\t\t\t\tdisabled={ isSavingNonPostEntityChanges }\n\t\t\t\t\t\t\t\t\tonClick={ onClose }\n\t\t\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\t\t\tsize=\"compact\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{ __( 'Cancel' ) }\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"editor-post-publish-panel__header-publish-button\">\n\t\t\t\t\t\t\t\t<PostPublishButton\n\t\t\t\t\t\t\t\t\tonSubmit={ this.onSubmit }\n\t\t\t\t\t\t\t\t\tforceIsDirty={ forceIsDirty }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\t\t\t\t<div className=\"editor-post-publish-panel__content\">\n\t\t\t\t\t{ isPrePublish && (\n\t\t\t\t\t\t<PostPublishPanelPrepublish>\n\t\t\t\t\t\t\t{ PrePublishExtension && <PrePublishExtension /> }\n\t\t\t\t\t\t</PostPublishPanelPrepublish>\n\t\t\t\t\t) }\n\t\t\t\t\t{ isPostPublish && (\n\t\t\t\t\t\t<PostPublishPanelPostpublish focusOnMount>\n\t\t\t\t\t\t\t{ PostPublishExtension && <PostPublishExtension /> }\n\t\t\t\t\t\t</PostPublishPanelPostpublish>\n\t\t\t\t\t) }\n\t\t\t\t\t{ isSaving && <Spinner /> }\n\t\t\t\t</div>\n\t\t\t\t<div className=\"editor-post-publish-panel__footer\">\n\t\t\t\t\t<CheckboxControl\n\t\t\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\t\t\tlabel={ __( 'Always show pre-publish checks.' ) }\n\t\t\t\t\t\tchecked={ isPublishSidebarEnabled }\n\t\t\t\t\t\tonChange={ onTogglePublishSidebar }\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\n/**\n * Renders a panel for publishing a post.\n */\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst { getPostType } = select( coreStore );\n\t\tconst {\n\t\t\tgetCurrentPost,\n\t\t\tgetCurrentPostId,\n\t\t\tgetEditedPostAttribute,\n\t\t\tisCurrentPostPublished,\n\t\t\tisCurrentPostScheduled,\n\t\t\tisEditedPostBeingScheduled,\n\t\t\tisEditedPostDirty,\n\t\t\tisAutosavingPost,\n\t\t\tisSavingPost,\n\t\t\tisSavingNonPostEntityChanges,\n\t\t} = select( editorStore );\n\t\tconst { isPublishSidebarEnabled } = select( editorStore );\n\t\tconst postType = getPostType( getEditedPostAttribute( 'type' ) );\n\n\t\treturn {\n\t\t\thasPublishAction:\n\t\t\t\tgetCurrentPost()._links?.[ 'wp:action-publish' ] ?? false,\n\t\t\tisPostTypeViewable: postType?.viewable,\n\t\t\tisBeingScheduled: isEditedPostBeingScheduled(),\n\t\t\tisDirty: isEditedPostDirty(),\n\t\t\tisPublished: isCurrentPostPublished(),\n\t\t\tisPublishSidebarEnabled: isPublishSidebarEnabled(),\n\t\t\tisSaving: isSavingPost() && ! isAutosavingPost(),\n\t\t\tisSavingNonPostEntityChanges: isSavingNonPostEntityChanges(),\n\t\t\tisScheduled: isCurrentPostScheduled(),\n\t\t\tcurrentPostId: getCurrentPostId(),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, { isPublishSidebarEnabled } ) => {\n\t\tconst { disablePublishSidebar, enablePublishSidebar } =\n\t\t\tdispatch( editorStore );\n\t\treturn {\n\t\t\tonTogglePublishSidebar: () => {\n\t\t\t\tif ( isPublishSidebarEnabled ) {\n\t\t\t\t\tdisablePublishSidebar();\n\t\t\t\t} else {\n\t\t\t\t\tenablePublishSidebar();\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\t} ),\n\twithFocusReturn,\n\twithConstrainedTabbing,\n] )( PostPublishPanel );\n"],"mappings":";;;;;;;AAGA,IAAAA,KAAA,GAAAC,OAAA;AACA,IAAAC,QAAA,GAAAD,OAAA;AACA,IAAAE,WAAA,GAAAF,OAAA;AAOA,IAAAG,KAAA,GAAAH,OAAA;AACA,IAAAI,QAAA,GAAAJ,OAAA;AACA,IAAAK,MAAA,GAAAL,OAAA;AACA,IAAAM,SAAA,GAAAN,OAAA;AAKA,IAAAO,kBAAA,GAAAC,sBAAA,CAAAR,OAAA;AACA,IAAAS,WAAA,GAAAD,sBAAA,CAAAR,OAAA;AACA,IAAAU,YAAA,GAAAF,sBAAA,CAAAR,OAAA;AACA,IAAAW,MAAA,GAAAX,OAAA;AAAmD,IAAAY,WAAA,GAAAZ,OAAA;AAvBnD;AACA;AACA;;AAeA;AACA;AACA;;AAMO,MAAMa,gBAAgB,SAASC,kBAAS,CAAC;EAC/CC,WAAWA,CAAA,EAAG;IACb,KAAK,CAAE,GAAGC,SAAU,CAAC;IACrB,IAAI,CAACC,QAAQ,GAAG,IAAI,CAACA,QAAQ,CAACC,IAAI,CAAE,IAAK,CAAC;IAC1C,IAAI,CAACC,gBAAgB,GAAG,IAAAC,kBAAS,EAAC,CAAC;EACpC;EAEAC,iBAAiBA,CAAA,EAAG;IACnB;IACA;IACA;IACA,IAAI,CAACC,SAAS,GAAGC,UAAU,CAAE,MAAM;MAClC,IAAI,CAACJ,gBAAgB,CAACK,OAAO,CAACC,KAAK,CAAC,CAAC;IACtC,CAAC,EAAE,CAAE,CAAC;EACP;EAEAC,oBAAoBA,CAAA,EAAG;IACtBC,YAAY,CAAE,IAAI,CAACL,SAAU,CAAC;EAC/B;EAEAM,kBAAkBA,CAAEC,SAAS,EAAG;IAC/B;IACA;IACA,IACGA,SAAS,CAACC,WAAW,IACtB,CAAE,IAAI,CAACC,KAAK,CAACC,QAAQ,IACrB,IAAI,CAACD,KAAK,CAACE,OAAO,IACnB,IAAI,CAACF,KAAK,CAACG,aAAa,KAAKL,SAAS,CAACK,aAAa,EACnD;MACD,IAAI,CAACH,KAAK,CAACI,OAAO,CAAC,CAAC;IACrB;EACD;EAEAlB,QAAQA,CAAA,EAAG;IACV,MAAM;MAAEkB,OAAO;MAAEC,gBAAgB;MAAEC;IAAmB,CAAC,GAAG,IAAI,CAACN,KAAK;IACpE,IAAK,CAAEK,gBAAgB,IAAI,CAAEC,kBAAkB,EAAG;MACjDF,OAAO,CAAC,CAAC;IACV;EACD;EAEAG,MAAMA,CAAA,EAAG;IACR,MAAM;MACLC,YAAY;MACZC,gBAAgB;MAChBV,WAAW;MACXW,uBAAuB;MACvBC,WAAW;MACXV,QAAQ;MACRW,4BAA4B;MAC5BR,OAAO;MACPS,sBAAsB;MACtBC,oBAAoB;MACpBC,mBAAmB;MACnBZ,aAAa;MACb,GAAGa;IACJ,CAAC,GAAG,IAAI,CAAChB,KAAK;IACd,MAAM;MACLK,gBAAgB;MAChBH,OAAO;MACPI,kBAAkB;MAClB,GAAGW;IACJ,CAAC,GAAGD,eAAe;IACnB,MAAME,sBAAsB,GAC3BnB,WAAW,IAAMY,WAAW,IAAIF,gBAAkB;IACnD,MAAMU,YAAY,GAAG,CAAED,sBAAsB,IAAI,CAAEjB,QAAQ;IAC3D,MAAMmB,aAAa,GAAGF,sBAAsB,IAAI,CAAEjB,QAAQ;IAC1D,oBACC,IAAApB,WAAA,CAAAwC,IAAA;MAAKC,SAAS,EAAC,2BAA2B;MAAA,GAAML,aAAa;MAAAM,QAAA,gBAC5D,IAAA1C,WAAA,CAAA2C,GAAA;QAAKF,SAAS,EAAC,mCAAmC;QAAAC,QAAA,EAC/CH,aAAa,gBACd,IAAAvC,WAAA,CAAA2C,GAAA,EAACrD,WAAA,CAAAsD,MAAM;UACNC,IAAI,EAAC,SAAS;UACdC,OAAO,EAAGvB,OAAS;UACnBwB,IAAI,EAAGC,iBAAY;UACnBC,KAAK,EAAG,IAAAC,QAAE,EAAE,aAAc;QAAG,CAC7B,CAAC,gBAEF,IAAAlD,WAAA,CAAAwC,IAAA,EAAAxC,WAAA,CAAAmD,QAAA;UAAAT,QAAA,gBACC,IAAA1C,WAAA,CAAA2C,GAAA;YAAKF,SAAS,EAAC,iDAAiD;YAAAC,QAAA,eAC/D,IAAA1C,WAAA,CAAA2C,GAAA,EAACrD,WAAA,CAAAsD,MAAM;cACNQ,GAAG,EAAG,IAAI,CAAC7C,gBAAkB;cAC7B8C,sBAAsB;cACtBC,QAAQ,EAAGvB,4BAA8B;cACzCe,OAAO,EAAGvB,OAAS;cACnBgC,OAAO,EAAC,WAAW;cACnBV,IAAI,EAAC,SAAS;cAAAH,QAAA,EAEZ,IAAAQ,QAAE,EAAE,QAAS;YAAC,CACT;UAAC,CACL,CAAC,eACN,IAAAlD,WAAA,CAAA2C,GAAA;YAAKF,SAAS,EAAC,kDAAkD;YAAAC,QAAA,eAChE,IAAA1C,WAAA,CAAA2C,GAAA,EAAChD,kBAAA,CAAA6D,OAAiB;cACjBnD,QAAQ,EAAG,IAAI,CAACA,QAAU;cAC1BsB,YAAY,EAAGA;YAAc,CAC7B;UAAC,CACE,CAAC;QAAA,CACL;MACF,CACG,CAAC,eACN,IAAA3B,WAAA,CAAAwC,IAAA;QAAKC,SAAS,EAAC,oCAAoC;QAAAC,QAAA,GAChDJ,YAAY,iBACb,IAAAtC,WAAA,CAAA2C,GAAA,EAAC9C,WAAA,CAAA2D,OAA0B;UAAAd,QAAA,EACxBR,mBAAmB,iBAAI,IAAAlC,WAAA,CAAA2C,GAAA,EAACT,mBAAmB,IAAE;QAAC,CACrB,CAC5B,EACCK,aAAa,iBACd,IAAAvC,WAAA,CAAA2C,GAAA,EAAC7C,YAAA,CAAA0D,OAA2B;UAACC,YAAY;UAAAf,QAAA,EACtCT,oBAAoB,iBAAI,IAAAjC,WAAA,CAAA2C,GAAA,EAACV,oBAAoB,IAAE;QAAC,CACtB,CAC7B,EACCb,QAAQ,iBAAI,IAAApB,WAAA,CAAA2C,GAAA,EAACrD,WAAA,CAAAoE,OAAO,IAAE,CAAC;MAAA,CACrB,CAAC,eACN,IAAA1D,WAAA,CAAA2C,GAAA;QAAKF,SAAS,EAAC,mCAAmC;QAAAC,QAAA,eACjD,IAAA1C,WAAA,CAAA2C,GAAA,EAACrD,WAAA,CAAAqE,eAAe;UACfC,uBAAuB;UACvBX,KAAK,EAAG,IAAAC,QAAE,EAAE,iCAAkC,CAAG;UACjDW,OAAO,EAAGhC,uBAAyB;UACnCiC,QAAQ,EAAG9B;QAAwB,CACnC;MAAC,CACE,CAAC;IAAA,CACF,CAAC;EAER;AACD;;AAEA;AACA;AACA;AAFA+B,OAAA,CAAA9D,gBAAA,GAAAA,gBAAA;AAAA,IAAA+D,QAAA,GAAAD,OAAA,CAAAP,OAAA,GAGe,IAAAS,gBAAO,EAAE,CACvB,IAAAC,gBAAU,EAAIC,MAAM,IAAM;EAAA,IAAAC,qBAAA;EACzB,MAAM;IAAEC;EAAY,CAAC,GAAGF,MAAM,CAAEG,eAAU,CAAC;EAC3C,MAAM;IACLC,cAAc;IACdC,gBAAgB;IAChBC,sBAAsB;IACtBC,sBAAsB;IACtBC,sBAAsB;IACtBC,0BAA0B;IAC1BC,iBAAiB;IACjBC,gBAAgB;IAChBC,YAAY;IACZhD;EACD,CAAC,GAAGoC,MAAM,CAAEa,YAAY,CAAC;EACzB,MAAM;IAAEnD;EAAwB,CAAC,GAAGsC,MAAM,CAAEa,YAAY,CAAC;EACzD,MAAMC,QAAQ,GAAGZ,WAAW,CAAEI,sBAAsB,CAAE,MAAO,CAAE,CAAC;EAEhE,OAAO;IACNjD,gBAAgB,GAAA4C,qBAAA,GACfG,cAAc,CAAC,CAAC,CAACW,MAAM,GAAI,mBAAmB,CAAE,cAAAd,qBAAA,cAAAA,qBAAA,GAAI,KAAK;IAC1D3C,kBAAkB,EAAEwD,QAAQ,EAAEE,QAAQ;IACtCvD,gBAAgB,EAAEgD,0BAA0B,CAAC,CAAC;IAC9CvD,OAAO,EAAEwD,iBAAiB,CAAC,CAAC;IAC5B3D,WAAW,EAAEwD,sBAAsB,CAAC,CAAC;IACrC7C,uBAAuB,EAAEA,uBAAuB,CAAC,CAAC;IAClDT,QAAQ,EAAE2D,YAAY,CAAC,CAAC,IAAI,CAAED,gBAAgB,CAAC,CAAC;IAChD/C,4BAA4B,EAAEA,4BAA4B,CAAC,CAAC;IAC5DD,WAAW,EAAE6C,sBAAsB,CAAC,CAAC;IACrCrD,aAAa,EAAEkD,gBAAgB,CAAC;EACjC,CAAC;AACF,CAAE,CAAC,EACH,IAAAY,kBAAY,EAAE,CAAEC,QAAQ,EAAE;EAAExD;AAAwB,CAAC,KAAM;EAC1D,MAAM;IAAEyD,qBAAqB;IAAEC;EAAqB,CAAC,GACpDF,QAAQ,CAAEL,YAAY,CAAC;EACxB,OAAO;IACNhD,sBAAsB,EAAEA,CAAA,KAAM;MAC7B,IAAKH,uBAAuB,EAAG;QAC9ByD,qBAAqB,CAAC,CAAC;MACxB,CAAC,MAAM;QACNC,oBAAoB,CAAC,CAAC;MACvB;IACD;EACD,CAAC;AACF,CAAE,CAAC,EACHC,2BAAe,EACfC,kCAAsB,CACrB,CAAC,CAAExF,gBAAiB,CAAC","ignoreList":[]}