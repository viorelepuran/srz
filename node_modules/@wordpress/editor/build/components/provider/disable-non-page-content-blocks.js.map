{"version":3,"names":["_data","require","_blockEditor","_element","_usePostContentBlocks","_interopRequireDefault","DisableNonPageContentBlocks","contentOnlyIds","usePostContentBlocks","templateParts","isNavigationMode","useSelect","select","getBlocksByName","_isNavigationMode","blockEditorStore","disabledIds","getBlockOrder","flatMap","clientId","registry","useRegistry","useEffect","setBlockEditingMode","unsetBlockEditingMode","dispatch","batch"],"sources":["@wordpress/editor/src/components/provider/disable-non-page-content-blocks.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useSelect, useRegistry } from '@wordpress/data';\nimport { store as blockEditorStore } from '@wordpress/block-editor';\nimport { useEffect } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport usePostContentBlocks from './use-post-content-blocks';\n\n/**\n * Component that when rendered, makes it so that the site editor allows only\n * page content to be edited.\n */\nexport default function DisableNonPageContentBlocks() {\n\tconst contentOnlyIds = usePostContentBlocks();\n\tconst { templateParts, isNavigationMode } = useSelect( ( select ) => {\n\t\tconst { getBlocksByName, isNavigationMode: _isNavigationMode } =\n\t\t\tselect( blockEditorStore );\n\t\treturn {\n\t\t\ttemplateParts: getBlocksByName( 'core/template-part' ),\n\t\t\tisNavigationMode: _isNavigationMode(),\n\t\t};\n\t}, [] );\n\tconst disabledIds = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getBlockOrder } = select( blockEditorStore );\n\t\t\treturn templateParts.flatMap( ( clientId ) =>\n\t\t\t\tgetBlockOrder( clientId )\n\t\t\t);\n\t\t},\n\t\t[ templateParts ]\n\t);\n\n\tconst registry = useRegistry();\n\n\t// The code here is split into multiple `useEffects` calls.\n\t// This is done to avoid setting/unsetting block editing modes multiple times unnecessarily.\n\t//\n\t// For example, the block editing mode of the root block (clientId: '') only\n\t// needs to be set once, not when `contentOnlyIds` or `disabledIds` change.\n\t//\n\t// It's also unlikely that these different types of blocks are being inserted\n\t// or removed at the same time, so using different effects reflects that.\n\tuseEffect( () => {\n\t\tconst { setBlockEditingMode, unsetBlockEditingMode } =\n\t\t\tregistry.dispatch( blockEditorStore );\n\n\t\tsetBlockEditingMode( '', 'disabled' );\n\n\t\treturn () => {\n\t\t\tunsetBlockEditingMode( '' );\n\t\t};\n\t}, [ registry ] );\n\n\tuseEffect( () => {\n\t\tconst { setBlockEditingMode, unsetBlockEditingMode } =\n\t\t\tregistry.dispatch( blockEditorStore );\n\n\t\tregistry.batch( () => {\n\t\t\tfor ( const clientId of contentOnlyIds ) {\n\t\t\t\tsetBlockEditingMode( clientId, 'contentOnly' );\n\t\t\t}\n\t\t} );\n\n\t\treturn () => {\n\t\t\tregistry.batch( () => {\n\t\t\t\tfor ( const clientId of contentOnlyIds ) {\n\t\t\t\t\tunsetBlockEditingMode( clientId );\n\t\t\t\t}\n\t\t\t} );\n\t\t};\n\t}, [ contentOnlyIds, registry ] );\n\n\tuseEffect( () => {\n\t\tconst { setBlockEditingMode, unsetBlockEditingMode } =\n\t\t\tregistry.dispatch( blockEditorStore );\n\n\t\tregistry.batch( () => {\n\t\t\tif ( ! isNavigationMode ) {\n\t\t\t\tfor ( const clientId of templateParts ) {\n\t\t\t\t\tsetBlockEditingMode( clientId, 'contentOnly' );\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\n\t\treturn () => {\n\t\t\tregistry.batch( () => {\n\t\t\t\tif ( ! isNavigationMode ) {\n\t\t\t\t\tfor ( const clientId of templateParts ) {\n\t\t\t\t\t\tunsetBlockEditingMode( clientId );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\t};\n\t}, [ templateParts, isNavigationMode, registry ] );\n\n\tuseEffect( () => {\n\t\tconst { setBlockEditingMode, unsetBlockEditingMode } =\n\t\t\tregistry.dispatch( blockEditorStore );\n\n\t\tregistry.batch( () => {\n\t\t\tfor ( const clientId of disabledIds ) {\n\t\t\t\tsetBlockEditingMode( clientId, 'disabled' );\n\t\t\t}\n\t\t} );\n\n\t\treturn () => {\n\t\t\tregistry.batch( () => {\n\t\t\t\tfor ( const clientId of disabledIds ) {\n\t\t\t\t\tunsetBlockEditingMode( clientId );\n\t\t\t\t}\n\t\t\t} );\n\t\t};\n\t}, [ disabledIds, registry ] );\n\n\treturn null;\n}\n"],"mappings":"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","ignoreList":[]}