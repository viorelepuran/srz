{"version":3,"names":["_i18n","require","_blockEditor","_data","_coreData","_provider","_lockUnlock","_store","_jsxRuntime","useGlobalStyle","unlock","blockEditorPrivateApis","PostPreviewContainer","template","post","backgroundColor","postBlocks","useEntityBlockEditor","type","id","templateBlocks","blocks","isEmpty","length","jsxs","className","style","children","jsx","__","BlockPreview","Async","PostPreviewView","item","settings","useSelect","select","_getPostType$viewable","canUser","getPostType","getTemplateId","getEntityRecord","coreStore","canViewTemplate","kind","name","_settings","editorStore","getEditorSettings","supportsTemplateMode","isViewable","viewable","templateId","undefined","EditorProvider","__unstableTemplate"],"sources":["@wordpress/editor/src/dataviews/fields/content-preview/content-preview-view.tsx"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport {\n\tBlockPreview,\n\tprivateApis as blockEditorPrivateApis,\n\t// @ts-ignore\n} from '@wordpress/block-editor';\nimport type { BasePost } from '@wordpress/fields';\nimport { useSelect } from '@wordpress/data';\nimport { useEntityBlockEditor, store as coreStore } from '@wordpress/core-data';\n\n/**\n * Internal dependencies\n */\nimport { EditorProvider } from '../../../components/provider';\nimport { unlock } from '../../../lock-unlock';\n// @ts-ignore\nimport { store as editorStore } from '../../../store';\n\nconst { useGlobalStyle } = unlock( blockEditorPrivateApis );\n\nfunction PostPreviewContainer( {\n\ttemplate,\n\tpost,\n}: {\n\ttemplate: any;\n\tpost: any;\n} ) {\n\tconst [ backgroundColor = 'white' ] = useGlobalStyle( 'color.background' );\n\tconst [ postBlocks ] = useEntityBlockEditor( 'postType', post.type, {\n\t\tid: post.id,\n\t} );\n\tconst [ templateBlocks ] = useEntityBlockEditor(\n\t\t'postType',\n\t\ttemplate?.type,\n\t\t{\n\t\t\tid: template?.id,\n\t\t}\n\t);\n\tconst blocks = template && templateBlocks ? templateBlocks : postBlocks;\n\tconst isEmpty = ! blocks?.length;\n\treturn (\n\t\t<div\n\t\t\tclassName=\"editor-fields-content-preview\"\n\t\t\tstyle={ {\n\t\t\t\tbackgroundColor,\n\t\t\t} }\n\t\t>\n\t\t\t{ isEmpty && (\n\t\t\t\t<span className=\"editor-fields-content-preview__empty\">\n\t\t\t\t\t{ __( 'Empty content' ) }\n\t\t\t\t</span>\n\t\t\t) }\n\t\t\t{ ! isEmpty && (\n\t\t\t\t<BlockPreview.Async>\n\t\t\t\t\t<BlockPreview blocks={ blocks } />\n\t\t\t\t</BlockPreview.Async>\n\t\t\t) }\n\t\t</div>\n\t);\n}\n\nexport default function PostPreviewView( { item }: { item: BasePost } ) {\n\tconst { settings, template } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { canUser, getPostType, getTemplateId, getEntityRecord } =\n\t\t\t\tunlock( select( coreStore ) );\n\t\t\tconst canViewTemplate = canUser( 'read', {\n\t\t\t\tkind: 'postType',\n\t\t\t\tname: 'wp_template',\n\t\t\t} );\n\t\t\tconst _settings = select( editorStore ).getEditorSettings();\n\t\t\t// @ts-ignore\n\t\t\tconst supportsTemplateMode = _settings.supportsTemplateMode;\n\t\t\tconst isViewable = getPostType( item.type )?.viewable ?? false;\n\n\t\t\tconst templateId =\n\t\t\t\tsupportsTemplateMode && isViewable && canViewTemplate\n\t\t\t\t\t? getTemplateId( item.type, item.id )\n\t\t\t\t\t: null;\n\t\t\treturn {\n\t\t\t\tsettings: _settings,\n\t\t\t\ttemplate: templateId\n\t\t\t\t\t? getEntityRecord( 'postType', 'wp_template', templateId )\n\t\t\t\t\t: undefined,\n\t\t\t};\n\t\t},\n\t\t[ item.type, item.id ]\n\t);\n\t// Wrap everything in a block editor provider to ensure 'styles' that are needed\n\t// for the previews are synced between the site editor store and the block editor store.\n\t// Additionally we need to have the `__experimentalBlockPatterns` setting in order to\n\t// render patterns inside the previews.\n\t// TODO: Same approach is used in the patterns list and it becomes obvious that some of\n\t// the block editor settings are needed in context where we don't have the block editor.\n\t// Explore how we can solve this in a better way.\n\treturn (\n\t\t<EditorProvider\n\t\t\tpost={ item }\n\t\t\tsettings={ settings }\n\t\t\t__unstableTemplate={ template }\n\t\t>\n\t\t\t<PostPreviewContainer template={ template } post={ item } />\n\t\t</EditorProvider>\n\t);\n}\n"],"mappings":"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","ignoreList":[]}