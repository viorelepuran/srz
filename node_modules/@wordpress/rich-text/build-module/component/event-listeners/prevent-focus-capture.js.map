{"version":3,"names":["preventFocusCapture","element","ownerDocument","defaultView","value","onPointerDown","event","defaultPrevented","target","contains","getAttribute","setAttribute","getSelection","removeAllRanges","onPointerUp","addEventListener","removeEventListener"],"sources":["@wordpress/rich-text/src/component/event-listeners/prevent-focus-capture.js"],"sourcesContent":["/**\n * Prevents focus from being captured by the element when clicking _outside_\n * around the element. This may happen when the parent element is flex.\n * @see https://github.com/WordPress/gutenberg/pull/65857\n * @see https://github.com/WordPress/gutenberg/pull/66402\n */\nexport function preventFocusCapture() {\n\treturn ( element ) => {\n\t\tconst { ownerDocument } = element;\n\t\tconst { defaultView } = ownerDocument;\n\n\t\tlet value = null;\n\n\t\tfunction onPointerDown( event ) {\n\t\t\t// Abort if the event is default prevented, we will not get a pointer up event.\n\t\t\tif ( event.defaultPrevented ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif ( event.target === element ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif ( ! event.target.contains( element ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvalue = element.getAttribute( 'contenteditable' );\n\t\t\telement.setAttribute( 'contenteditable', 'false' );\n\t\t\tdefaultView.getSelection().removeAllRanges();\n\t\t}\n\n\t\tfunction onPointerUp() {\n\t\t\tif ( value !== null ) {\n\t\t\t\telement.setAttribute( 'contenteditable', value );\n\t\t\t\tvalue = null;\n\t\t\t}\n\t\t}\n\n\t\tdefaultView.addEventListener( 'pointerdown', onPointerDown );\n\t\tdefaultView.addEventListener( 'pointerup', onPointerUp );\n\t\treturn () => {\n\t\t\tdefaultView.removeEventListener( 'pointerdown', onPointerDown );\n\t\t\tdefaultView.removeEventListener( 'pointerup', onPointerUp );\n\t\t};\n\t};\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASA,mBAAmBA,CAAA,EAAG;EACrC,OAASC,OAAO,IAAM;IACrB,MAAM;MAAEC;IAAc,CAAC,GAAGD,OAAO;IACjC,MAAM;MAAEE;IAAY,CAAC,GAAGD,aAAa;IAErC,IAAIE,KAAK,GAAG,IAAI;IAEhB,SAASC,aAAaA,CAAEC,KAAK,EAAG;MAC/B;MACA,IAAKA,KAAK,CAACC,gBAAgB,EAAG;QAC7B;MACD;MACA,IAAKD,KAAK,CAACE,MAAM,KAAKP,OAAO,EAAG;QAC/B;MACD;MACA,IAAK,CAAEK,KAAK,CAACE,MAAM,CAACC,QAAQ,CAAER,OAAQ,CAAC,EAAG;QACzC;MACD;MACAG,KAAK,GAAGH,OAAO,CAACS,YAAY,CAAE,iBAAkB,CAAC;MACjDT,OAAO,CAACU,YAAY,CAAE,iBAAiB,EAAE,OAAQ,CAAC;MAClDR,WAAW,CAACS,YAAY,CAAC,CAAC,CAACC,eAAe,CAAC,CAAC;IAC7C;IAEA,SAASC,WAAWA,CAAA,EAAG;MACtB,IAAKV,KAAK,KAAK,IAAI,EAAG;QACrBH,OAAO,CAACU,YAAY,CAAE,iBAAiB,EAAEP,KAAM,CAAC;QAChDA,KAAK,GAAG,IAAI;MACb;IACD;IAEAD,WAAW,CAACY,gBAAgB,CAAE,aAAa,EAAEV,aAAc,CAAC;IAC5DF,WAAW,CAACY,gBAAgB,CAAE,WAAW,EAAED,WAAY,CAAC;IACxD,OAAO,MAAM;MACZX,WAAW,CAACa,mBAAmB,CAAE,aAAa,EAAEX,aAAc,CAAC;MAC/DF,WAAW,CAACa,mBAAmB,CAAE,WAAW,EAAEF,WAAY,CAAC;IAC5D,CAAC;EACF,CAAC;AACF","ignoreList":[]}