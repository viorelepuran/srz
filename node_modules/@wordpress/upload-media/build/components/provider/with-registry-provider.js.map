{"version":3,"names":["_element","require","_data","_compose","_store","_constants","_jsxRuntime","getSubRegistry","subRegistries","registry","useSubRegistry","subRegistry","get","createRegistry","registerStore","mediaUploadStoreName","storeConfig","set","withRegistryProvider","createHigherOrderComponent","WrappedComponent","props","useRegistry","useState","WeakMap","jsx","RegistryProvider","value","children","_default","exports","default"],"sources":["@wordpress/upload-media/src/components/provider/with-registry-provider.tsx"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useState } from '@wordpress/element';\nimport { useRegistry, createRegistry, RegistryProvider } from '@wordpress/data';\nimport { createHigherOrderComponent } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport { storeConfig } from '../../store';\nimport { STORE_NAME as mediaUploadStoreName } from '../../store/constants';\n\ntype WPDataRegistry = ReturnType< typeof createRegistry >;\n\nfunction getSubRegistry(\n\tsubRegistries: WeakMap< WPDataRegistry, WPDataRegistry >,\n\tregistry: WPDataRegistry,\n\tuseSubRegistry: boolean\n) {\n\tif ( ! useSubRegistry ) {\n\t\treturn registry;\n\t}\n\tlet subRegistry = subRegistries.get( registry );\n\tif ( ! subRegistry ) {\n\t\tsubRegistry = createRegistry( {}, registry );\n\t\tsubRegistry.registerStore( mediaUploadStoreName, storeConfig );\n\t\tsubRegistries.set( registry, subRegistry );\n\t}\n\treturn subRegistry;\n}\n\nconst withRegistryProvider = createHigherOrderComponent(\n\t( WrappedComponent ) =>\n\t\t( { useSubRegistry = true, ...props } ) => {\n\t\t\tconst registry = useRegistry() as unknown as WPDataRegistry;\n\t\t\tconst [ subRegistries ] = useState<\n\t\t\t\tWeakMap< WPDataRegistry, WPDataRegistry >\n\t\t\t>( () => new WeakMap() );\n\t\t\tconst subRegistry = getSubRegistry(\n\t\t\t\tsubRegistries,\n\t\t\t\tregistry,\n\t\t\t\tuseSubRegistry\n\t\t\t);\n\n\t\t\tif ( subRegistry === registry ) {\n\t\t\t\treturn <WrappedComponent registry={ registry } { ...props } />;\n\t\t\t}\n\n\t\t\treturn (\n\t\t\t\t<RegistryProvider value={ subRegistry }>\n\t\t\t\t\t<WrappedComponent registry={ subRegistry } { ...props } />\n\t\t\t\t</RegistryProvider>\n\t\t\t);\n\t\t},\n\t'withRegistryProvider'\n);\n\nexport default withRegistryProvider;\n"],"mappings":";;;;;;AAGA,IAAAA,QAAA,GAAAC,OAAA;AACA,IAAAC,KAAA,GAAAD,OAAA;AACA,IAAAE,QAAA,GAAAF,OAAA;AAKA,IAAAG,MAAA,GAAAH,OAAA;AACA,IAAAI,UAAA,GAAAJ,OAAA;AAA2E,IAAAK,WAAA,GAAAL,OAAA;AAX3E;AACA;AACA;;AAKA;AACA;AACA;;AAMA,SAASM,cAAcA,CACtBC,aAAwD,EACxDC,QAAwB,EACxBC,cAAuB,EACtB;EACD,IAAK,CAAEA,cAAc,EAAG;IACvB,OAAOD,QAAQ;EAChB;EACA,IAAIE,WAAW,GAAGH,aAAa,CAACI,GAAG,CAAEH,QAAS,CAAC;EAC/C,IAAK,CAAEE,WAAW,EAAG;IACpBA,WAAW,GAAG,IAAAE,oBAAc,EAAE,CAAC,CAAC,EAAEJ,QAAS,CAAC;IAC5CE,WAAW,CAACG,aAAa,CAAEC,qBAAoB,EAAEC,kBAAY,CAAC;IAC9DR,aAAa,CAACS,GAAG,CAAER,QAAQ,EAAEE,WAAY,CAAC;EAC3C;EACA,OAAOA,WAAW;AACnB;AAEA,MAAMO,oBAAoB,GAAG,IAAAC,mCAA0B,EACpDC,gBAAgB,IACjB,CAAE;EAAEV,cAAc,GAAG,IAAI;EAAE,GAAGW;AAAM,CAAC,KAAM;EAC1C,MAAMZ,QAAQ,GAAG,IAAAa,iBAAW,EAAC,CAA8B;EAC3D,MAAM,CAAEd,aAAa,CAAE,GAAG,IAAAe,iBAAQ,EAE/B,MAAM,IAAIC,OAAO,CAAC,CAAE,CAAC;EACxB,MAAMb,WAAW,GAAGJ,cAAc,CACjCC,aAAa,EACbC,QAAQ,EACRC,cACD,CAAC;EAED,IAAKC,WAAW,KAAKF,QAAQ,EAAG;IAC/B,oBAAO,IAAAH,WAAA,CAAAmB,GAAA,EAACL,gBAAgB;MAACX,QAAQ,EAAGA,QAAU;MAAA,GAAMY;IAAK,CAAI,CAAC;EAC/D;EAEA,oBACC,IAAAf,WAAA,CAAAmB,GAAA,EAACvB,KAAA,CAAAwB,gBAAgB;IAACC,KAAK,EAAGhB,WAAa;IAAAiB,QAAA,eACtC,IAAAtB,WAAA,CAAAmB,GAAA,EAACL,gBAAgB;MAACX,QAAQ,EAAGE,WAAa;MAAA,GAAMU;IAAK,CAAI;EAAC,CACzC,CAAC;AAErB,CAAC,EACF,sBACD,CAAC;AAAC,IAAAQ,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEab,oBAAoB","ignoreList":[]}