{"version":3,"names":["Button","Modal","__experimentalHStack","HStack","privateApis","componentsPrivateApis","__","useMemo","useState","moreVertical","useRegistry","unlock","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Menu","kebabCase","ButtonTrigger","action","onClick","items","label","icon","disabled","accessibleWhenDisabled","isDestructive","size","MenuItemTrigger","Item","children","ItemLabel","ActionModal","closeModal","_action$modalFocusOnM","title","modalHeader","__experimentalHideHeader","hideModalHeader","onRequestClose","focusOnMount","modalFocusOnMount","modalSize","overlayClassName","id","RenderModal","ActionsMenuGroup","actions","item","registry","setActiveModalAction","Group","map","callback","ItemActions","isCompact","primaryActions","eligibleActions","_eligibleActions","filter","isEligible","_primaryActions","isPrimary","CompactItemActions","isSmall","length","PrimaryActions","spacing","justify","className","style","flexShrink","width","activeModalAction","placement","TriggerButton","render","Popover","Array","isArray"],"sources":["@wordpress/dataviews/src/components/dataviews-item-actions/index.tsx"],"sourcesContent":["/**\n * External dependencies\n */\nimport type { MouseEventHandler } from 'react';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tButton,\n\tModal,\n\t__experimentalHStack as HStack,\n\tprivateApis as componentsPrivateApis,\n} from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport { useMemo, useState } from '@wordpress/element';\nimport { moreVertical } from '@wordpress/icons';\nimport { useRegistry } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport { unlock } from '../../lock-unlock';\nimport type { Action, ActionModal as ActionModalType } from '../../types';\n\nconst { Menu, kebabCase } = unlock( componentsPrivateApis );\n\nexport interface ActionTriggerProps< Item > {\n\taction: Action< Item >;\n\tonClick: MouseEventHandler;\n\tisBusy?: boolean;\n\titems: Item[];\n}\n\nexport interface ActionModalProps< Item > {\n\taction: ActionModalType< Item >;\n\titems: Item[];\n\tcloseModal: () => void;\n}\n\ninterface ActionsMenuGroupProps< Item > {\n\tactions: Action< Item >[];\n\titem: Item;\n\tregistry: ReturnType< typeof useRegistry >;\n\tsetActiveModalAction: ( action: ActionModalType< Item > | null ) => void;\n}\n\ninterface ItemActionsProps< Item > {\n\titem: Item;\n\tactions: Action< Item >[];\n\tisCompact?: boolean;\n}\n\ninterface CompactItemActionsProps< Item > {\n\titem: Item;\n\tactions: Action< Item >[];\n\tisSmall?: boolean;\n\tregistry: ReturnType< typeof useRegistry >;\n}\n\ninterface PrimaryActionsProps< Item > {\n\titem: Item;\n\tactions: Action< Item >[];\n\tregistry: ReturnType< typeof useRegistry >;\n}\n\nfunction ButtonTrigger< Item >( {\n\taction,\n\tonClick,\n\titems,\n}: ActionTriggerProps< Item > ) {\n\tconst label =\n\t\ttypeof action.label === 'string' ? action.label : action.label( items );\n\treturn (\n\t\t<Button\n\t\t\tlabel={ label }\n\t\t\ticon={ action.icon }\n\t\t\tdisabled={ !! action.disabled }\n\t\t\taccessibleWhenDisabled\n\t\t\tisDestructive={ action.isDestructive }\n\t\t\tsize=\"compact\"\n\t\t\tonClick={ onClick }\n\t\t/>\n\t);\n}\n\nfunction MenuItemTrigger< Item >( {\n\taction,\n\tonClick,\n\titems,\n}: ActionTriggerProps< Item > ) {\n\tconst label =\n\t\ttypeof action.label === 'string' ? action.label : action.label( items );\n\treturn (\n\t\t<Menu.Item disabled={ action.disabled } onClick={ onClick }>\n\t\t\t<Menu.ItemLabel>{ label }</Menu.ItemLabel>\n\t\t</Menu.Item>\n\t);\n}\n\nexport function ActionModal< Item >( {\n\taction,\n\titems,\n\tcloseModal,\n}: ActionModalProps< Item > ) {\n\tconst label =\n\t\ttypeof action.label === 'string' ? action.label : action.label( items );\n\treturn (\n\t\t<Modal\n\t\t\ttitle={ action.modalHeader || label }\n\t\t\t__experimentalHideHeader={ !! action.hideModalHeader }\n\t\t\tonRequestClose={ closeModal }\n\t\t\tfocusOnMount={ action.modalFocusOnMount ?? true }\n\t\t\tsize={ action.modalSize || 'medium' }\n\t\t\toverlayClassName={ `dataviews-action-modal dataviews-action-modal__${ kebabCase(\n\t\t\t\taction.id\n\t\t\t) }` }\n\t\t>\n\t\t\t<action.RenderModal items={ items } closeModal={ closeModal } />\n\t\t</Modal>\n\t);\n}\n\nexport function ActionsMenuGroup< Item >( {\n\tactions,\n\titem,\n\tregistry,\n\tsetActiveModalAction,\n}: ActionsMenuGroupProps< Item > ) {\n\treturn (\n\t\t<Menu.Group>\n\t\t\t{ actions.map( ( action ) => (\n\t\t\t\t<MenuItemTrigger\n\t\t\t\t\tkey={ action.id }\n\t\t\t\t\taction={ action }\n\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\tif ( 'RenderModal' in action ) {\n\t\t\t\t\t\t\tsetActiveModalAction( action );\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\taction.callback( [ item ], { registry } );\n\t\t\t\t\t} }\n\t\t\t\t\titems={ [ item ] }\n\t\t\t\t/>\n\t\t\t) ) }\n\t\t</Menu.Group>\n\t);\n}\n\nexport default function ItemActions< Item >( {\n\titem,\n\tactions,\n\tisCompact,\n}: ItemActionsProps< Item > ) {\n\tconst registry = useRegistry();\n\tconst { primaryActions, eligibleActions } = useMemo( () => {\n\t\t// If an action is eligible for all items, doesn't need\n\t\t// to provide the `isEligible` function.\n\t\tconst _eligibleActions = actions.filter(\n\t\t\t( action ) => ! action.isEligible || action.isEligible( item )\n\t\t);\n\t\tconst _primaryActions = _eligibleActions.filter(\n\t\t\t( action ) => action.isPrimary && !! action.icon\n\t\t);\n\t\treturn {\n\t\t\tprimaryActions: _primaryActions,\n\t\t\teligibleActions: _eligibleActions,\n\t\t};\n\t}, [ actions, item ] );\n\n\tif ( isCompact ) {\n\t\treturn (\n\t\t\t<CompactItemActions\n\t\t\t\titem={ item }\n\t\t\t\tactions={ eligibleActions }\n\t\t\t\tisSmall\n\t\t\t\tregistry={ registry }\n\t\t\t/>\n\t\t);\n\t}\n\n\t// If all actions are primary, there is no need to render the dropdown.\n\tif ( primaryActions.length === eligibleActions.length ) {\n\t\treturn (\n\t\t\t<PrimaryActions\n\t\t\t\titem={ item }\n\t\t\t\tactions={ primaryActions }\n\t\t\t\tregistry={ registry }\n\t\t\t/>\n\t\t);\n\t}\n\n\treturn (\n\t\t<HStack\n\t\t\tspacing={ 1 }\n\t\t\tjustify=\"flex-end\"\n\t\t\tclassName=\"dataviews-item-actions\"\n\t\t\tstyle={ {\n\t\t\t\tflexShrink: '0',\n\t\t\t\twidth: 'auto',\n\t\t\t} }\n\t\t>\n\t\t\t<PrimaryActions\n\t\t\t\titem={ item }\n\t\t\t\tactions={ primaryActions }\n\t\t\t\tregistry={ registry }\n\t\t\t/>\n\t\t\t<CompactItemActions\n\t\t\t\titem={ item }\n\t\t\t\tactions={ eligibleActions }\n\t\t\t\tregistry={ registry }\n\t\t\t/>\n\t\t</HStack>\n\t);\n}\n\nfunction CompactItemActions< Item >( {\n\titem,\n\tactions,\n\tisSmall,\n\tregistry,\n}: CompactItemActionsProps< Item > ) {\n\tconst [ activeModalAction, setActiveModalAction ] = useState(\n\t\tnull as ActionModalType< Item > | null\n\t);\n\treturn (\n\t\t<>\n\t\t\t<Menu placement=\"bottom-end\">\n\t\t\t\t<Menu.TriggerButton\n\t\t\t\t\trender={\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tsize={ isSmall ? 'small' : 'compact' }\n\t\t\t\t\t\t\ticon={ moreVertical }\n\t\t\t\t\t\t\tlabel={ __( 'Actions' ) }\n\t\t\t\t\t\t\taccessibleWhenDisabled\n\t\t\t\t\t\t\tdisabled={ ! actions.length }\n\t\t\t\t\t\t\tclassName=\"dataviews-all-actions-button\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t\t<Menu.Popover>\n\t\t\t\t\t<ActionsMenuGroup\n\t\t\t\t\t\tactions={ actions }\n\t\t\t\t\t\titem={ item }\n\t\t\t\t\t\tregistry={ registry }\n\t\t\t\t\t\tsetActiveModalAction={ setActiveModalAction }\n\t\t\t\t\t/>\n\t\t\t\t</Menu.Popover>\n\t\t\t</Menu>\n\t\t\t{ !! activeModalAction && (\n\t\t\t\t<ActionModal\n\t\t\t\t\taction={ activeModalAction }\n\t\t\t\t\titems={ [ item ] }\n\t\t\t\t\tcloseModal={ () => setActiveModalAction( null ) }\n\t\t\t\t/>\n\t\t\t) }\n\t\t</>\n\t);\n}\n\nfunction PrimaryActions< Item >( {\n\titem,\n\tactions,\n\tregistry,\n}: PrimaryActionsProps< Item > ) {\n\tconst [ activeModalAction, setActiveModalAction ] = useState( null as any );\n\tif ( ! Array.isArray( actions ) || actions.length === 0 ) {\n\t\treturn null;\n\t}\n\treturn (\n\t\t<>\n\t\t\t{ actions.map( ( action ) => (\n\t\t\t\t<ButtonTrigger\n\t\t\t\t\tkey={ action.id }\n\t\t\t\t\taction={ action }\n\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\tif ( 'RenderModal' in action ) {\n\t\t\t\t\t\t\tsetActiveModalAction( action );\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\taction.callback( [ item ], { registry } );\n\t\t\t\t\t} }\n\t\t\t\t\titems={ [ item ] }\n\t\t\t\t/>\n\t\t\t) ) }\n\t\t\t{ !! activeModalAction && (\n\t\t\t\t<ActionModal\n\t\t\t\t\taction={ activeModalAction }\n\t\t\t\t\titems={ [ item ] }\n\t\t\t\t\tcloseModal={ () => setActiveModalAction( null ) }\n\t\t\t\t/>\n\t\t\t) }\n\t\t</>\n\t);\n}\n"],"mappings":"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","ignoreList":[]}